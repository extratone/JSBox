<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>Move Cursor to End of Line, before Any Carriage Return/Line Feed - Scripting - Drafts Community</title>
    <meta name="description" content="Greetings, folks! 
I have an action Javascript (appended below) that moves the cursor to the end of the current line, but if there is a carriage return or line feed at the end of the line, it will move the cursor to the &amp;hellip;">
    <meta name="generator" content="Discourse 2.9.0.beta4 - https://github.com/discourse/discourse version f0d46c35493f4d01e4c1f9a3b32f867c1ade595e">
<link rel="icon" type="image/png" href="../../uploads/default/optimized/1X/25837d707e58349c1c1881afc1883055a203ac28_2_32x32.png">
<link rel="apple-touch-icon" type="image/png" href="../../uploads/default/optimized/2X/7/77d737820f07fbb0e980560a8c341a18432a7d92_2_180x180.png">
<meta name="theme-color" content="#ffffff">
<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, user-scalable=yes, viewport-fit=cover">
<link rel="canonical" href="10781.html" />
<script type="application/ld+json">{"@context":"http://schema.org","@type":"WebSite","url":"https://forums.getdrafts.com","potentialAction":{"@type":"SearchAction","target":"https://forums.getdrafts.com/search?q={search_term_string}","query-input":"required name=search_term_string"}}</script>
<link rel="search" type="application/opensearchdescription+xml" href="../../opensearch.xml" title="Drafts Community Search">

    <link href="https://forums.getdrafts.com/stylesheets/color_definitions_base__2_3d1df61a71325940d683ff0221fd14dee6a802e5.css?__ws=forums.getdrafts.com" media="all" rel="stylesheet" class="light-scheme"/><link href="https://forums.getdrafts.com/stylesheets/color_definitions_simple-dark_1_2_ce13c571d5f0d2fac2c7d8164bf57e59bd0aa89f.css?__ws=forums.getdrafts.com" media="(prefers-color-scheme: dark)" rel="stylesheet" class="dark-scheme"/>

  <link href="https://forums.getdrafts.com/stylesheets/desktop_efbc3607260bd3949bf9351692c294020d363176.css?__ws=forums.getdrafts.com" media="all" rel="stylesheet" data-target="desktop"  />


  <link href="https://forums.getdrafts.com/stylesheets/discourse-details_efbc3607260bd3949bf9351692c294020d363176.css?__ws=forums.getdrafts.com" media="all" rel="stylesheet" data-target="discourse-details"  />
  <link href="https://forums.getdrafts.com/stylesheets/discourse-local-dates_efbc3607260bd3949bf9351692c294020d363176.css?__ws=forums.getdrafts.com" media="all" rel="stylesheet" data-target="discourse-local-dates"  />
  <link href="https://forums.getdrafts.com/stylesheets/discourse-narrative-bot_efbc3607260bd3949bf9351692c294020d363176.css?__ws=forums.getdrafts.com" media="all" rel="stylesheet" data-target="discourse-narrative-bot"  />
  <link href="https://forums.getdrafts.com/stylesheets/discourse-presence_efbc3607260bd3949bf9351692c294020d363176.css?__ws=forums.getdrafts.com" media="all" rel="stylesheet" data-target="discourse-presence"  />
  <link href="https://forums.getdrafts.com/stylesheets/lazy-yt_efbc3607260bd3949bf9351692c294020d363176.css?__ws=forums.getdrafts.com" media="all" rel="stylesheet" data-target="lazy-yt"  />
  <link href="https://forums.getdrafts.com/stylesheets/poll_efbc3607260bd3949bf9351692c294020d363176.css?__ws=forums.getdrafts.com" media="all" rel="stylesheet" data-target="poll"  />
  <link href="https://forums.getdrafts.com/stylesheets/poll_desktop_efbc3607260bd3949bf9351692c294020d363176.css?__ws=forums.getdrafts.com" media="all" rel="stylesheet" data-target="poll_desktop"  />

  <link href="https://forums.getdrafts.com/stylesheets/desktop_theme_2_8a6535adb5ffcb37b246b8087d7136cfbc597ca9.css?__ws=forums.getdrafts.com" media="all" rel="stylesheet" data-target="desktop_theme" data-theme-id="2" data-theme-name="default"/>

    
    
        <link rel="alternate nofollow" type="application/rss+xml" title="RSS feed of &#39;Move Cursor to End of Line, before Any Carriage Return/Line Feed&#39;" href="10781.rss" />
    <meta property="og:site_name" content="Drafts Community" />
<meta property="og:type" content="website" />
<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:image" content="https://forums.getdrafts.com/uploads/default/original/2X/8/8028b40b2b5c46fe6a21aa3e1b9480b911b845df.png" />
<meta property="og:image" content="https://forums.getdrafts.com/uploads/default/original/2X/8/8028b40b2b5c46fe6a21aa3e1b9480b911b845df.png" />
<meta property="og:url" content="https://forums.getdrafts.com/t/move-cursor-to-end-of-line-before-any-carriage-return-line-feed/10781" />
<meta name="twitter:url" content="https://forums.getdrafts.com/t/move-cursor-to-end-of-line-before-any-carriage-return-line-feed/10781" />
<meta property="og:title" content="Move Cursor to End of Line, before Any Carriage Return/Line Feed" />
<meta name="twitter:title" content="Move Cursor to End of Line, before Any Carriage Return/Line Feed" />
<meta property="og:description" content="Greetings, folks!  I have an action Javascript (appended below) that moves the cursor to the end of the current line, but if there is a carriage return or line feed at the end of the line, it will move the cursor to the start of the next line. Not what I want.  Simply subtracting one character from the line length is a shoddy workaround, but only fails if the line is the last line in the text file.  Thoughts or suggestions?  (Please forgive me for being so rusty in JS!)  Blessings, and thank you..." />
<meta name="twitter:description" content="Greetings, folks!  I have an action Javascript (appended below) that moves the cursor to the end of the current line, but if there is a carriage return or line feed at the end of the line, it will move the cursor to the start of the next line. Not what I want.  Simply subtracting one character from the line length is a shoddy workaround, but only fails if the line is the last line in the text file.  Thoughts or suggestions?  (Please forgive me for being so rusty in JS!)  Blessings, and thank you..." />
<meta name="twitter:label1" value="Reading time" />
<meta name="twitter:data1" value="1 mins 🕑" />
<meta name="twitter:label2" value="Likes" />
<meta name="twitter:data2" value="3 ❤" />
<meta property="article:published_time" content="2021-07-08T01:46:32+00:00" />
<meta property="og:ignore_canonical" content="true" />


    
  </head>
  <body class="crawler">
    
    <header>
  <a href="https://forums.getdrafts.com/">
    <h1>Drafts Community</h1>
  </a>
</header>

    <div id="main-outlet" class="wrap" role="main">
        <div id="topic-title">
    <h1>
      <a href="10781.html">Move Cursor to End of Line, before Any Carriage Return/Line Feed</a>
    </h1>

      <div class="topic-category" itemscope itemtype="http://schema.org/BreadcrumbList">
          <span itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
            <a href="https://forums.getdrafts.com/c/scripting/13" class="badge-wrapper bullet" itemprop="item">
              <span class='badge-category-bg' style='background-color: #AB9364'></span>
              <span class='badge-category clear-badge'>
                <span class='category-name' itemprop='name'>Scripting</span>
              </span>
            </a>
            <meta itemprop="position" content="1" />
          </span>
      </div>

      <div class="topic-category">
        <div class='discourse-tags list-tags'>
            <a href='../../tag/javascript.html' class='discourse-tag' rel="tag">javascript</a>, 
            <a href='../../tag/actions.html' class='discourse-tag' rel="tag">actions</a>
        </div>
      </div>
  </div>

  


      <div id='post_1' itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="http://schema.org/Organization">
            <meta itemprop='name' content='Agile Tortoise, Inc.'>
              <div itemprop='logo' itemscope itemtype="http://schema.org/ImageObject">
                <meta itemprop='url' content='https://forums.getdrafts.com/uploads/default/original/2X/8/8ed1af80ec826f0860aad768f711c6b1b0fb32b4.png'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a itemprop="url" href='https://forums.getdrafts.com/u/RichardFairbanks'><span itemprop='name'>RichardFairbanks</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="10781.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2021-07-08T01:46:32Z' class='post-time'>
                July 8, 2021,  1:46am
              </time>
              <meta itemprop='dateModified' content='2021-07-08T01:46:32Z'>
          <span itemprop='position'>#1</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>Greetings, folks!</p>
<p>I have an action Javascript (appended below) that moves the cursor to the end of the current line, but if there is a carriage return or line feed at the end of the line, it will move the cursor to the start of the next line. Not what I want.</p>
<p>Simply subtracting one character from the line length is a shoddy workaround, but only fails if the line is the last line in the text file.</p>
<p>Thoughts or suggestions?</p>
<p>(Please forgive me for being so rusty in JS!)</p>
<p>Blessings, and thank you!</p>
<p>———————————————————————————————————————</p>
<p>// Move cursor to end of line</p>
<p>let [loc, len] = editor.getSelectedLineRange(),<br>
str = editor.getTextInRange(loc, len);<br>
editor.setTextInRange(loc, len, str);</p>
<p>// editor.setSelectedRange(loc + str.length, 0); // this includes the carriage return/line feed at the end of lines, and thus going to the start of the next line instead</p>
<p>editor.setSelectedRange(loc + str.length - 1, 0); // the shoddy workaround</p>
<p>editor.setSelectedText(’’);</p>
<p>editor.activate();</p>
        </div>

        <meta itemprop='headline' content='Move Cursor to End of Line, before Any Carriage Return/Line Feed'>
          <meta itemprop='keywords' content='javascript, actions'>

        <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="0" />
           <span class='post-likes'></span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

      </div>
      <div id='post_2' itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="http://schema.org/Organization">
            <meta itemprop='name' content='Agile Tortoise, Inc.'>
              <div itemprop='logo' itemscope itemtype="http://schema.org/ImageObject">
                <meta itemprop='url' content='https://forums.getdrafts.com/uploads/default/original/2X/8/8ed1af80ec826f0860aad768f711c6b1b0fb32b4.png'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a itemprop="url" href='https://forums.getdrafts.com/u/drdrang'><span itemprop='name'>drdrang</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="10781.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2021-07-08T03:25:29Z' class='post-time'>
                July 8, 2021,  3:25am
              </time>
              <meta itemprop='dateModified' content='2021-07-08T03:25:29Z'>
          <span itemprop='position'>#2</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>It’s not a shoddy workaround—you have to deal with the fact that there’s a linefeed at the end of all but (possibly) the last line. But it is worth the effort to deal with that special case. Here’s a solution I believe works no matter where you are in the file:</p>
<pre><code class="lang-auto">let [loc, len] = editor.getSelectedLineRange();
let str = editor.getTextInRange(loc, len);
str = str.replace(/\n$/, "");
editor.setSelectedRange(loc + str.length, 0);
</code></pre>
<p>The <code>replace</code> strips the trailing newline from <code>str</code> if there is one. Now the length of <code>str</code> is just what you want.</p>
<p>(I’m assuming, by the way, that the usual keyboard shortcuts of ⌘→ and ⌃E aren’t available to you, either because this is part of a longer script or you’re working without a physical keyboard.)</p>
        </div>

        <meta itemprop='headline' content='Move Cursor to End of Line, before Any Carriage Return/Line Feed'>

        <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="3" />
           <span class='post-likes'>3 Likes</span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="1" />
          </div>

      </div>
      <div id='post_3' itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="http://schema.org/Organization">
            <meta itemprop='name' content='Agile Tortoise, Inc.'>
              <div itemprop='logo' itemscope itemtype="http://schema.org/ImageObject">
                <meta itemprop='url' content='https://forums.getdrafts.com/uploads/default/original/2X/8/8ed1af80ec826f0860aad768f711c6b1b0fb32b4.png'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a itemprop="url" href='https://forums.getdrafts.com/u/RichardFairbanks'><span itemprop='name'>RichardFairbanks</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="10781.html">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2021-07-09T01:41:35Z' class='post-time'>
                July 9, 2021,  1:41am
              </time>
              <meta itemprop='dateModified' content='2021-07-09T01:41:35Z'>
          <span itemprop='position'>#3</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p>God Bless You!</p>
<p>(and thank you for being so gracious!    <img src="../../images/emoji/apple/wink.png@v=9" title=":wink:" class="emoji" alt=":wink:">   )</p>
        </div>

        <meta itemprop='headline' content='Move Cursor to End of Line, before Any Carriage Return/Line Feed'>

        <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="0" />
           <span class='post-likes'></span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

      </div>






    </div>
    <footer class="container wrap">
  <nav class='crawler-nav'>
    <ul>
      <li itemscope itemtype='http://schema.org/SiteNavigationElement'>
        <span itemprop='name'>
          <a href='https://forums.getdrafts.com/' itemprop="url">Home </a>
        </span>
      </li>
      <li itemscope itemtype='http://schema.org/SiteNavigationElement'>
        <span itemprop='name'>
          <a href='https://forums.getdrafts.com/categories' itemprop="url">Categories </a>
        </span>
      </li>
      <li itemscope itemtype='http://schema.org/SiteNavigationElement'>
        <span itemprop='name'>
          <a href='https://forums.getdrafts.com/guidelines' itemprop="url">FAQ/Guidelines </a>
        </span>
      </li>
      <li itemscope itemtype='http://schema.org/SiteNavigationElement'>
        <span itemprop='name'>
          <a href='https://forums.getdrafts.com/tos' itemprop="url">Terms of Service </a>
        </span>
      </li>
      <li itemscope itemtype='http://schema.org/SiteNavigationElement'>
        <span itemprop='name'>
          <a href='https://forums.getdrafts.com/privacy' itemprop="url">Privacy Policy </a>
        </span>
      </li>
    </ul>
  </nav>
  <p class='powered-by-link'>Powered by <a href="https://www.discourse.org">Discourse</a>, best viewed with JavaScript enabled</p>
</footer>

    
    
  </body>
  
</html>
