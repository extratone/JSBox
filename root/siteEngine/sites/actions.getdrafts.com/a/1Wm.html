<!DOCTYPE html>
<html lang='en'>
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <title>Get Bible Verse (ESV) | Drafts Directory</title>
    <meta name="csrf-param" content="authenticity_token" />
<meta name="csrf-token" content="KE9HNUjHCLlJ8Lx6sEE43TRImZQJyRc4lAGzbgIKScxbUGG/LKyvXMagByrkAmPDk+tHb/cZXZ65cOEXK/LXPg==" />
    <meta http-equiv="content-type" content="text/html;charset=utf-8">
    <meta http-equiv="content-language" content="en">
    <meta http-equiv="content-language" content="en-us">
    
    <meta name="viewport" content="width=device-width, initial-scale=1">
    
    <meta property="og:title" content="Drafts Directory: Get Bible Verse (ESV)" />
    <meta property="og:url" content="https://actions.getdrafts.com/a/1Wm" />
    <meta property="og:type" content="website" />
    <meta property="og:description" content="Example actions and other extensions for Drafts, the quick-capture notes app." />
    <meta property="og:image" content="https://actions.getdrafts.com/assets/drafts-ogimage-action-d9c60102fd45e0cb516e1b49ed50a81e3c3a2b90f81f55df8f43d0feb0512978.png" />
    <meta property="twitter:title" content="Drafts Directory: Get Bible Verse (ESV)" />
    <meta property="twitter:url" content="https://actions.getdrafts.com/a/1Wm" />
    <meta property="twitter:type" content="website" />
    <meta property="twitter:description" content="Example actions and other extensions for Drafts, the quick-capture notes app." />
    <meta property="twitter:image" content="https://actions.getdrafts.com/assets/drafts-ogimage-action-d9c60102fd45e0cb516e1b49ed50a81e3c3a2b90f81f55df8f43d0feb0512978.png" />

    <link rel="shortcut icon" type="image/x-icon" href="../assets/favicon-114dbb66b0ef0399a14fa5dfcad7e6210bb558c30cea665e04d49b59fec87f70.png" />

    <link rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.4.0/styles/default.min.css">
    <link rel="stylesheet" media="all" href="../assets/application-6e4f014b4c48cd673942dbfbbeb3e571a732b05562ddde5904f3a5c3833e54ff.css" />
    <script src="../assets/application-13492939cb10be5be76b5abb3e9ae0bef0bbae3202cec2b85cf6fca5bc8429c8.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.4.0/highlight.min.js"></script>
    <script>hljs.highlightAll();</script>
    <script async defer data-domain="directory.getdrafts.com" src="https://plausible.io/js/plausible.js"></script>
  </head>

<body data-no-turbolink>

    <div class="page-wrap">
        <div class="side-bar">
            <a href="../index.html" class="site-title fs-6 lh-tight" title="{{ site.title }}">
                <img src="../assets/drafts-directory-header-4d826bd007f515c8e5a10f654e56ad76fbb3bd3103a67ce342283f701f1677fe.svg" alt="Drafts Directory" style="max-height: 30px;" />
            </a>
            <span class="fs-3"><button class="js-main-nav-trigger navigation-list-toggle btn btn-outline" type="button"
                    data-text-toggle="Hide">Menu</button></span>
            <div class="navigation main-nav js-main-nav">
              <ul class="navigation-list">
                <li class="navigation-list-item">
                  <a class="navigation-list-link" href="../index.html">Home</a>
                </li>
                <li class="navigation-list-item">
                  <a class="navigation-list-link" href="../drafts_actions.html">Actions</a>
                </li>
                <li class="navigation-list-item">
                  <a class="navigation-list-link" href="../drafts_action_groups.html">Action Groups</a>
                </li>
                <li class="navigation-list-item">
                  <a class="navigation-list-link" href="../syntax_definitions.html">Syntaxes</a>
                </li>
                <li class="navigation-list-item">
                  <a class="navigation-list-link" href="../theme_definitions.html">Themes</a>
                </li>
                <li class="navigation-list-item">
                  <a class="navigation-list-link" href="../workspaces.html">Workspaces</a>
                </li>
                <li class="navigation-list-item">
                  <hr style="margin:1em; padding: 0;" />
                </li>
                <li class="navigation-list-item">
                  <a class="navigation-list-link" href="../search.html">Search</a>
                </li>
                <li class="navigation-list-item">
                  <hr style="margin:1em; padding: 0;" />
                </li>
                <li class="navigation-list-item">
                    <a class="navigation-list-link nav-external" title="About Drafts" href="../../getdrafts.com/index.html">Get Drafts &#x2192;</a>
                </li>
                <li class="navigation-list-item">
                    <a class="navigation-list-link nav-external" title="Detailed documentation" href="../../docs.getdrafts.com/index.html">User Guide &#x2192;</a>
                </li>
                <li class="navigation-list-item">
                    <a class="navigation-list-link nav-external" title="Get your questions answered in the forums" href="https://forums.getdrafts.com/">Community &#x2192;</a>
                </li>
                <li class="navigation-list-item">
                    <a class="navigation-list-link nav-external" title="Online tools and generators" href="../../tools.getdrafts.com/index.html">Tools &#x2192;</a>
                </li>
                <li class="navigation-list-item">
                    <a class="navigation-list-link nav-external" title="Scripting library reference" href="../../scripting.getdrafts.com/index.html">Script Reference &#x2192;</a>
                </li>
              </ul>
            </div>
            <footer role="contentinfo" class="site-footer">
                <p class="text-small text-grey-dk-000 mb-0">
                    Download: <a href="https://itunes.apple.com/app/id1236254471?ls=1&mt=8&at=11l4Cf&ct=site">iOS</a> | <a href="https://itunes.apple.com/app/id1435957248?mt=12&at=11l4Cf&ct=site">Mac</a>
                </p>
            </footer>
        </div>
        <div class="main-content-wrap js-main-content" tabindex="0">
            <div class="page-header">
                <div class="main-content">
                    <div class="search js-search">
	<div class="search-input-wrap">
<form class="search-form" action="../search.html" accept-charset="UTF-8" method="get"><input name="utf8" type="hidden" value="&#x2713;" />
	<button style='border:none;background-color:transparent;'>
	<svg width="14" height="14" viewBox="0 0 28 28" xmlns="http://www.w3.org/2000/svg"
		class="search-icon">
		<title>Search</title>
		<g fill-rule="nonzero">
			<path
				d="M17.332 20.735c-5.537 0-10-4.6-10-10.247 0-5.646 4.463-10.247 10-10.247 5.536 0 10 4.601 10 10.247s-4.464 10.247-10 10.247zm0-4c3.3 0 6-2.783 6-6.247 0-3.463-2.7-6.247-6-6.247s-6 2.784-6 6.247c0 3.464 2.7 6.247 6 6.247z" />
			<path d="M11.672 13.791L.192 25.271 3.02 28.1 14.5 16.62z" />
		</g>
	</svg>
	</button>
	<input type="text" name="q" id="q" class="js-search-input search-input search" size="12" tabindex="0" placeholder="Search" />
</form>	</div>
</div>
                    <ul class="list-style-none text-small mt-md-1 mb-md-1 pb-4 pb-md-0 js-aux-nav aux-nav">
                        <li class="d-inline-block my-0 mr-2">
                          <a href="../../getdrafts.com/index.html">Get Drafts</a>
                        </li>
                        <li class="d-inline-block my-0">
                          <a href="https://forums.getdrafts.com">Community</a>
                        </li>
                    </ul>
                </div>
            </div>
            <div class="main-content">
                <div id="main-content" class="page-content" role="main">
                  <div class="type">
                    <h4>Action</h4>
                  </div>
                  <div class="header">
                      <h1><img src="https://config.agiletortoise.com/drafts-icons/content.png" class="action-icon" />Get Bible Verse (ESV)</h1>
                  </div>

                  <div class="content">
                    
<div class='caption'>
        Posted by nate561,
    Last update
    almost 3 years ago
</div>


    <div class='description'>
        <p>This action is powered by the API provided at ESV.org. You can create an account there (api.esv.org) to get an API token for this action. When you first run this action please enter the token you received from ESV.org to authenticate.</p>

<p>To use this script either place your cursor in the draft and run the action or select a passage that is already typed out and run the action. If you have no text selected the action will prompt for you to enter a passage reference (ex. John 3:16). If you have a verse reference already written in the draft you can select the text and run the action. The action will see that text is selected and use that to search for a passage. </p>

    </div>

<div class="certification">
  
  
</div>

<div style="margin: 2em 0;">
    <a class="btn btn-blue" href="drafts5://action?identifier=1Wm&amp;data=%7B%22uuid%22:%2215B6777B-3CDF-4076-A214-3177EEC8CA7B%22,%22steps%22:[%7B%22platforms%22:3,%22data%22:%7B%22script%22:%22/*%5Cn*%5Cn%5CnThis%20script%20use%20the%20api%20located%20at%20api.esv.org.%20You%20must%20first%20create%20an%20account%20at%20this%20site%20and%20then%20create%20a%20project%20to%20gain%20an%20API%20token.%20Once%20you%20have%20the%20token%20you%20can%20run%20this%20scirpt%20and%20enter%20your%20token%20when%20promted%20to%20store%20it%20for%20future%20use.%20%5Cn%5Cn*%5Cn*/%5Cn%5Cnvar%20credential%20=%20Credential.create(%5C%22ESV%20API%5C%22,%20%5C%22An%20API%20Used%20to%20search%20for%20bible%20verses%20in%20from%20the%20ESV%20bible%20translation%5C%22);%5Cn%5Cncredential.addPasswordField(%5C%22token%5C%22,%20%5C%22Token%5C%22);%5Cn%5Cncredential.authorize();%5Cn%5Cnvar%20sel%20=%20editor.getSelectedText();%20//%20retrieve%20selected%20text%5Cn%5Cnvar%20selRange%20=%20editor.getSelectedRange();%5Cn%5Cnif%20(!sel%20%7C%7C%20sel.length%20==%200)%20%7B%5Cnlet%20p%20=%20Prompt.create();%5Cn%5Cnp.title%20=%20%5C%22Please%20enter%20a%20verse%20refrence%5C%22;%5Cnp.addTextField(%5C%22Verse%5C%22,%20%5C%22Verse%5C%22,%5C%22%5C%22,%7B&#39;wantsFocus&#39;:true%7D);%5Cnp.addButton(%5C%22Search%5C%22,%5C%22Search%5C%22,%5C%22isDefault%5C%22);%5Cn%5Cn%5Cnp.show();%5Cnif%20(p.buttonPressed%20==%20%5C%22Search%5C%22)%20%7B%5Cn%20%20%20var%20sel%20=%20p.fieldValues[%5C%22Verse%5C%22];%5Cn%20%7D%5Cn%7D%5Cn%5Cnvar%20http%20=%20HTTP.create();%5Cn%5Cn//You%20can%20set%20these%20to%20%5C%22true%5C%22%20or%20%5C%22false%5C%22%20to%20add%20different%20pieces%20to%20the%20verse%20output%5Cnvar%20include_copyright%20=%20%5C%22false%5C%22;%5Cnvar%20include_headings%20=%20%5C%22false%5C%22;%20%5Cnvar%20include_passage_ref%20=%20%5C%22false%5C%22%5Cnvar%20include_footnote%20=%20%5C%22false%5C%22%5Cn%5Cn%5Cnvar%20endpoint%20=%20%5C%22https://api.esv.org/v3/passage/text/?q=%5C%22+%20encodeURI%20(sel)+%5C%22%5Cu0026include-copyright=%5C%22+include_copyright+%5C%22%5Cu0026include-headings=%5C%22+include_headings+%5C%22%5Cu0026include-passage-references=%5C%22+include_passage_ref+%5C%22%5Cu0026include-footnote-body=%5C%22+include_footnote;%5Cn%5Cnvar%20response%20=%20http.request(%7B%5Cn%20%20%5Ct%5C%22method%5C%22:%5C%22GET%5C%22,%20%5Cn%5Ct%5C%22url%5C%22:%20endpoint,%5Cn%5Ct%5C%22headers%5C%22:%20%7B%5Cn%5Ct%5Ct%5C%22Authorization%5C%22:%20%5C%22Token%20%5C%22%20+%20credential.getValue(%5C%22token%5C%22)%5Cn%5Ct%7D%5Cn%7D);%5Cn%5Cnif%20(response.success)%20%7B%5Cn%20%20var%20text%20=%20response.responseText;%5Cn%20%20var%20data%20=%20response.responseData;%5Cn%7D%5Cnelse%20%7B%5Cn%5Ctconsole.log(response.statusCode);%5Cn%5Ctconsole.log(response.error);%20%5Cn%7D%5Cn%5Cnvar%20passage%20=%20JSON.parse(text).passages.toString();%5Cnvar%20ref%20=%20JSON.parse(text).canonical;%5Cn%5Cnvar%20ParseNewLine%20=%20/%5C%5Cn/gi;%5Cnvar%20ParseTabs%20=%20/%20%20%20%7C%5C%5Cv%7C%20%20/gi;%5Cnpassage%20=%20passage.replace(ParseNewLine,%20&#39;&#39;);%5Cnpassage%20=%20passage.replace(ParseTabs,%20&#39;&#39;);%5Cnvar%20returnVal%20=%20passage%20+%20%5C%22%5C%5Cn%5C%22%20+%20ref;%20%5Cneditor.setSelectedText(returnVal);%5Cn%5Cnvar%20selRange%20=%20editor.getSelectedRange();%5Cneditor.setSelectedRange(selRange[0]+selRange[1],0);%22%7D,%22type%22:%22script%22,%22isEnabled%22:true,%22uuid%22:%221945B974-E8D1-4E8E-B715-253B7EC081BC%22%7D],%22backingPlatforms%22:3,%22shortName%22:%22%22,%22shouldConfirm%22:false,%22disposition%22:0,%22keyCommand%22:%7B%22optionKey%22:false,%22input%22:%22%22,%22controlKey%22:false,%22commandKey%22:false,%22type%22:%22action%22,%22discoverabilityTitle%22:%22Get%20Bible%20Verse%20(ESV)%22,%22shiftKey%22:false%7D,%22logLevel%22:2,%22groupDisposition%22:0,%22notificationType%22:2,%22tintColor%22:%22blue%22,%22actionDescription%22:%22To%20use%20this%20script%20either%20place%20your%20cursor%20in%20the%20draft%20and%20run%20the%20action%20or%20select%20a%20passage%20that%20is%20already%20typed%20out%20and%20run%20the%20action.%20If%20you%20have%20no%20text%20selected%20the%20action%20will%20prompt%20for%20you%20to%20enter%20a%20passage%20reference%20(ex.%20John%203:16).%20If%20you%20have%20a%20verse%20reference%20already%20written%20in%20the%20draft%20you%20can%20select%20the%20text%20and%20run%20the%20action.%20The%20action%20will%20see%20that%20text%20is%20selected%20and%20use%20that%20to%20search%20for%20a%20passage.%20%5Cn%5CnThis%20action%20is%20powered%20by%20the%20API%20provided%20at%20ESV.org.%20You%20can%20create%20an%20account%20there%20(api.esv.org)%20to%20get%20an%20API%20token%20for%20this%20action.%20When%20you%20first%20run%20this%20action%20please%20enter%20the%20token%20you%20received%20from%20ESV.org%20to%20authenticate.%20%5Cn%5Cn%22,%22keyUseIcon%22:true,%22icon%22:%22content%22,%22visibility%22:224,%22backingIsSeparator%22:false,%22groupUUID%22:%225857E05F-184B-4E69-ADC6-964A8F4B1154%22,%22assignTags%22:[],%22name%22:%22Get%20Bible%20Verse%20(ESV)%22%7D">Install</a>
</div>

<div>
  <h4>Steps</h4>
<ul class='steps'>
  <li>
    <div class='step'><h3>script</h3><pre><code class='language-javascript'>/*
*

This script use the api located at api.esv.org. You must first create an account at this site and then create a project to gain an API token. Once you have the token you can run this scirpt and enter your token when promted to store it for future use. 

*
*/

var credential = Credential.create(&quot;ESV API&quot;, &quot;An API Used to search for bible verses in from the ESV bible translation&quot;);

credential.addPasswordField(&quot;token&quot;, &quot;Token&quot;);

credential.authorize();

var sel = editor.getSelectedText(); // retrieve selected text

var selRange = editor.getSelectedRange();

if (!sel || sel.length == 0) {
let p = Prompt.create();

p.title = &quot;Please enter a verse refrence&quot;;
p.addTextField(&quot;Verse&quot;, &quot;Verse&quot;,&quot;&quot;,{&#39;wantsFocus&#39;:true});
p.addButton(&quot;Search&quot;,&quot;Search&quot;,&quot;isDefault&quot;);


p.show();
if (p.buttonPressed == &quot;Search&quot;) {
   var sel = p.fieldValues[&quot;Verse&quot;];
 }
}

var http = HTTP.create();

//You can set these to &quot;true&quot; or &quot;false&quot; to add different pieces to the verse output
var include_copyright = &quot;false&quot;;
var include_headings = &quot;false&quot;; 
var include_passage_ref = &quot;false&quot;
var include_footnote = &quot;false&quot;


var endpoint = &quot;https://api.esv.org/v3/passage/text/?q=&quot;+ encodeURI (sel)+&quot;&amp;include-copyright=&quot;+include_copyright+&quot;&amp;include-headings=&quot;+include_headings+&quot;&amp;include-passage-references=&quot;+include_passage_ref+&quot;&amp;include-footnote-body=&quot;+include_footnote;

var response = http.request({
  	&quot;method&quot;:&quot;GET&quot;, 
	&quot;url&quot;: endpoint,
	&quot;headers&quot;: {
		&quot;Authorization&quot;: &quot;Token &quot; + credential.getValue(&quot;token&quot;)
	}
});

if (response.success) {
  var text = response.responseText;
  var data = response.responseData;
}
else {
	console.log(response.statusCode);
	console.log(response.error); 
}

var passage = JSON.parse(text).passages.toString();
var ref = JSON.parse(text).canonical;

var ParseNewLine = /\n/gi;
var ParseTabs = /   |\v|  /gi;
passage = passage.replace(ParseNewLine, &#39;&#39;);
passage = passage.replace(ParseTabs, &#39;&#39;);
var returnVal = passage + &quot;\n&quot; + ref; 
editor.setSelectedText(returnVal);

var selRange = editor.getSelectedRange();
editor.setSelectedRange(selRange[0]+selRange[1],0);</code></pre></div>
  </li>
</ul>
</div>

<div>
  <h4>Options</h4>
  <ul class="steps">
    <li>
  <table class='action-detail'>
    <tr>
      <td class="cell-label">After Success</td>
      <td class="value">
        Nothing
        
      </td>
    </tr>
    <tr>
      <td class="cell-label">Notification</td>
      <td class="value">Info</td>
    </tr>
    <tr>
      <td class="cell-label">Log Level</td>
      <td class="value">Info</td>
    </tr>
  </table>
</li>
</ul>
</div>

<div class="disclaimer">
  Items available in the Drafts Directory are uploaded by community members. Use appropriate caution reviewing downloaded items before use.
</div>


                  </div>
                  <div class="footer-content">
                  <p>
                  <a href="https://itunes.apple.com/app/id1236254471?ls=1&mt=8&at=11l4Cf&ct=site">
                    <img alt="Download on App Store" src="../assets/appstore-deaf597bd57239c5054c59099e54ab9014f1e15eddb961085428e0ce94d4385b.svg" />
                  </a>
                  <a href="https://itunes.apple.com/app/id1435957248?mt=12&at=11l4Cf&ct=site">
                    <img alt="Download on Mac App Store" src="../assets/macappstore-05f5eed00e6bb26b68c1368217276158329862682e6d61b3ed193f819fe02f2f.svg" />
                  </a>
                  </p>
                    &copy; 2012-2022 by Agile Tortoise, Inc.<br/>
                    Drafts is a registered Trademark of Agile Tortoise, Inc.<br/>
                    <a href="../../getdrafts.com/support/privacy.html">Privacy</a> | <a href="../../getdrafts.com/support/terms.html">Terms</a>
                </div>
                </div>
            </div>
        </div>
    </div>

  </body>
  </html>
