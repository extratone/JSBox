<!DOCTYPE html>
<html lang='en'>
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <title>Save to Evernote (Full Formatting) | Drafts Directory</title>
    <meta name="csrf-param" content="authenticity_token" />
<meta name="csrf-token" content="KDwhVWzbQCWOUMPbGIdQHqjmkbFPuBr2fKanvSNtG/1bIwffCLDnwAEAeItMxAsAD0VPSrFoUFBR1/XECpWFDw==" />
    <meta http-equiv="content-type" content="text/html;charset=utf-8">
    <meta http-equiv="content-language" content="en">
    <meta http-equiv="content-language" content="en-us">
    
    <meta name="viewport" content="width=device-width, initial-scale=1">
    
    <meta property="og:title" content="Drafts Directory: Save to Evernote (Full Formatting)" />
    <meta property="og:url" content="https://actions.getdrafts.com/a/1eN" />
    <meta property="og:type" content="website" />
    <meta property="og:description" content="Example actions and other extensions for Drafts, the quick-capture notes app." />
    <meta property="og:image" content="https://actions.getdrafts.com/assets/drafts-ogimage-action-d9c60102fd45e0cb516e1b49ed50a81e3c3a2b90f81f55df8f43d0feb0512978.png" />
    <meta property="twitter:title" content="Drafts Directory: Save to Evernote (Full Formatting)" />
    <meta property="twitter:url" content="https://actions.getdrafts.com/a/1eN" />
    <meta property="twitter:type" content="website" />
    <meta property="twitter:description" content="Example actions and other extensions for Drafts, the quick-capture notes app." />
    <meta property="twitter:image" content="https://actions.getdrafts.com/assets/drafts-ogimage-action-d9c60102fd45e0cb516e1b49ed50a81e3c3a2b90f81f55df8f43d0feb0512978.png" />

    <link rel="shortcut icon" type="image/x-icon" href="../assets/favicon-114dbb66b0ef0399a14fa5dfcad7e6210bb558c30cea665e04d49b59fec87f70.png" />

    <link rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.4.0/styles/default.min.css">
    <link rel="stylesheet" media="all" href="../assets/application-6e4f014b4c48cd673942dbfbbeb3e571a732b05562ddde5904f3a5c3833e54ff.css" />
    <script src="../assets/application-13492939cb10be5be76b5abb3e9ae0bef0bbae3202cec2b85cf6fca5bc8429c8.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.4.0/highlight.min.js"></script>
    <script>hljs.highlightAll();</script>
    <script async defer data-domain="directory.getdrafts.com" src="https://plausible.io/js/plausible.js"></script>
  </head>

<body data-no-turbolink>

    <div class="page-wrap">
        <div class="side-bar">
            <a href="https://actions.getdrafts.com/index.html" class="site-title fs-6 lh-tight" title="{{ site.title }}">
                <img src="../assets/drafts-directory-header-4d826bd007f515c8e5a10f654e56ad76fbb3bd3103a67ce342283f701f1677fe.svg" alt="Drafts Directory" style="max-height: 30px;" />
            </a>
            <span class="fs-3"><button class="js-main-nav-trigger navigation-list-toggle btn btn-outline" type="button"
                    data-text-toggle="Hide">Menu</button></span>
            <div class="navigation main-nav js-main-nav">
              <ul class="navigation-list">
                <li class="navigation-list-item">
                  <a class="navigation-list-link" href="https://actions.getdrafts.com/index.html">Home</a>
                </li>
                <li class="navigation-list-item">
                  <a class="navigation-list-link" href="https://actions.getdrafts.com/drafts_actions.html">Actions</a>
                </li>
                <li class="navigation-list-item">
                  <a class="navigation-list-link" href="https://actions.getdrafts.com/drafts_action_groups.html">Action Groups</a>
                </li>
                <li class="navigation-list-item">
                  <a class="navigation-list-link" href="https://actions.getdrafts.com/syntax_definitions.html">Syntaxes</a>
                </li>
                <li class="navigation-list-item">
                  <a class="navigation-list-link" href="https://actions.getdrafts.com/theme_definitions.html">Themes</a>
                </li>
                <li class="navigation-list-item">
                  <a class="navigation-list-link" href="https://actions.getdrafts.com/workspaces.html">Workspaces</a>
                </li>
                <li class="navigation-list-item">
                  <hr style="margin:1em; padding: 0;" />
                </li>
                <li class="navigation-list-item">
                  <a class="navigation-list-link" href="https://actions.getdrafts.com/search.html">Search</a>
                </li>
                <li class="navigation-list-item">
                  <hr style="margin:1em; padding: 0;" />
                </li>
                <li class="navigation-list-item">
                    <a class="navigation-list-link nav-external" title="About Drafts" href="https://actions.getdrafts.com/getdrafts.com/index.html">Get Drafts &#x2192;</a>
                </li>
                <li class="navigation-list-item">
                    <a class="navigation-list-link nav-external" title="Detailed documentation" href="https://actions.getdrafts.com/docs.getdrafts.com/index.html">User Guide &#x2192;</a>
                </li>
                <li class="navigation-list-item">
                    <a class="navigation-list-link nav-external" title="Get your questions answered in the forums" href="https://forums.getdrafts.com/">Community &#x2192;</a>
                </li>
                <li class="navigation-list-item">
                    <a class="navigation-list-link nav-external" title="Online tools and generators" href="https://actions.getdrafts.com/tools.getdrafts.com/index.html">Tools &#x2192;</a>
                </li>
                <li class="navigation-list-item">
                    <a class="navigation-list-link nav-external" title="Scripting library reference" href="https://actions.getdrafts.com/scripting.getdrafts.com/index.html">Script Reference &#x2192;</a>
                </li>
              </ul>
            </div>
            <footer role="contentinfo" class="site-footer">
                <p class="text-small text-grey-dk-000 mb-0">
                    Download: <a href="https://itunes.apple.com/app/id1236254471?ls=1&mt=8&at=11l4Cf&ct=site">iOS</a> | <a href="https://itunes.apple.com/app/id1435957248?mt=12&at=11l4Cf&ct=site">Mac</a>
                </p>
            </footer>
        </div>
        <div class="main-content-wrap js-main-content" tabindex="0">
            <div class="page-header">
                <div class="main-content">
                    <div class="search js-search">
	<div class="search-input-wrap">
<form class="search-form" action="https://actions.getdrafts.com/search.html" accept-charset="UTF-8" method="get"><input name="utf8" type="hidden" value="&#x2713;" />
	<button style='border:none;background-color:transparent;'>
	<svg width="14" height="14" viewBox="0 0 28 28" xmlns="http://www.w3.org/2000/svg"
		class="search-icon">
		<title>Search</title>
		<g fill-rule="nonzero">
			<path
				d="M17.332 20.735c-5.537 0-10-4.6-10-10.247 0-5.646 4.463-10.247 10-10.247 5.536 0 10 4.601 10 10.247s-4.464 10.247-10 10.247zm0-4c3.3 0 6-2.783 6-6.247 0-3.463-2.7-6.247-6-6.247s-6 2.784-6 6.247c0 3.464 2.7 6.247 6 6.247z" />
			<path d="M11.672 13.791L.192 25.271 3.02 28.1 14.5 16.62z" />
		</g>
	</svg>
	</button>
	<input type="text" name="q" id="q" class="js-search-input search-input search" size="12" tabindex="0" placeholder="Search" />
</form>	</div>
</div>
                    <ul class="list-style-none text-small mt-md-1 mb-md-1 pb-4 pb-md-0 js-aux-nav aux-nav">
                        <li class="d-inline-block my-0 mr-2">
                          <a href="https://actions.getdrafts.com/getdrafts.com/index.html">Get Drafts</a>
                        </li>
                        <li class="d-inline-block my-0">
                          <a href="https://forums.getdrafts.com">Community</a>
                        </li>
                    </ul>
                </div>
            </div>
            <div class="main-content">
                <div id="main-content" class="page-content" role="main">
                  <div class="type">
                    <h4>Action</h4>
                  </div>
                  <div class="header">
                      <h1><img src="https://config.agiletortoise.com/drafts-icons/action_evernote.png" class="action-icon" />Save to Evernote (Full Formatting)</h1>
                  </div>

                  <div class="content">
                    
<div class='caption'>
        Posted by akay64,
    Last update
    over 1 year ago
</div>


    <div class='description'>
        <p>Convert draft Markdown to ENML and save to a note in Evernote with the title as note name.</p>

<p>This action uses some scripting to make the draft output be compatible with Evernote (ENML) and preserves the following when saving to Evernote:</p>

<ul>
<li>All heading formatting up to h3 (max supported by new Evernote)</li>
<li>Line breaks and makes them Evernote compatable</li>
<li>All list indentations</li>
<li>Code blocks and make them Evernote compatible</li>
<li>Inline <code>code block</code> and formats as monospace font in Evernote</li>
<li>Checklists and todo lists with full functionality in Evernote to interact with them</li>
<li>All other standard markdown other than Evernote specific stuff.</li>
<li>Tables with formatting improvements</li>
</ul>

    </div>

<div class="certification">
  
  
</div>

<div style="margin: 2em 0;">
    <a class="btn btn-blue" href="drafts5://action?identifier=1eN&amp;data=%7B%22uuid%22:%22664077DC-A933-48A5-9F58-10E873F24C33%22,%22steps%22:[%7B%22platforms%22:3,%22data%22:%7B%22script%22:%22const%20CONFIG_LIST_INDENT_SPACES%20=%204;%5Cnconst%20CONFIG_MONOSPACE_INLINE_CODEBLOCKS%20=%20true;%5Cnconst%20CONFIG_RETAIN_CODE_BLOCK_LANG_AS_COMMENT%20=%20true;%20//%20Code%20block%20langage%20is%20not%20supported%20by%20ENML%5Cn%5Cnconst%20DEBUG_STRING%20=%20%60%60;%5Cnconst%20DEBUG%20=%20false;%5Cn%5Cnconst%20TYPE_CHECK_UNCHECKED%20=%20%5C%22TYPE_CHECKLIST_UNCHECKED%5C%22;%5Cnconst%20TYPE_CHECK_CHECKED%20=%20%5C%22TYPE_CHECK_CHECKED%5C%22;%5Cnconst%20TYPE_UL%20=%20%5C%22TYPE_UL%5C%22;%5Cnconst%20TYPE_OL%20=%20%5C%22TYPE_OL%5C%22;%5Cn%5Cnlet%20mmd;%5Cn%5Cnif%20(!DEBUG)%20%7B%5Cn%20%20mmd%20=%20MultiMarkdown.create();%5Cn%5Cn%20%20mmd.format%20=%20%5C%22html%5C%22;%5Cn%20%20mmd.noMetadata%20=%20true;%5Cn%20%20mmd.footnotesEnabled%20=%20false;%5Cn%20%20mmd.criticMarkup%20=%20true;%5Cn%7D%5Cn%5Cnfunction%20getListIndent(listItemType,%20listItem)%20%7B%5Cn%5Cn%20%20function%20indentPosition(RegexTest)%20%7B%5Cn%20%20%20%20const%20indexLocationToFirstChar%20=%20listItem.match(RegexTest);%5Cn%5Cn%5Cn%20%20%20%20if%20(indexLocationToFirstChar)%20%7B%5Cn%5Cn%20%20%20%20%20%20const%20indent%20=%20indexLocationToFirstChar[2];%5Cn%20%20%20%20%20%20let%20spacesCount%20=%200;%5Cn%5Cn%20%20%20%20%20%20if%20(indent)%20%7B%5Cn%20%20%20%20%20%20%20%20spacesCount%20=%20indent.length%5Cn%20%20%20%20%20%20%7D%5Cn%5Cn%20%20%20%20%20%20return%20Math.ceil(spacesCount/CONFIG_LIST_INDENT_SPACES)%5Cn%20%20%20%20%7D%20else%20%7B%5Cn%20%20%20%20%20%20return%200%5Cn%20%20%20%20%7D%5Cn%20%20%7D;%5Cn%5Cn%20%20switch(listItemType)%20%7B%5Cn%20%20%20%20case%20TYPE_CHECK_UNCHECKED:%5Cn%20%20%20%20%20%20return%20indentPosition(new%20RegExp(/%5E((%5C%5Cs+)?-%20%5C%5C[%5C%5Cs%5C%5C])/));%5Cn%20%20%20%20case%20TYPE_CHECK_CHECKED:%5Cn%20%20%20%20%20%20return%20indentPosition(new%20RegExp(/%5E((%5C%5Cs+)?-%20%5C%5C[x%5C%5C])/));%5Cn%20%20%20%20case%20TYPE_UL:%5Cn%20%20%20%20%20%20return%20indentPosition(new%20RegExp(/%5E((%5C%5Cs+)?-%5C%5Cs)/))%20%7C%7C%20indentPosition(new%20RegExp(/%5E((%5C%5Cs+)?%5C%5C*%5C%5Cs)/));%5Cn%20%20%20%20case%20TYPE_OL:%5Cn%20%20%20%20%20%20return%20indentPosition(new%20RegExp(/%5E((%5C%5Cs+)?%5C%5Cd+%5C%5C.%5C%5Cs)/));%5Cn%20%20%7D%5Cn%7D%5Cn%5Cnfunction%20getListItemType(line)%20%7B%5Cn%20%20if%20(!line)%20return%20null;%5Cn%5Cn%20%20const%20trimmedLine%20=%20line.trim();%5Cn%20%20const%20firstFiveChars%20=%20trimmedLine.substring(0,%205);%5Cn%20%20const%20firstTwoChars%20=%20trimmedLine.substring(0,%202);%5Cn%5Cn%20%20if%20(firstFiveChars%20===%20%5C%22-%20[%20]%5C%22%20)%20%7B%5Cn%20%20%20%20return%20TYPE_CHECK_UNCHECKED;%5Cn%20%20%7D%20else%20if(firstFiveChars%20===%20%5C%22-%20[x]%5C%22)%20%7B%5Cn%20%20%20%20return%20TYPE_CHECK_CHECKED;%5Cn%20%20%7D%20else%20if%20(firstTwoChars%20===%20%5C%22-%20%5C%22%20%7C%7C%20firstTwoChars%20===%20%5C%22*%20%5C%22)%20%7B%5Cn%20%20%20%20return%20TYPE_UL;%5Cn%20%20%7D%20else%20if%20(firstFiveChars.match(/%5E%5C%5Cd+%5C%5C.%5C%5Cs/))%20%7B%5Cn%20%20%20%20return%20TYPE_OL;%5Cn%20%20%7D%20else%20%7B%5Cn%20%20%20%20return%20null%5Cn%20%20%7D%5Cn%7D%5Cn%5Cnlet%20draftBody%20=%20&#39;&#39;;%5Cn%5Cnif%20(DEBUG)%20%7B%5Cn%20%20draftBody%20=%20DEBUG_STRING;%5Cn%7D%20else%20%7B%5Cn%20%20draftBody%20=%20draft.content;%5Cn%7D%5Cn%5Cn//%20Fix%20%5Cu003chr%20/%5Cu003e%20converted%20incorrectly%20by%20some%20apps%20in%20correctly%20by%20some%20apps%5CndraftBody%20=%20draftBody%5Cn.replace(/%5Cu003c/g,%20%5C%22%5Cu0026lt;%5C%22)%5Cn.replace(/%5Cu003e/g,%20%5C%22%5Cu0026gt;%5C%22)%5Cn.replace(/%5E-%5C%5Cs-%5C%5Cs-%5C%5Cs-$/gm,%20%5C%22---%5C%22)%5Cn.replace(/%5C%5Ct/g,%5C%22%20%20%20%20%5C%22);%5Cn%5Cnconst%20originalContent%20=%20draftBody.split(%5C%22%5C%5Cn%5C%22);%5Cnconst%20originalContentWorkingCopy%20=%20draftBody.split(%5C%22%5C%5Cn%5C%22);%5CnoriginalContent.shift();%5CnoriginalContentWorkingCopy.shift();%5Cn%5Cnlet%20listGroups%20=%20[[]];%5Cnlet%20processingGroup%20=%20false;%5Cn%5Cn//%20Create%20groupings%20of%20lists%20to%20be%20converted%20to%20ENML%5CnoriginalContent.forEach((line,%20index)%20=%5Cu003e%20%7B%5Cn%5Cn%20%20const%20lineRecord%20=%20%7B%7D;%5Cn%20%20const%20listItemType%20=%20getListItemType(line);%5Cn%20%20let%20listItemFound%20=%20Boolean(listItemType);%5Cn%5Cn%20%20if%20(listItemType)%20%7B%5Cn%20%20%20%20lineRecord.type%20=%20listItemType;%5Cn%20%20%20%20lineRecord.indentPosition%20=%20getListIndent(listItemType,%20line);%5Cn%20%20%7D%5Cn%5Cn%20%20const%20groupStartCriteriaMatch%20=%20(!originalContent[index-1]%20%7C%7C%5Cn%20%20%20%20!Boolean(getListItemType(originalContent[index-1])))%20%5Cu0026%5Cu0026%5Cn%20%20%20%20listItemFound;%5Cn%20%20const%20groupEndCriteriaMatch%20=%20(!originalContent[index+1]%20%7C%7C%5Cn%20%20originalContent[index+1].trim()%20===%20%5C%22%5C%22)%20%7C%7C%20!Boolean(getListItemType(originalContent[index+1]));%5Cn%5Cn%5Ctif%20(processingGroup%20%7C%7C%20groupStartCriteriaMatch)%20%7B%5Cn%20%20%20%20if%20(!processingGroup)%20%7B%5Cn%20%20%20%20%20%20processingGroup%20=%20true;%5Cn%20%20%20%20%20%20originalContentWorkingCopy[index]%20=%20%60%7B%7BREPLACE_LIST-$%7BlistGroups.length%7D%7D%7D%60;%5Cn%20%20%20%20%7D%20else%20%7B%5Cn%20%20%20%20%20%20originalContentWorkingCopy[index]%20=%20null;%5Cn%20%20%20%20%7D%5Cn%5Cn%20%20%20%20lineRecord.content%20=%20line.trim();%5Cn%5Cn%20%20%20%20listGroupsLastIndex%20=%20listGroups.length-1;%5Cn%20%20%20%20listGroups[listGroupsLastIndex].push(lineRecord);%5Cn%5Cn%20%20%20%20if%20(groupEndCriteriaMatch)%20%7B%5Cn%20%20%20%20%20%20listGroups.push([]);%5Cn%20%20%20%20%5CtprocessingGroup%20=%20false;%5Cn%20%20%20%20%7D%5Cn%20%20%7D%5Cn%7D);%5Cn%5Cn//%20Clean%20up%20list%20groups%5CnlistGroups%20=%20listGroups.filter((listGroup)%20=%5Cu003e%20Boolean(listGroup.length));%5Cn%5Cnlet%20processedLists%20=%20[];%5Cn%5Cnif%20(listGroups.length)%20%7B%5Cn%20%20listGroups.forEach((listGroup,%20groupIndex)%20=%5Cu003e%20%7B%5Cn%5Cn%20%20%20%20processedLists.push([]);%5Cn%20%20%20%20let%20currentIndentPosition%20=%200;%5Cn%20%20%20%20let%20endTagStack%20=%20[];%5Cn%5Cn%20%20%20%20listGroup.forEach((listItem,%20itemIndex)%20=%5Cu003e%20%7B%5Cn%5Cn%20%20%20%20%20%20if%20(itemIndex%20===%200)%20%7B%5Cn%20%20%20%20%20%20%20%20if%20(listItem.type%20===%20TYPE_OL)%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20processedLists[groupIndex].push(%5C%22%5Cu003col%5Cu003e%5C%22);%5Cn%20%20%20%20%20%20%20%20%20%20endTagStack.push(%5C%22%5Cu003c/ol%5Cu003e%5C%22);%5Cn%20%20%20%20%20%20%20%20%7D%20else%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20processedLists[groupIndex].push(%5C%22%5Cu003cul%5Cu003e%5C%22);%5Cn%20%20%20%20%20%20%20%20%20%20endTagStack.push(%5C%22%5Cu003c/ul%5Cu003e%5C%22);%5Cn%20%20%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%7D%5Cn%5Cn%20%20%20%20%20%20if(currentIndentPosition%20!=%20listItem.indentPosition)%20%7B%5Cn%20%20%20%20%20%20%20%20if%20(currentIndentPosition%20%5Cu003c%20listItem.indentPosition)%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20if%20(listItem.type%20===%20TYPE_OL)%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20%20%20processedLists[groupIndex].push(%5C%22%5Cu003col%5Cu003e%5C%22);%5Cn%20%20%20%20%20%20%20%20%20%20%20%20endTagStack.push(%5C%22%5Cu003c/ol%5Cu003e%5C%22);%5Cn%20%20%20%20%20%20%20%20%20%20%7D%20else%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20%20%20processedLists[groupIndex].push(%5C%22%5Cu003cul%5Cu003e%5C%22);%5Cn%20%20%20%20%20%20%20%20%20%20%20%20endTagStack.push(%5C%22%5Cu003c/ul%5Cu003e%5C%22);%5Cn%20%20%20%20%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%20%20%7D%20else%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20(new%20Array(currentIndentPosition%20-%20listItem.indentPosition)).fill().forEach(()%20=%5Cu003e%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20%20%20processedLists[groupIndex].push(endTagStack.pop())%5Cn%20%20%20%20%20%20%20%20%20%20%7D);%5Cn%20%20%20%20%20%20%20%20%7D%5Cn%5Cn%20%20%20%20%20%20%20%20currentIndentPosition%20=%20listItem.indentPosition;%5Cn%20%20%20%20%20%20%7D%5Cn%5Cn%20%20%20%20%20%20//%20Prepare%20list%20item%20for%20insertion%5Cn%20%20%20%20%20%20let%20preparedListItem%20=%20listItem.content.trim();%5Cn%5Cn%5Cn%20%20%20%20%20%20function%20markdownRenderList(content)%20%7B%5Cn%20%20%20%20%20%20%20%20if%20(!DEBUG)%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20return%20mmd.render(content).replace(%5C%22%5Cu003cp%5Cu003e%5C%22,%20%5C%22%5C%22).replace(%5C%22%5Cu003c/p%5Cu003e%5C%22,%20%5C%22%5C%22);%5Cn%20%20%20%20%20%20%20%20%7D%20else%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20return%20content;%5Cn%20%20%20%20%20%20%20%20%7D;%5Cn%20%20%20%20%20%20%7D%5Cn%5Cn%20%20%20%20%20%20switch%20(listItem.type)%20%7B%5Cn%20%20%20%20%20%20%20%20case%20TYPE_CHECK_UNCHECKED:%5Cn%20%20%20%20%20%20%20%20%20%20preparedListItem%20=%20preparedListItem.replace(%5C%22-%20[%20]%20%5C%22,%20&#39;&#39;);%5Cn%20%20%20%20%20%20%20%20%20%20preparedListItem%20=%20markdownRenderList(preparedListItem);%5Cn%20%20%20%20%20%20%20%20%20%20preparedListItem%20=%20&#39;%5Cu003cen-todo%20checked=%5C%22false%5C%22%20/%5Cu003e&#39;%20+%20preparedListItem;%5Cn%20%20%20%20%20%20%20%20%20%20break;%5Cn%20%20%20%20%20%20%20%20case%20TYPE_CHECK_CHECKED:%5Cn%20%20%20%20%20%20%20%20%20%20preparedListItem%20=%20preparedListItem.replace(%5C%22-%20[x]%20%5C%22,%20&#39;&#39;);%5Cn%20%20%20%20%20%20%20%20%20%20preparedListItem%20=%20markdownRenderList(preparedListItem);%5Cn%20%20%20%20%20%20%20%20%20%20preparedListItem%20=%20&#39;%5Cu003cen-todo%20checked=%5C%22true%5C%22%20/%5Cu003e&#39;%20+%20preparedListItem;%5Cn%20%20%20%20%20%20%20%20%20%20break;%5Cn%20%20%20%20%20%20%20%20case%20TYPE_UL:%5Cn%20%20%20%20%20%20%20%20%20%20preparedListItem%20=%20preparedListItem.replace(/%5E-%5C%5Cs%7C%5E%5C%5C*%5C%5Cs/,%20&#39;&#39;);%5Cn%20%20%20%20%20%20%20%20%20%20preparedListItem%20=%20markdownRenderList(preparedListItem);%5Cn%20%20%20%20%20%20%20%20%20%20break;%5Cn%20%20%20%20%20%20%20%20case%20TYPE_OL:%5Cn%20%20%20%20%20%20%20%20%20%20preparedListItem%20=%20preparedListItem.replace(/%5E%5C%5Cd+%5C%5C.%5C%5Cs/,%20&#39;&#39;);%5Cn%20%20%20%20%20%20%20%20%20%20preparedListItem%20=%20markdownRenderList(preparedListItem);%5Cn%20%20%20%20%20%20%20%20%20%20break;%5Cn%20%20%20%20%20%20%7D%5Cn%5Cn%20%20%20%20%20%20processedLists[groupIndex].push(%60%5Cu003cli%5Cu003e$%7BpreparedListItem%7D%5Cu003c/li%5Cu003e%60);%5Cn%5Cn%20%20%20%20%20%20if(listGroups[groupIndex].length-1%20===%20itemIndex)%20%7B%5Cn%5Cn%20%20%20%20%20%20%20%20new%20Array(endTagStack.length).fill().forEach(()%20=%5Cu003e%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20processedLists[groupIndex].push(endTagStack.pop())%5Cn%20%20%20%20%20%20%20%20%7D);%5Cn%20%20%20%20%20%20%7D%5Cn%20%20%20%20%7D)%5Cn%20%20%7D)%5Cn%7D%5Cn%5Cn//%20Final%20result%5Cn%5Cnlet%20reassembledBody%20=%20originalContentWorkingCopy%5Cn.filter((line)%20=%5Cu003e%20line%20!==%20null%5Cn).join(%5C%22%5C%5Cn%5C%22);%5Cn%5Cnlet%20markdownOutputBody%20=%20&#39;&#39;;%5Cn%5Cnif%20(CONFIG_RETAIN_CODE_BLOCK_LANG_AS_COMMENT)%20%7B%5Cn%20%20reassembledBody%20=%20reassembledBody.replace(/%5E%60%60%60([A-Za-z]+)$/mg,%20(_,%20c1)%20=%5Cu003e%20%5C%22%60%60%60%5C%5Cn//%5C%22%20+%20c1%20+%20%5C%22%5C%5Cn%5C%22)%5Cn%7D%20else%20%7B%5Cn%20%20reassembledBody%20=%20reassembledBody.replace(/%5E%60%60%60([A-Za-z]+)/mg,%20%5C%22%60%60%60%5C%22);%5Cn%7D%5Cn%5Cn//%20New%20Evernote%20does%20not%20support%20more%20than%203%20heading%20levels%5CnreassembledBody%20=%20reassembledBody%5Cn.replace(/%5E%23%23%23%23%5C%5Cs/mg,%20%5C%22%23%23%23%20%5C%22)%5Cn.replace(/%5E%23%23%23%23%23%5C%5Cs/mg,%20%5C%22%23%23%23%20%5C%22)%5Cn.replace(/%5E%23%23%23%23%23%23%5C%5Cs/mg,%20%5C%22%23%23%23%20%5C%22);%5Cn%5Cnif%20(DEBUG)%20%7B%5Cn%20%20markdownOutputBody%20=%20reassembledBody;%5Cn%7D%20else%20%7B%5Cn%20%20markdownOutputBody%20=%20mmd.render(reassembledBody);%5Cn%7D%5Cn%5CnprocessedLists.forEach((list,%20index)%20=%5Cu003e%20%7B%5Cn%20%20markdownOutputBody%20=%20markdownOutputBody.replace(%60%7B%7BREPLACE_LIST-$%7Bindex%20+%201%7D%7D%7D%60,%20list.join(%5C%22%5C%5Cn%5C%22));%5Cn%7D)%5Cn%5Cn//%20solution%20to%20malformed%20p%20multiline%5Cnlet%20pMatcher%20=%20/%5Cu003cp%5Cu003e((.%7C%5C%5Cn)*?)%5Cu003c%5C%5C/p%5Cu003e/g;%5Cnlet%20pmarkdownOutputBodyCopy%20=%20markdownOutputBody;%5Cn%5Cnwhile%20(matched%20=%20pMatcher.exec(pmarkdownOutputBodyCopy))%20%7B%5Cn%20%20const%20splitedLines%20=%20matched[1].split(%5C%22%5C%5Cn%5C%22);%5Cn%5Cn%20%20if%20(%5Cn%20%20%20%20%20%20splitedLines.length%20%5Cu003e%201%5Cn%20%20%20%20%20%20%5Cu0026%5Cu0026%20!matched[0].includes(%5C%22%5Cu003cul%5Cu003e%5C%22)%5Cn%20%20%20%20%20%20%5Cu0026%5Cu0026%20!matched[0].includes(%5C%22%5Cu003col%5Cu003e%5C%22)%5Cn%20%20%5Ct%20)%20%7B%5Cn%20%20%20%20const%20output%20=%20splitedLines.map((split)%20=%5Cu003e%20%7B%5Cn%20%20%20%20%20%20return%20%60%5Cu003cdiv%5Cu003e$%7Bsplit%7D%5Cu003c/div%5Cu003e%60;%5Cn%20%20%20%20%7D);%5Cn%5Cn%20%20%20%20markdownOutputBody%20=%20markdownOutputBody.replace(matched[0],%20output.join(%5C%22%5C%5Cn%5C%22))%5Cn%20%20%7D%5Cn%7D%5Cn%5Cn//%20Improve%20table%20formatting%5Cn%5CnmarkdownOutputBody%20=%20markdownOutputBody%5Cn.replace(/%5C%5Cn%5Cu003ctable%5Cu003e((.%7C%5C%5Cn)*?)%5Cu003cthead%5Cu003e/g,%20%5C%22%5Cu003ctable%5Cu003e%5Cu003cthead%5Cu003e%5C%22);%5Cn%5Cn//%20Take%20code%20blocks%20out%20of%20base%20flow%20before%20formatting%20line%20breaks%5Cnlet%20preCodeMatcher%20=%20/%5Cu003cpre%5Cu003e%5Cu003ccode%5Cu003e((.%7C%5C%5Cn)*?)%5Cu003c%5C%5C/code%5Cu003e%5Cu003c%5C%5C/pre%5Cu003e/g;%5Cnlet%20preCodeMarkdownOutputBodyCopy%20=%20markdownOutputBody;%5Cn%5Cnwhile%20(matched%20=%20preCodeMatcher.exec(preCodeMarkdownOutputBodyCopy))%20%7B%5Cn%20%20markdownOutputBody%20=%20markdownOutputBody.replace(matched[0],%5Cn%20%20%20%20&#39;%5Cu003cdiv%20style=%5C%22--en-codeblock:true;box-sizing:%20border-box;%20padding:%208px;%20font-family:%20Monaco,%20Menlo,%20Consolas,%20%5Cu0026quot;Courier%20New%5Cu0026quot;,%20monospace;%20font-size:%2012px;%20color:%20rgb(51,%2051,%2051);%20border-top-left-radius:%204px;%20border-top-right-radius:%204px;%20border-bottom-right-radius:%204px;%20border-bottom-left-radius:%204px;%20background-color:%20rgb(251,%20250,%20248);%20border:%201px%20solid%20rgba(0,%200,%200,%200.14902);%20background-position:%20initial%20initial;%20background-repeat:%20initial%20initial;%5C%22%5Cu003e%5Cu003cpre%5Cu003e&#39;%5Cn%20%20%20%20+(matched[1].split(%5C%22%5C%5Cn%5C%22).map((codeLine,%20index,%20content)%20=%5Cu003e%20%7B%5Cn%20%20%20%20%20%20if%20(index%20===%20(content.length-1))%20%7B%5Cn%20%20%20%20%20%20%20return%20&#39;&#39;;%5Cn%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20if%20(codeLine.trim()%20===%20&#39;&#39;)%20%7B%5Cn%20%20%20%20%20%20%20%20return%20%60%5Cu003cdiv%5Cu003e%5Cu003cbr%20/%5Cu003e%5Cu003c/div%5Cu003e%60;%5Cn%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20return%20%60%5Cu003cdiv%5Cu003e$%7BcodeLine%7D%5Cu003c/div%5Cu003e%60;%5Cn%20%20%20%20%7D)).join(%5C%22%5C%22)%5Cn%20%20%20%20+%5C%22%5Cu003c/pre%5Cu003e%5Cu003c/div%5Cu003e%5C%22%5Cn%20%20%20%20);%5Cn%7D%5Cn%5Cn//%20ENML%20compatable%20line%20breaks%5Cnlet%20enmlOutput%20=%20markdownOutputBody%5Cn.replace(/%5Cu003cfigure%5Cu003e/g,%20&#39;&#39;)%5Cn.replace(/%5Cu003c%5C%5C/figure%5Cu003e/g,%20&#39;&#39;)%5Cn.replace(/%5Cu003cfigcaption%5Cu003e/g,&#39;&#39;)%5Cn.replace(/%5Cu003c%5C%5C/figcaption%5Cu003e/g,%20&#39;&#39;)%5Cn.replace(/%5Cu003cp%5Cu003e/g,%20%5C%22%5Cu003cdiv%5Cu003e%5C%22)%5Cn.replace(/%5Cu003c%5C%5C/p%5Cu003e/g,%20%5C%22%5Cu003c/div%5Cu003e%5C%22)%5Cn.replace(/%5C%5Cn(%5C%5Cs)*?%5C%5Cn/g,%5C%22%5C%5Cn%5Cu003cdiv%5Cu003e%5Cu003cbr%20%5C%5C/%5Cu003e%5Cu003c%5C%5C/div%5Cu003e%5C%5Cn%5C%22);%5Cn%5Cnif%20(CONFIG_MONOSPACE_INLINE_CODEBLOCKS)%20%7B%5Cn%20%20enmlOutput%20=%20enmlOutput.replace(/%5Cu003ccode%5Cu003e(.*?)%5Cu003c%5C%5C/code%5Cu003e/g,%5Cn%20%20(_,%20c1)%20=%5Cu003e%20%60%5Cu003cspan%20style=%5C%22--en-fontfamily:%20monospace;%20font-family:%20%5Cu0026quot;Source%20Code%20Pro%5Cu0026quot;,monospace%5C%22%5Cu003e%5C%5C%60$%7Bc1%7D%5C%5C%60%5Cu003c/span%5Cu003e%60)%5Cn%7D%5Cn%5Cnif%20(DEBUG)%20%7B%5Cn%20%20console.log(enmlOutput);%5Cn%7D%20else%20%7B%5Cn%20%20draft.setTemplateTag(%5C%22enmlOutput%5C%22,%20enmlOutput);%5Cn%7D%22,%22allowAsync%22:%22false%22%7D,%22type%22:%22script%22,%22isEnabled%22:true,%22uuid%22:%225E504035-9657-4868-BCCE-9EA873BBF1DC%22%7D,%7B%22platforms%22:3,%22data%22:%7B%22template%22:%22[[enmlOutput]]%22,%22nameTemplate%22:%22[[safe_title]]%22,%22writeType%22:%22create%22,%22tagTemplate%22:%22[[tags]]%22,%22notebookTemplate%22:%22%22,%22format%22:%22enml%22%7D,%22type%22:%22evernote%22,%22isEnabled%22:true,%22uuid%22:%22F6250A3C-E0F7-4378-A484-BA1EBFABF6F6%22%7D],%22backingPlatforms%22:3,%22shortName%22:%22%22,%22shouldConfirm%22:false,%22disposition%22:3,%22keyCommand%22:%7B%22optionKey%22:false,%22input%22:%22%22,%22controlKey%22:false,%22commandKey%22:false,%22type%22:%22action%22,%22discoverabilityTitle%22:%22Save%20to%20Evernote%20(Full%20Formatting)%22,%22shiftKey%22:false%7D,%22logLevel%22:2,%22groupDisposition%22:0,%22notificationType%22:2,%22tintColor%22:%22green%22,%22actionDescription%22:%22Convert%20draft%20Markdown%20to%20ENML%20and%20save%20to%20a%20note%20in%20Evernote%20with%20the%20title%20as%20note%20name.%5Cn%5CnThis%20action%20uses%20some%20scripting%20to%20make%20the%20draft%20output%20be%20compatible%20with%20Evernote%20(ENML)%22,%22keyUseIcon%22:false,%22icon%22:%22action_evernote%22,%22visibility%22:224,%22backingIsSeparator%22:false,%22groupUUID%22:%22CAD8683F-6000-462E-913B-7C3F67D396A2%22,%22assignTags%22:[],%22name%22:%22Save%20to%20Evernote%20(Full%20Formatting)%22%7D">Install</a>
</div>

<div>
  <h4>Steps</h4>
<ul class='steps'>
  <li>
    <div class='step'><h3>script</h3><pre><code class='language-javascript'>const CONFIG_LIST_INDENT_SPACES = 4;
const CONFIG_MONOSPACE_INLINE_CODEBLOCKS = true;
const CONFIG_RETAIN_CODE_BLOCK_LANG_AS_COMMENT = true; // Code block langage is not supported by ENML

const DEBUG_STRING = ``;
const DEBUG = false;

const TYPE_CHECK_UNCHECKED = &quot;TYPE_CHECKLIST_UNCHECKED&quot;;
const TYPE_CHECK_CHECKED = &quot;TYPE_CHECK_CHECKED&quot;;
const TYPE_UL = &quot;TYPE_UL&quot;;
const TYPE_OL = &quot;TYPE_OL&quot;;

let mmd;

if (!DEBUG) {
  mmd = MultiMarkdown.create();

  mmd.format = &quot;html&quot;;
  mmd.noMetadata = true;
  mmd.footnotesEnabled = false;
  mmd.criticMarkup = true;
}

function getListIndent(listItemType, listItem) {

  function indentPosition(RegexTest) {
    const indexLocationToFirstChar = listItem.match(RegexTest);


    if (indexLocationToFirstChar) {

      const indent = indexLocationToFirstChar[2];
      let spacesCount = 0;

      if (indent) {
        spacesCount = indent.length
      }

      return Math.ceil(spacesCount/CONFIG_LIST_INDENT_SPACES)
    } else {
      return 0
    }
  };

  switch(listItemType) {
    case TYPE_CHECK_UNCHECKED:
      return indentPosition(new RegExp(/^((\s+)?- \[\s\])/));
    case TYPE_CHECK_CHECKED:
      return indentPosition(new RegExp(/^((\s+)?- \[x\])/));
    case TYPE_UL:
      return indentPosition(new RegExp(/^((\s+)?-\s)/)) || indentPosition(new RegExp(/^((\s+)?\*\s)/));
    case TYPE_OL:
      return indentPosition(new RegExp(/^((\s+)?\d+\.\s)/));
  }
}

function getListItemType(line) {
  if (!line) return null;

  const trimmedLine = line.trim();
  const firstFiveChars = trimmedLine.substring(0, 5);
  const firstTwoChars = trimmedLine.substring(0, 2);

  if (firstFiveChars === &quot;- [ ]&quot; ) {
    return TYPE_CHECK_UNCHECKED;
  } else if(firstFiveChars === &quot;- [x]&quot;) {
    return TYPE_CHECK_CHECKED;
  } else if (firstTwoChars === &quot;- &quot; || firstTwoChars === &quot;* &quot;) {
    return TYPE_UL;
  } else if (firstFiveChars.match(/^\d+\.\s/)) {
    return TYPE_OL;
  } else {
    return null
  }
}

let draftBody = &#39;&#39;;

if (DEBUG) {
  draftBody = DEBUG_STRING;
} else {
  draftBody = draft.content;
}

// Fix &lt;hr /&gt; converted incorrectly by some apps in correctly by some apps
draftBody = draftBody
.replace(/&lt;/g, &quot;&amp;lt;&quot;)
.replace(/&gt;/g, &quot;&amp;gt;&quot;)
.replace(/^-\s-\s-\s-$/gm, &quot;---&quot;)
.replace(/\t/g,&quot;    &quot;);

const originalContent = draftBody.split(&quot;\n&quot;);
const originalContentWorkingCopy = draftBody.split(&quot;\n&quot;);
originalContent.shift();
originalContentWorkingCopy.shift();

let listGroups = [[]];
let processingGroup = false;

// Create groupings of lists to be converted to ENML
originalContent.forEach((line, index) =&gt; {

  const lineRecord = {};
  const listItemType = getListItemType(line);
  let listItemFound = Boolean(listItemType);

  if (listItemType) {
    lineRecord.type = listItemType;
    lineRecord.indentPosition = getListIndent(listItemType, line);
  }

  const groupStartCriteriaMatch = (!originalContent[index-1] ||
    !Boolean(getListItemType(originalContent[index-1]))) &amp;&amp;
    listItemFound;
  const groupEndCriteriaMatch = (!originalContent[index+1] ||
  originalContent[index+1].trim() === &quot;&quot;) || !Boolean(getListItemType(originalContent[index+1]));

	if (processingGroup || groupStartCriteriaMatch) {
    if (!processingGroup) {
      processingGroup = true;
      originalContentWorkingCopy[index] = `{{REPLACE_LIST-${listGroups.length}}}`;
    } else {
      originalContentWorkingCopy[index] = null;
    }

    lineRecord.content = line.trim();

    listGroupsLastIndex = listGroups.length-1;
    listGroups[listGroupsLastIndex].push(lineRecord);

    if (groupEndCriteriaMatch) {
      listGroups.push([]);
    	processingGroup = false;
    }
  }
});

// Clean up list groups
listGroups = listGroups.filter((listGroup) =&gt; Boolean(listGroup.length));

let processedLists = [];

if (listGroups.length) {
  listGroups.forEach((listGroup, groupIndex) =&gt; {

    processedLists.push([]);
    let currentIndentPosition = 0;
    let endTagStack = [];

    listGroup.forEach((listItem, itemIndex) =&gt; {

      if (itemIndex === 0) {
        if (listItem.type === TYPE_OL) {
          processedLists[groupIndex].push(&quot;&lt;ol&gt;&quot;);
          endTagStack.push(&quot;&lt;/ol&gt;&quot;);
        } else {
          processedLists[groupIndex].push(&quot;&lt;ul&gt;&quot;);
          endTagStack.push(&quot;&lt;/ul&gt;&quot;);
        }
      }

      if(currentIndentPosition != listItem.indentPosition) {
        if (currentIndentPosition &lt; listItem.indentPosition) {
          if (listItem.type === TYPE_OL) {
            processedLists[groupIndex].push(&quot;&lt;ol&gt;&quot;);
            endTagStack.push(&quot;&lt;/ol&gt;&quot;);
          } else {
            processedLists[groupIndex].push(&quot;&lt;ul&gt;&quot;);
            endTagStack.push(&quot;&lt;/ul&gt;&quot;);
          }
        } else {
          (new Array(currentIndentPosition - listItem.indentPosition)).fill().forEach(() =&gt; {
            processedLists[groupIndex].push(endTagStack.pop())
          });
        }

        currentIndentPosition = listItem.indentPosition;
      }

      // Prepare list item for insertion
      let preparedListItem = listItem.content.trim();


      function markdownRenderList(content) {
        if (!DEBUG) {
          return mmd.render(content).replace(&quot;&lt;p&gt;&quot;, &quot;&quot;).replace(&quot;&lt;/p&gt;&quot;, &quot;&quot;);
        } else {
          return content;
        };
      }

      switch (listItem.type) {
        case TYPE_CHECK_UNCHECKED:
          preparedListItem = preparedListItem.replace(&quot;- [ ] &quot;, &#39;&#39;);
          preparedListItem = markdownRenderList(preparedListItem);
          preparedListItem = &#39;&lt;en-todo checked=&quot;false&quot; /&gt;&#39; + preparedListItem;
          break;
        case TYPE_CHECK_CHECKED:
          preparedListItem = preparedListItem.replace(&quot;- [x] &quot;, &#39;&#39;);
          preparedListItem = markdownRenderList(preparedListItem);
          preparedListItem = &#39;&lt;en-todo checked=&quot;true&quot; /&gt;&#39; + preparedListItem;
          break;
        case TYPE_UL:
          preparedListItem = preparedListItem.replace(/^-\s|^\*\s/, &#39;&#39;);
          preparedListItem = markdownRenderList(preparedListItem);
          break;
        case TYPE_OL:
          preparedListItem = preparedListItem.replace(/^\d+\.\s/, &#39;&#39;);
          preparedListItem = markdownRenderList(preparedListItem);
          break;
      }

      processedLists[groupIndex].push(`&lt;li&gt;${preparedListItem}&lt;/li&gt;`);

      if(listGroups[groupIndex].length-1 === itemIndex) {

        new Array(endTagStack.length).fill().forEach(() =&gt; {
          processedLists[groupIndex].push(endTagStack.pop())
        });
      }
    })
  })
}

// Final result

let reassembledBody = originalContentWorkingCopy
.filter((line) =&gt; line !== null
).join(&quot;\n&quot;);

let markdownOutputBody = &#39;&#39;;

if (CONFIG_RETAIN_CODE_BLOCK_LANG_AS_COMMENT) {
  reassembledBody = reassembledBody.replace(/^```([A-Za-z]+)$/mg, (_, c1) =&gt; &quot;```\n//&quot; + c1 + &quot;\n&quot;)
} else {
  reassembledBody = reassembledBody.replace(/^```([A-Za-z]+)/mg, &quot;```&quot;);
}

// New Evernote does not support more than 3 heading levels
reassembledBody = reassembledBody
.replace(/^####\s/mg, &quot;### &quot;)
.replace(/^#####\s/mg, &quot;### &quot;)
.replace(/^######\s/mg, &quot;### &quot;);

if (DEBUG) {
  markdownOutputBody = reassembledBody;
} else {
  markdownOutputBody = mmd.render(reassembledBody);
}

processedLists.forEach((list, index) =&gt; {
  markdownOutputBody = markdownOutputBody.replace(`{{REPLACE_LIST-${index + 1}}}`, list.join(&quot;\n&quot;));
})

// solution to malformed p multiline
let pMatcher = /&lt;p&gt;((.|\n)*?)&lt;\/p&gt;/g;
let pmarkdownOutputBodyCopy = markdownOutputBody;

while (matched = pMatcher.exec(pmarkdownOutputBodyCopy)) {
  const splitedLines = matched[1].split(&quot;\n&quot;);

  if (
      splitedLines.length &gt; 1
      &amp;&amp; !matched[0].includes(&quot;&lt;ul&gt;&quot;)
      &amp;&amp; !matched[0].includes(&quot;&lt;ol&gt;&quot;)
  	 ) {
    const output = splitedLines.map((split) =&gt; {
      return `&lt;div&gt;${split}&lt;/div&gt;`;
    });

    markdownOutputBody = markdownOutputBody.replace(matched[0], output.join(&quot;\n&quot;))
  }
}

// Improve table formatting

markdownOutputBody = markdownOutputBody
.replace(/\n&lt;table&gt;((.|\n)*?)&lt;thead&gt;/g, &quot;&lt;table&gt;&lt;thead&gt;&quot;);

// Take code blocks out of base flow before formatting line breaks
let preCodeMatcher = /&lt;pre&gt;&lt;code&gt;((.|\n)*?)&lt;\/code&gt;&lt;\/pre&gt;/g;
let preCodeMarkdownOutputBodyCopy = markdownOutputBody;

while (matched = preCodeMatcher.exec(preCodeMarkdownOutputBodyCopy)) {
  markdownOutputBody = markdownOutputBody.replace(matched[0],
    &#39;&lt;div style=&quot;--en-codeblock:true;box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &amp;quot;Courier New&amp;quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.14902); background-position: initial initial; background-repeat: initial initial;&quot;&gt;&lt;pre&gt;&#39;
    +(matched[1].split(&quot;\n&quot;).map((codeLine, index, content) =&gt; {
      if (index === (content.length-1)) {
       return &#39;&#39;;
      }
      if (codeLine.trim() === &#39;&#39;) {
        return `&lt;div&gt;&lt;br /&gt;&lt;/div&gt;`;
      }
      return `&lt;div&gt;${codeLine}&lt;/div&gt;`;
    })).join(&quot;&quot;)
    +&quot;&lt;/pre&gt;&lt;/div&gt;&quot;
    );
}

// ENML compatable line breaks
let enmlOutput = markdownOutputBody
.replace(/&lt;figure&gt;/g, &#39;&#39;)
.replace(/&lt;\/figure&gt;/g, &#39;&#39;)
.replace(/&lt;figcaption&gt;/g,&#39;&#39;)
.replace(/&lt;\/figcaption&gt;/g, &#39;&#39;)
.replace(/&lt;p&gt;/g, &quot;&lt;div&gt;&quot;)
.replace(/&lt;\/p&gt;/g, &quot;&lt;/div&gt;&quot;)
.replace(/\n(\s)*?\n/g,&quot;\n&lt;div&gt;&lt;br \/&gt;&lt;\/div&gt;\n&quot;);

if (CONFIG_MONOSPACE_INLINE_CODEBLOCKS) {
  enmlOutput = enmlOutput.replace(/&lt;code&gt;(.*?)&lt;\/code&gt;/g,
  (_, c1) =&gt; `&lt;span style=&quot;--en-fontfamily: monospace; font-family: &amp;quot;Source Code Pro&amp;quot;,monospace&quot;&gt;\`${c1}\`&lt;/span&gt;`)
}

if (DEBUG) {
  console.log(enmlOutput);
} else {
  draft.setTemplateTag(&quot;enmlOutput&quot;, enmlOutput);
}</code></pre></div>
  </li>
  <li>
    <div class='step'><h3>evernote</h3><table class='action-detail'><tr><td class='cell-label'>nameTemplate</td><td class='value'><pre>[[safe_title]]</pre></td></tr><tr><td class='cell-label'>notebookTemplate</td><td class='value'><pre></pre></td></tr><tr><td class='cell-label'>tagTemplate</td><td class='value'><pre>[[tags]]</pre></td></tr><tr><td class='cell-label'>template</td><td class='value'><pre>[[enmlOutput]]</pre></td></tr><tr><td class='cell-label'>format</td><td class='value'><pre>enml</pre></td></tr><tr><td class='cell-label'>writeType</td><td class='value'><pre>create</pre></td></tr></table></div>
  </li>
</ul>
</div>

<div>
  <h4>Options</h4>
  <ul class="steps">
    <li>
  <table class='action-detail'>
    <tr>
      <td class="cell-label">After Success</td>
      <td class="value">
        Default
        
      </td>
    </tr>
    <tr>
      <td class="cell-label">Notification</td>
      <td class="value">Info</td>
    </tr>
    <tr>
      <td class="cell-label">Log Level</td>
      <td class="value">Info</td>
    </tr>
  </table>
</li>
</ul>
</div>

<div class="disclaimer">
  Items available in the Drafts Directory are uploaded by community members. Use appropriate caution reviewing downloaded items before use.
</div>


                  </div>
                  <div class="footer-content">
                  <p>
                  <a href="https://itunes.apple.com/app/id1236254471?ls=1&mt=8&at=11l4Cf&ct=site">
                    <img alt="Download on App Store" src="../assets/appstore-deaf597bd57239c5054c59099e54ab9014f1e15eddb961085428e0ce94d4385b.svg" />
                  </a>
                  <a href="https://itunes.apple.com/app/id1435957248?mt=12&at=11l4Cf&ct=site">
                    <img alt="Download on Mac App Store" src="../assets/macappstore-05f5eed00e6bb26b68c1368217276158329862682e6d61b3ed193f819fe02f2f.svg" />
                  </a>
                  </p>
                    &copy; 2012-2022 by Agile Tortoise, Inc.<br/>
                    Drafts is a registered Trademark of Agile Tortoise, Inc.<br/>
                    <a href="https://actions.getdrafts.com/getdrafts.com/support/privacy.html">Privacy</a> | <a href="https://actions.getdrafts.com/getdrafts.com/support/terms.html">Terms</a>
                </div>
                </div>
            </div>
        </div>
    </div>

  </body>
  </html>
