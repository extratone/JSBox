<!DOCTYPE html>
<html lang='en'>
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <title>crosslink Todoist task &amp; DTTG document | Drafts Directory</title>
    <meta name="csrf-param" content="authenticity_token" />
<meta name="csrf-token" content="p8CLsxlZsLPe97eK+U9exTGKv0JXzxUECJgIQa1aEPbU3605fTIXVlGnDNqtDAXblilhuakfX6Il6Vo4hKKOBA==" />
    <meta http-equiv="content-type" content="text/html;charset=utf-8">
    <meta http-equiv="content-language" content="en">
    <meta http-equiv="content-language" content="en-us">
    
    <meta name="viewport" content="width=device-width, initial-scale=1">
    
    <meta property="og:title" content="Drafts Directory: crosslink Todoist task &amp; DTTG document" />
    <meta property="og:url" content="https://actions.getdrafts.com/a/1lu" />
    <meta property="og:type" content="website" />
    <meta property="og:description" content="Example actions and other extensions for Drafts, the quick-capture notes app." />
    <meta property="og:image" content="https://actions.getdrafts.com/assets/drafts-ogimage-action-d9c60102fd45e0cb516e1b49ed50a81e3c3a2b90f81f55df8f43d0feb0512978.png" />
    <meta property="twitter:title" content="Drafts Directory: crosslink Todoist task &amp; DTTG document" />
    <meta property="twitter:url" content="https://actions.getdrafts.com/a/1lu" />
    <meta property="twitter:type" content="website" />
    <meta property="twitter:description" content="Example actions and other extensions for Drafts, the quick-capture notes app." />
    <meta property="twitter:image" content="https://actions.getdrafts.com/assets/drafts-ogimage-action-d9c60102fd45e0cb516e1b49ed50a81e3c3a2b90f81f55df8f43d0feb0512978.png" />

    <link rel="shortcut icon" type="image/x-icon" href="../assets/favicon-114dbb66b0ef0399a14fa5dfcad7e6210bb558c30cea665e04d49b59fec87f70.png" />

    <link rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.4.0/styles/default.min.css">
    <link rel="stylesheet" media="all" href="../assets/application-6e4f014b4c48cd673942dbfbbeb3e571a732b05562ddde5904f3a5c3833e54ff.css" />
    <script src="../assets/application-13492939cb10be5be76b5abb3e9ae0bef0bbae3202cec2b85cf6fca5bc8429c8.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.4.0/highlight.min.js"></script>
    <script>hljs.highlightAll();</script>
    <script async defer data-domain="directory.getdrafts.com" src="https://plausible.io/js/plausible.js"></script>
  </head>

<body data-no-turbolink>

    <div class="page-wrap">
        <div class="side-bar">
            <a href="../index.html" class="site-title fs-6 lh-tight" title="{{ site.title }}">
                <img src="../assets/drafts-directory-header-4d826bd007f515c8e5a10f654e56ad76fbb3bd3103a67ce342283f701f1677fe.svg" alt="Drafts Directory" style="max-height: 30px;" />
            </a>
            <span class="fs-3"><button class="js-main-nav-trigger navigation-list-toggle btn btn-outline" type="button"
                    data-text-toggle="Hide">Menu</button></span>
            <div class="navigation main-nav js-main-nav">
              <ul class="navigation-list">
                <li class="navigation-list-item">
                  <a class="navigation-list-link" href="../index.html">Home</a>
                </li>
                <li class="navigation-list-item">
                  <a class="navigation-list-link" href="../drafts_actions.html">Actions</a>
                </li>
                <li class="navigation-list-item">
                  <a class="navigation-list-link" href="../drafts_action_groups.html">Action Groups</a>
                </li>
                <li class="navigation-list-item">
                  <a class="navigation-list-link" href="../syntax_definitions.html">Syntaxes</a>
                </li>
                <li class="navigation-list-item">
                  <a class="navigation-list-link" href="../theme_definitions.html">Themes</a>
                </li>
                <li class="navigation-list-item">
                  <a class="navigation-list-link" href="../workspaces.html">Workspaces</a>
                </li>
                <li class="navigation-list-item">
                  <hr style="margin:1em; padding: 0;" />
                </li>
                <li class="navigation-list-item">
                  <a class="navigation-list-link" href="../search.html">Search</a>
                </li>
                <li class="navigation-list-item">
                  <hr style="margin:1em; padding: 0;" />
                </li>
                <li class="navigation-list-item">
                    <a class="navigation-list-link nav-external" title="About Drafts" href="../../getdrafts.com/index.html">Get Drafts &#x2192;</a>
                </li>
                <li class="navigation-list-item">
                    <a class="navigation-list-link nav-external" title="Detailed documentation" href="../../docs.getdrafts.com/index.html">User Guide &#x2192;</a>
                </li>
                <li class="navigation-list-item">
                    <a class="navigation-list-link nav-external" title="Get your questions answered in the forums" href="https://forums.getdrafts.com/">Community &#x2192;</a>
                </li>
                <li class="navigation-list-item">
                    <a class="navigation-list-link nav-external" title="Online tools and generators" href="../../tools.getdrafts.com/index.html">Tools &#x2192;</a>
                </li>
                <li class="navigation-list-item">
                    <a class="navigation-list-link nav-external" title="Scripting library reference" href="../../scripting.getdrafts.com/index.html">Script Reference &#x2192;</a>
                </li>
              </ul>
            </div>
            <footer role="contentinfo" class="site-footer">
                <p class="text-small text-grey-dk-000 mb-0">
                    Download: <a href="https://itunes.apple.com/app/id1236254471?ls=1&mt=8&at=11l4Cf&ct=site">iOS</a> | <a href="https://itunes.apple.com/app/id1435957248?mt=12&at=11l4Cf&ct=site">Mac</a>
                </p>
            </footer>
        </div>
        <div class="main-content-wrap js-main-content" tabindex="0">
            <div class="page-header">
                <div class="main-content">
                    <div class="search js-search">
	<div class="search-input-wrap">
<form class="search-form" action="../search.html" accept-charset="UTF-8" method="get"><input name="utf8" type="hidden" value="&#x2713;" />
	<button style='border:none;background-color:transparent;'>
	<svg width="14" height="14" viewBox="0 0 28 28" xmlns="http://www.w3.org/2000/svg"
		class="search-icon">
		<title>Search</title>
		<g fill-rule="nonzero">
			<path
				d="M17.332 20.735c-5.537 0-10-4.6-10-10.247 0-5.646 4.463-10.247 10-10.247 5.536 0 10 4.601 10 10.247s-4.464 10.247-10 10.247zm0-4c3.3 0 6-2.783 6-6.247 0-3.463-2.7-6.247-6-6.247s-6 2.784-6 6.247c0 3.464 2.7 6.247 6 6.247z" />
			<path d="M11.672 13.791L.192 25.271 3.02 28.1 14.5 16.62z" />
		</g>
	</svg>
	</button>
	<input type="text" name="q" id="q" class="js-search-input search-input search" size="12" tabindex="0" placeholder="Search" />
</form>	</div>
</div>
                    <ul class="list-style-none text-small mt-md-1 mb-md-1 pb-4 pb-md-0 js-aux-nav aux-nav">
                        <li class="d-inline-block my-0 mr-2">
                          <a href="../../getdrafts.com/index.html">Get Drafts</a>
                        </li>
                        <li class="d-inline-block my-0">
                          <a href="https://forums.getdrafts.com">Community</a>
                        </li>
                    </ul>
                </div>
            </div>
            <div class="main-content">
                <div id="main-content" class="page-content" role="main">
                  <div class="type">
                    <h4>Action</h4>
                  </div>
                  <div class="header">
                      <h1><img src="https://config.agiletortoise.com/drafts-icons/645-link.png" class="action-icon" />crosslink Todoist task &amp; DTTG document</h1>
                  </div>

                  <div class="content">
                    
<div class='caption'>
        Posted by FlohGro,
    Last update
    3 months ago
</div>

    <div class='update_notes'>
      <h3>UPDATES</h3>
      <div id="firstUpdateNote">
      <h4>3 months ago</h4>
      <p>prevented execution on the mac</p>

      </div>
      <a href="1lu.html#" onclick="document.getElementById('firstUpdateNote').classList.add('hide');document.getElementById('additionalNotes').classList.remove('hide');this.classList.add('hide');return false;">show all updates...</a>
      <div id="additionalNotes" class='hide'>
        <div>
        <h4>3 months ago</h4>
        <p>prevented execution on the mac</p>

        </div>
        <div>
        <h4>about 1 year ago</h4>
        <p>name updated</p>

        </div>
      </div>
    </div>

    <div class='description'>
        <p><em>created by <a href="https://twitter.com/FlohGro">@FlohGro</a> / more on my <a href="http://www.flohgro.com/blog">Blog</a></em></p>

<h2>crosslink Todoist task &amp; DTTG document</h2>

<p>This action will create a cross-linked Task between Todoist and a DEVONthink document.</p>

<p><em>NOTE: this action will NOT work on macOS since the URL scheme of DEVONthink doesnâ€™t support this</em></p>

<p>A new markdown document will be created in DTTG from the content of the current draft with the first line as title.</p>

<p>The DEVONthink item will be created in the global inbox.</p>

<p>After the document is created the action will create a new task in the inbox of your Todoist account with the title of the markdown document as task name. The task will contain a clickable link to open the corresponding DEVONthink document</p>

<p>When the task was created the action will prepend a link to it into the created markdown document.</p>

<p><em>known &ldquo;issue&rdquo;: if you quickly open the link to the Todoist task after the action prepended the link to the task to the Craft document, your Todoist app may show an error telling you that the task could not be found. The reason for this is, that Todoist needs to sync the created task to your app first (the task is created via the REST API). After the task was synced, the error won&rsquo;t occur again.</em> </p>

<h2>[Configuration]</h2>

<p><em>no configuration needed</em> just install the action (and have DTTG installed on your iPhone.</p>

<p>Technically it would be possible to directly create the DEVONthink item in another group but it would need individual configuration. If you need this please reach out to me.</p>

<h2>[Usage]</h2>

<p>Use this action to create a cross-linked task / document between your task manager and DEVONthink. If you e.g. took some notes during a meeting or while reading a book / blog in Drafts which you need to review or complete later - just run this action. It will help you to quickly navigate between the task and the document without seeing distracting other content.</p>

<hr>

<p><em>If you find this useful and want to support me you can</em> </p>

<p><a href="https://www.buymeacoffee.com/flohgro" target="_blank"><img src="https://cdn.buymeacoffee.com/buttons/v2/default-blue.png" alt="Buy Me A Coffee" style="height: 51px !important;width: 209px !important;" ></a></p>

    </div>

<div class="certification">
  
  <a class='trusted' href='1lu.html#' title='From trusted community member'><img style="width:24px;height:24px;vertical-align:middle;" src="../assets/trusted-c3f95628f768e0a0ed09961d556a8012d1b1be6ae9e6adede683513eec0df814.svg" /> Trusted member</a>
</div>

<div style="margin: 2em 0;">
    <a class="btn btn-blue" href="drafts5://action?identifier=1lu&amp;data=%7B%22uuid%22:%222B7E70EE-8574-4827-A663-265F47DAA732%22,%22steps%22:[%7B%22platforms%22:3,%22data%22:%7B%22script%22:%22//%20cross%20linked%20DEVONthink%20item%20and%20todoist%20task%5Cn%5Cnlet%20title%20=%20draft.displayTitle%5Cn%5Cnlet%20encodedTitle%20=%20encodeURIComponent(title)%5Cn%5Cnlet%20content%20=%20draft.content%5Cn%5Cn//content%20=%20encodeURIComponent(content)%5Cn%5Cnvar%20proceed%20=%20true;%5Cn%5Cnif%20(device.model%20==%20%5C%22Mac%5C%22)%20%7B%5Cnproceed%20=%20false;%5Cnalert(%5C%22can&#39;t%20run%20this%20action%20on%20the%20mac%20-%20the%20url%20scheme%20doesn&#39;t%20support%20this%5C%22);%5Cncontext.fail(%5C%22can&#39;t%20run%20this%20action%20on%20the%20mac%20-%20the%20url%20scheme%20doesn&#39;t%20support%20this%5C%22);%5Cn%7D%5Cn%5Cnconst%20dttgCreateMarkdownBaseURL%20=%20%5C%22x-devonthink://x-callback-url/createmarkdown?%5C%22%5Cnconst%20dttgUpdateDocumentBaseURL%20=%20%5C%22x-devonthink://x-callback-url/update?%5C%22%5Cn%5Cnif%20(proceed)%7B%5Cn%5Cn%5Cnvar%20cbCreateDttgDoc%20=%20CallbackURL.create()%5CncbCreateDttgDoc.baseURL%20=%20dttgCreateMarkdownBaseURL%5Cn//%20unused%20-%20will%20be%20sent%20to%20global%20inbox%20%5Cu0010cbCreateDttgDoc.addParameter(%5C%22destintaion%5C%22,%20destinationUUID)%5CncbCreateDttgDoc.addParameter(%5C%22title%5C%22,%20title)%5CncbCreateDttgDoc.addParameter(%5C%22text%5C%22,%20content)%5CncbCreateDttgDoc.waitForResponse%20=%20true%5Cn%5Cnvar%20dttgCreateReturn%20=%20cbCreateDttgDoc.open()%5Cn%5Cnif%20(dttgCreateReturn%20==%20true)%20%7B%5Cn%20%20%20%20console.log(%5C%22DTTG%20document%20successfully%20created%5C%22)%5Cn%7D%20else%20%7B%5Cn%20%20%20%20proceed%20=%20false%5Cn%20%20%20%20console.log(%5C%22DTTG%20create%20document%20result:%5C%22%20+%20cb.status%20+%20%5C%22%20%5C%22%20+%20cb.callbackResponse)%5Cn%20%20%20%20if%20(cb.status%20==%20%5C%22cancelled%5C%22)%20%7B%5Cn%20%20%20%20%20%20%20%20context.cancel()%5Cn%20%20%20%20%7D%20else%20%7B%5Cn%20%20%20%20%20%20%20%20context.fail()%5Cn%20%20%20%20%7D%5Cn%7D%5Cn%5Cn%7D%5Cn%5Cn//%20craft%20note%20is%20created,%20now%20create%20the%20todoist%20task%20by%20using%20the%20REST%20API%5Cnif%20(proceed)%20%7B%5Cn%5Cn%20%20%20%20//%20retrieve%20info%20from%20craftCreateResult%5Cn%20%20%20%20let%20dttgCreateReturn%20=%20cbCreateDttgDoc.callbackResponse%5Cn%5Cn%20%20%20%20var%20dttgDocumentLink%20=%20dttgCreateReturn[%5C%22text%5C%22]%5Cn%5Cn%20%20%20%20let%20taskNoteStr%20=%20%5C%22DTTG%20Document:%20%5C%22%20+%20dttgDocumentLink%5Cn%20%20%20%20let%20taskTitle%20=%20%5C%22[%5C%22%20+%20title%20+%20%5C%22](%5C%22%20+%20dttgDocumentLink%20+%20%5C%22)%5C%22%5Cn%5Cn%20%20%20%20let%20todoist%20=%20Todoist.create();%5Cn%5Cn%20%20%20%20var%20todoistAddResult%20=%20todoist.quickAdd(taskTitle);%5Cn%20%20%20%20if%20(!todoistAddResult)%20%7B%5Cn%20%20%20%20%20%20%20%20let%20message%20=%20%5C%22Failed%20to%20add%20Task%20to%20todoist:%20%5C%22%20+%20todoist.lastError;%5Cn%20%20%20%20%20%20%20%20console.log(message)%5Cn%20%20%20%20%20%20%20%20context.fail(message);%5Cn%20%20%20%20%20%20%20%20app.displayErrorMessage(message);%5Cn%20%20%20%20%20%20%20%20proceed%20=%20false%5Cn%20%20%20%20%7D%20else%20%7B%5Cn%20%20%20%20%20%20%20%20console.log(%5C%22Successfully%20created%20todoist%20Task%5C%22)%5Cn%20%20%20%20%7D%5Cn%7D%5Cn%5Cn//%20things%20task%20added%20now%20prepend%20the%20link%20to%20the%20previously%20created%20craft%20note%5Cnif%20(proceed)%20%7B%5Cn%5Cn%20%20%20%20//%20retrieve%20info%20from%20todoistAddResult%5Cn%20%20%20%20let%20taskID%20=%20todoistAddResult[%5C%22id%5C%22]%5Cn%5Cn%20%20%20%20let%20showTaskUrl%20=%20%5C%22todoist://task?id=%5C%22%20+%20taskID%5Cn%5Cn%20%20%20%20let%20openTaskStr%20=%20%5C%22%5Cu003e%20Task%20in%20Todoist:%20[%5C%22%20+%20title%20+%20%5C%22](%5C%22%20+%20showTaskUrl%20+%20%5C%22)%5C%22%5Cn%5Cn%20%20%20%20let%20encodedBlockContent%20=%20encodeURIComponent(openTaskStr)%5Cn%5Cn%5Cn%5Cn%20%20%20%20dttgDocumentUUID%20=%20dttgDocumentLink.replace(%5C%22x-devonthink-item://%5C%22,%20%5C%22%5C%22)%5Cn%5Cn%20%20%20%20let%20newContent%20=%20draft.title%20+%20%5C%22%5C%5Cn%5C%5Cn%5C%22%20+%20openTaskStr%20+%20%5C%22%5C%5Cn%5C%5Cn%5C%22%20+%20draft.processTemplate(%5C%22[[body]]%5C%22)%5Cn%5Cn%20%20%20%20let%20encodedContent%20=%20encodeURIComponent(newContent)%5Cn%5Cn%20%20%20%20var%20cbUpdateDTTGDocument%20=%20CallbackURL.create()%5Cn%20%20%20%20cbUpdateDTTGDocument.baseURL%20=%20dttgUpdateDocumentBaseURL%5Cn%20%20%20%20cbUpdateDTTGDocument.addParameter(%5C%22uuid%5C%22,%20dttgDocumentUUID)%5Cn%20%20%20%20cbUpdateDTTGDocument.addParameter(%5C%22text%5C%22,%20newContent)%5Cn%20%20%20%20cbUpdateDTTGDocument.waitForResponse%20=%20true%5Cn%5Cn%20%20%20%20dttgUpdateReturn%20=%20cbUpdateDTTGDocument.open()%5Cn%5Cn%5Cn%20%20%20%20if%20(dttgUpdateReturn%20==%20true)%20%7B%5Cn%20%20%20%20%20%20%20%20console.log(%5C%22DTTG%20document%20successfully%20updated%5C%22)%5Cn%20%20%20%20%7D%20else%20%7B%5Cn%20%20%20%20%20%20%20%20proceed%20=%20false%5Cn%20%20%20%20%20%20%20%20console.log(%5C%22DTTG%20document%20update%20failed:%20%5C%22%20+%20cb.status%20+%20%5C%22%20%5C%22%20+%20cb.callbackResponse)%5Cn%20%20%20%20%20%20%20%20if%20(cb.status%20==%20%5C%22cancelled%5C%22)%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20%20%20context.cancel()%5Cn%20%20%20%20%20%20%20%20%7D%20else%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20%20%20context.fail()%5Cn%20%20%20%20%20%20%20%20%7D%5Cn%20%20%20%20%7D%5Cn%5Cn%7D%22,%22allowAsync%22:%22false%22%7D,%22type%22:%22script%22,%22isEnabled%22:true,%22uuid%22:%22FA0BAC01-4DCC-4B05-9BEC-637D615C0562%22%7D],%22backingPlatforms%22:3,%22shortName%22:%22%22,%22shouldConfirm%22:false,%22disposition%22:3,%22keyCommand%22:%7B%22optionKey%22:false,%22input%22:%22%22,%22controlKey%22:false,%22commandKey%22:false,%22type%22:%22action%22,%22discoverabilityTitle%22:%22crosslink%20Todoist%20task%20%5Cu0026%20DTTG%20document%22,%22shiftKey%22:false%7D,%22logLevel%22:2,%22groupDisposition%22:0,%22notificationType%22:2,%22tintColor%22:%22blue%22,%22actionDescription%22:%22*created%20by%20[@FlohGro](https://twitter.com/FlohGro)%20/%20more%20on%20my%20[Blog](http://www.flohgro.com/blog)*%5Cn%5Cn%23%23%20crosslink%20Todoist%20task%20%5Cu0026%20DTTG%20document%5Cn%5CnThis%20action%20will%20create%20a%20cross-linked%20Task%20between%20Todoist%20and%20a%20DEVONthink%20document.%5Cn%5Cn*NOTE:%20this%20action%20will%20NOT%20work%20on%20macOS%20since%20the%20URL%20scheme%20of%20DEVONthink%20doesn%E2%80%99t%20support%20this*%5Cn%5CnA%20new%20markdown%20document%20will%20be%20created%20in%20DTTG%20from%20the%20content%20of%20the%20current%20draft%20with%20the%20first%20line%20as%20title.%5Cn%5CnThe%20DEVONthink%20item%20will%20be%20created%20in%20the%20global%20inbox.%5Cn%5CnAfter%20the%20document%20is%20created%20the%20action%20will%20create%20a%20new%20task%20in%20the%20inbox%20of%20your%20Todoist%20account%20with%20the%20title%20of%20the%20markdown%20document%20as%20task%20name.%20The%20task%20will%20contain%20a%20clickable%20link%20to%20open%20the%20corresponding%20DEVONthink%20document%5Cn%5CnWhen%20the%20task%20was%20created%20the%20action%20will%20prepend%20a%20link%20to%20it%20into%20the%20created%20markdown%20document.%5Cn%5Cn*known%20%5C%22issue%5C%22:%20if%20you%20quickly%20open%20the%20link%20to%20the%20Todoist%20task%20after%20the%20action%20prepended%20the%20link%20to%20the%20task%20to%20the%20Craft%20document,%20your%20Todoist%20app%20may%20show%20an%20error%20telling%20you%20that%20the%20task%20could%20not%20be%20found.%20The%20reason%20for%20this%20is,%20that%20Todoist%20needs%20to%20sync%20the%20created%20task%20to%20your%20app%20first%20(the%20task%20is%20created%20via%20the%20REST%20API).%20After%20the%20task%20was%20synced,%20the%20error%20won&#39;t%20occur%20again.*%20%5Cn%5Cn%23%23%20[Configuration]%5Cn%5Cn%5Cn*no%20configuration%20needed*%20just%20install%20the%20action%20(and%20have%20DTTG%20installed%20on%20your%20iPhone.%5Cn%5CnTechnically%20it%20would%20be%20possible%20to%20directly%20create%20the%20DEVONthink%20item%20in%20another%20group%20but%20it%20would%20need%20individual%20configuration.%20If%20you%20need%20this%20please%20reach%20out%20to%20me.%5Cn%5Cn%23%23%20[Usage]%5Cn%5Cn%5CnUse%20this%20action%20to%20create%20a%20cross-linked%20task%20/%20document%20between%20your%20task%20manager%20and%20DEVONthink.%20If%20you%20e.g.%20took%20some%20notes%20during%20a%20meeting%20or%20while%20reading%20a%20book%20/%20blog%20in%20Drafts%20which%20you%20need%20to%20review%20or%20complete%20later%20-%20just%20run%20this%20action.%20It%20will%20help%20you%20to%20quickly%20navigate%20between%20the%20task%20and%20the%20document%20without%20seeing%20distracting%20other%20content.%5Cn%5Cn%5Cn---%5Cn%5Cn*If%20you%20find%20this%20useful%20and%20want%20to%20support%20me%20you%20can*%20%5Cn%5Cn%5Cu003ca%20href=%5C%22https://www.buymeacoffee.com/flohgro%5C%22%20target=%5C%22_blank%5C%22%5Cu003e%5Cu003cimg%20src=%5C%22https://cdn.buymeacoffee.com/buttons/v2/default-blue.png%5C%22%20alt=%5C%22Buy%20Me%20A%20Coffee%5C%22%20style=%5C%22height:%2051px%20!important;width:%20209px%20!important;%5C%22%20%5Cu003e%5Cu003c/a%5Cu003e%22,%22keyUseIcon%22:false,%22icon%22:%22645-link%22,%22visibility%22:480,%22backingIsSeparator%22:false,%22groupUUID%22:%22D3BA6BF3-ED1E-4639-9C1C-0B0AE5DB2467%22,%22assignTags%22:[],%22name%22:%22crosslink%20Todoist%20task%20%5Cu0026%20DTTG%20document%22%7D">Install</a>
</div>

<div>
  <h4>Steps</h4>
<ul class='steps'>
  <li>
    <div class='step'><h3>script</h3><pre><code class='language-javascript'>// cross linked DEVONthink item and todoist task

let title = draft.displayTitle

let encodedTitle = encodeURIComponent(title)

let content = draft.content

//content = encodeURIComponent(content)

var proceed = true;

if (device.model == &quot;Mac&quot;) {
proceed = false;
alert(&quot;can&#39;t run this action on the mac - the url scheme doesn&#39;t support this&quot;);
context.fail(&quot;can&#39;t run this action on the mac - the url scheme doesn&#39;t support this&quot;);
}

const dttgCreateMarkdownBaseURL = &quot;x-devonthink://x-callback-url/createmarkdown?&quot;
const dttgUpdateDocumentBaseURL = &quot;x-devonthink://x-callback-url/update?&quot;

if (proceed){


var cbCreateDttgDoc = CallbackURL.create()
cbCreateDttgDoc.baseURL = dttgCreateMarkdownBaseURL
// unused - will be sent to global inbox cbCreateDttgDoc.addParameter(&quot;destintaion&quot;, destinationUUID)
cbCreateDttgDoc.addParameter(&quot;title&quot;, title)
cbCreateDttgDoc.addParameter(&quot;text&quot;, content)
cbCreateDttgDoc.waitForResponse = true

var dttgCreateReturn = cbCreateDttgDoc.open()

if (dttgCreateReturn == true) {
    console.log(&quot;DTTG document successfully created&quot;)
} else {
    proceed = false
    console.log(&quot;DTTG create document result:&quot; + cb.status + &quot; &quot; + cb.callbackResponse)
    if (cb.status == &quot;cancelled&quot;) {
        context.cancel()
    } else {
        context.fail()
    }
}

}

// craft note is created, now create the todoist task by using the REST API
if (proceed) {

    // retrieve info from craftCreateResult
    let dttgCreateReturn = cbCreateDttgDoc.callbackResponse

    var dttgDocumentLink = dttgCreateReturn[&quot;text&quot;]

    let taskNoteStr = &quot;DTTG Document: &quot; + dttgDocumentLink
    let taskTitle = &quot;[&quot; + title + &quot;](&quot; + dttgDocumentLink + &quot;)&quot;

    let todoist = Todoist.create();

    var todoistAddResult = todoist.quickAdd(taskTitle);
    if (!todoistAddResult) {
        let message = &quot;Failed to add Task to todoist: &quot; + todoist.lastError;
        console.log(message)
        context.fail(message);
        app.displayErrorMessage(message);
        proceed = false
    } else {
        console.log(&quot;Successfully created todoist Task&quot;)
    }
}

// things task added now prepend the link to the previously created craft note
if (proceed) {

    // retrieve info from todoistAddResult
    let taskID = todoistAddResult[&quot;id&quot;]

    let showTaskUrl = &quot;todoist://task?id=&quot; + taskID

    let openTaskStr = &quot;&gt; Task in Todoist: [&quot; + title + &quot;](&quot; + showTaskUrl + &quot;)&quot;

    let encodedBlockContent = encodeURIComponent(openTaskStr)



    dttgDocumentUUID = dttgDocumentLink.replace(&quot;x-devonthink-item://&quot;, &quot;&quot;)

    let newContent = draft.title + &quot;\n\n&quot; + openTaskStr + &quot;\n\n&quot; + draft.processTemplate(&quot;[[body]]&quot;)

    let encodedContent = encodeURIComponent(newContent)

    var cbUpdateDTTGDocument = CallbackURL.create()
    cbUpdateDTTGDocument.baseURL = dttgUpdateDocumentBaseURL
    cbUpdateDTTGDocument.addParameter(&quot;uuid&quot;, dttgDocumentUUID)
    cbUpdateDTTGDocument.addParameter(&quot;text&quot;, newContent)
    cbUpdateDTTGDocument.waitForResponse = true

    dttgUpdateReturn = cbUpdateDTTGDocument.open()


    if (dttgUpdateReturn == true) {
        console.log(&quot;DTTG document successfully updated&quot;)
    } else {
        proceed = false
        console.log(&quot;DTTG document update failed: &quot; + cb.status + &quot; &quot; + cb.callbackResponse)
        if (cb.status == &quot;cancelled&quot;) {
            context.cancel()
        } else {
            context.fail()
        }
    }

}</code></pre></div>
  </li>
</ul>
</div>

<div>
  <h4>Options</h4>
  <ul class="steps">
    <li>
  <table class='action-detail'>
    <tr>
      <td class="cell-label">After Success</td>
      <td class="value">
        Default
        
      </td>
    </tr>
    <tr>
      <td class="cell-label">Notification</td>
      <td class="value">Info</td>
    </tr>
    <tr>
      <td class="cell-label">Log Level</td>
      <td class="value">Info</td>
    </tr>
  </table>
</li>
</ul>
</div>

<div class="disclaimer">
  Items available in the Drafts Directory are uploaded by community members. Use appropriate caution reviewing downloaded items before use.
</div>


                  </div>
                  <div class="footer-content">
                  <p>
                  <a href="https://itunes.apple.com/app/id1236254471?ls=1&mt=8&at=11l4Cf&ct=site">
                    <img alt="Download on App Store" src="../assets/appstore-deaf597bd57239c5054c59099e54ab9014f1e15eddb961085428e0ce94d4385b.svg" />
                  </a>
                  <a href="https://itunes.apple.com/app/id1435957248?mt=12&at=11l4Cf&ct=site">
                    <img alt="Download on Mac App Store" src="../assets/macappstore-05f5eed00e6bb26b68c1368217276158329862682e6d61b3ed193f819fe02f2f.svg" />
                  </a>
                  </p>
                    &copy; 2012-2022 by Agile Tortoise, Inc.<br/>
                    Drafts is a registered Trademark of Agile Tortoise, Inc.<br/>
                    <a href="../../getdrafts.com/support/privacy.html">Privacy</a> | <a href="../../getdrafts.com/support/terms.html">Terms</a>
                </div>
                </div>
            </div>
        </div>
    </div>

  </body>
  </html>
