<!DOCTYPE html>
<html lang='en'>
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <title>Daily Readings | Drafts Directory</title>
    <meta name="csrf-param" content="authenticity_token" />
<meta name="csrf-token" content="lR8lO+BtpvIDY55VOtGGD2AT0o9bLmu+q5KzNjVj1+LmAAOxhAYBF4wzJQVukt0Rx7AMdKX+IRiG4+FPHJtJEA==" />
    <meta http-equiv="content-type" content="text/html;charset=utf-8">
    <meta http-equiv="content-language" content="en">
    <meta http-equiv="content-language" content="en-us">
    
    <meta name="viewport" content="width=device-width, initial-scale=1">
    
    <meta property="og:title" content="Drafts Directory: Daily Readings" />
    <meta property="og:url" content="https://actions.getdrafts.com/a/1Dt" />
    <meta property="og:type" content="website" />
    <meta property="og:description" content="Example actions and other extensions for Drafts, the quick-capture notes app." />
    <meta property="og:image" content="https://actions.getdrafts.com/assets/drafts-ogimage-action-d9c60102fd45e0cb516e1b49ed50a81e3c3a2b90f81f55df8f43d0feb0512978.png" />
    <meta property="twitter:title" content="Drafts Directory: Daily Readings" />
    <meta property="twitter:url" content="https://actions.getdrafts.com/a/1Dt" />
    <meta property="twitter:type" content="website" />
    <meta property="twitter:description" content="Example actions and other extensions for Drafts, the quick-capture notes app." />
    <meta property="twitter:image" content="https://actions.getdrafts.com/assets/drafts-ogimage-action-d9c60102fd45e0cb516e1b49ed50a81e3c3a2b90f81f55df8f43d0feb0512978.png" />

    <link rel="shortcut icon" type="image/x-icon" href="../assets/favicon-114dbb66b0ef0399a14fa5dfcad7e6210bb558c30cea665e04d49b59fec87f70.png" />

    <link rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.4.0/styles/default.min.css">
    <link rel="stylesheet" media="all" href="../assets/application-6e4f014b4c48cd673942dbfbbeb3e571a732b05562ddde5904f3a5c3833e54ff.css" />
    <script src="../assets/application-13492939cb10be5be76b5abb3e9ae0bef0bbae3202cec2b85cf6fca5bc8429c8.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.4.0/highlight.min.js"></script>
    <script>hljs.highlightAll();</script>
    <script async defer data-domain="directory.getdrafts.com" src="https://plausible.io/js/plausible.js"></script>
  </head>

<body data-no-turbolink>

    <div class="page-wrap">
        <div class="side-bar">
            <a href="https://actions.getdrafts.com/index.html" class="site-title fs-6 lh-tight" title="{{ site.title }}">
                <img src="../assets/drafts-directory-header-4d826bd007f515c8e5a10f654e56ad76fbb3bd3103a67ce342283f701f1677fe.svg" alt="Drafts Directory" style="max-height: 30px;" />
            </a>
            <span class="fs-3"><button class="js-main-nav-trigger navigation-list-toggle btn btn-outline" type="button"
                    data-text-toggle="Hide">Menu</button></span>
            <div class="navigation main-nav js-main-nav">
              <ul class="navigation-list">
                <li class="navigation-list-item">
                  <a class="navigation-list-link" href="https://actions.getdrafts.com/index.html">Home</a>
                </li>
                <li class="navigation-list-item">
                  <a class="navigation-list-link" href="https://actions.getdrafts.com/drafts_actions.html">Actions</a>
                </li>
                <li class="navigation-list-item">
                  <a class="navigation-list-link" href="https://actions.getdrafts.com/drafts_action_groups.html">Action Groups</a>
                </li>
                <li class="navigation-list-item">
                  <a class="navigation-list-link" href="https://actions.getdrafts.com/syntax_definitions.html">Syntaxes</a>
                </li>
                <li class="navigation-list-item">
                  <a class="navigation-list-link" href="https://actions.getdrafts.com/theme_definitions.html">Themes</a>
                </li>
                <li class="navigation-list-item">
                  <a class="navigation-list-link" href="https://actions.getdrafts.com/workspaces.html">Workspaces</a>
                </li>
                <li class="navigation-list-item">
                  <hr style="margin:1em; padding: 0;" />
                </li>
                <li class="navigation-list-item">
                  <a class="navigation-list-link" href="https://actions.getdrafts.com/search.html">Search</a>
                </li>
                <li class="navigation-list-item">
                  <hr style="margin:1em; padding: 0;" />
                </li>
                <li class="navigation-list-item">
                    <a class="navigation-list-link nav-external" title="About Drafts" href="https://actions.getdrafts.com/getdrafts.com/index.html">Get Drafts &#x2192;</a>
                </li>
                <li class="navigation-list-item">
                    <a class="navigation-list-link nav-external" title="Detailed documentation" href="https://actions.getdrafts.com/docs.getdrafts.com/index.html">User Guide &#x2192;</a>
                </li>
                <li class="navigation-list-item">
                    <a class="navigation-list-link nav-external" title="Get your questions answered in the forums" href="https://forums.getdrafts.com/">Community &#x2192;</a>
                </li>
                <li class="navigation-list-item">
                    <a class="navigation-list-link nav-external" title="Online tools and generators" href="https://actions.getdrafts.com/tools.getdrafts.com/index.html">Tools &#x2192;</a>
                </li>
                <li class="navigation-list-item">
                    <a class="navigation-list-link nav-external" title="Scripting library reference" href="https://actions.getdrafts.com/scripting.getdrafts.com/index.html">Script Reference &#x2192;</a>
                </li>
              </ul>
            </div>
            <footer role="contentinfo" class="site-footer">
                <p class="text-small text-grey-dk-000 mb-0">
                    Download: <a href="https://itunes.apple.com/app/id1236254471?ls=1&mt=8&at=11l4Cf&ct=site">iOS</a> | <a href="https://itunes.apple.com/app/id1435957248?mt=12&at=11l4Cf&ct=site">Mac</a>
                </p>
            </footer>
        </div>
        <div class="main-content-wrap js-main-content" tabindex="0">
            <div class="page-header">
                <div class="main-content">
                    <div class="search js-search">
	<div class="search-input-wrap">
<form class="search-form" action="https://actions.getdrafts.com/search.html" accept-charset="UTF-8" method="get"><input name="utf8" type="hidden" value="&#x2713;" />
	<button style='border:none;background-color:transparent;'>
	<svg width="14" height="14" viewBox="0 0 28 28" xmlns="http://www.w3.org/2000/svg"
		class="search-icon">
		<title>Search</title>
		<g fill-rule="nonzero">
			<path
				d="M17.332 20.735c-5.537 0-10-4.6-10-10.247 0-5.646 4.463-10.247 10-10.247 5.536 0 10 4.601 10 10.247s-4.464 10.247-10 10.247zm0-4c3.3 0 6-2.783 6-6.247 0-3.463-2.7-6.247-6-6.247s-6 2.784-6 6.247c0 3.464 2.7 6.247 6 6.247z" />
			<path d="M11.672 13.791L.192 25.271 3.02 28.1 14.5 16.62z" />
		</g>
	</svg>
	</button>
	<input type="text" name="q" id="q" class="js-search-input search-input search" size="12" tabindex="0" placeholder="Search" />
</form>	</div>
</div>
                    <ul class="list-style-none text-small mt-md-1 mb-md-1 pb-4 pb-md-0 js-aux-nav aux-nav">
                        <li class="d-inline-block my-0 mr-2">
                          <a href="https://actions.getdrafts.com/getdrafts.com/index.html">Get Drafts</a>
                        </li>
                        <li class="d-inline-block my-0">
                          <a href="https://forums.getdrafts.com">Community</a>
                        </li>
                    </ul>
                </div>
            </div>
            <div class="main-content">
                <div id="main-content" class="page-content" role="main">
                  <div class="type">
                    <h4>Action</h4>
                  </div>
                  <div class="header">
                      <h1><img src="https://config.agiletortoise.com/drafts-icons/magazine.png" class="action-icon" />Daily Readings</h1>
                  </div>

                  <div class="content">
                    
<div class='caption'>
        Posted by cowpi,
    Last update
    almost 4 years ago
</div>


    <div class='description'>
        <p>This action accesses the EWTN website for references for the Daily Readings for Mass for the selected date and parses the JSON data returned. The readings are formatted in Markdown and appended to the text in the Drafts’ editor. </p>

<p>(Employs several JavaScript techniques: Drafts’ date picker, HTTP request, JSON parse, and simple date formatting.)</p>

    </div>

<div class="certification">
  
  
</div>

<div style="margin: 2em 0;">
    <a class="btn btn-blue" href="drafts5://action?identifier=1Dt&amp;data=%7B%22uuid%22:%222E69301F-2507-4572-8474-8AA867A7CDB8%22,%22steps%22:[%7B%22type%22:%22script%22,%22data%22:%7B%22script%22:%22//%20This%20script%20accesses%20the%20EWTN%20website%20for%20references%20for%20the%5Cn//%20Daily%20Readings%20for%20the%20selected%20date%20and%20parses%20the%20JSON%20data%5Cn//%20returned.%20The%20readings%20are%20appended%20to%20the%20text%20in%20the%20editor.%5Cn%5Cn%5Cnfunction%20ymdFormat(jsDate)%20%7B%5Cn%5Ct//%20Formats%20date%20as%20yyyy-mm-dd%5Cn%5Ctvar%20m%20=%20jsDate.getMonth()%20+%201;%5Cn%5Ctm%20=%20(m%20%5Cu003e%209)%20?%20m%20:%20&#39;0&#39;%20+%20m;%5Cn%5Ctvar%20d%20=%20jsDate.getDate();%5Cn%5Ctd%20=%20(d%20%5Cu003e%209)%20?%20d%20:%20&#39;0&#39;%20+%20d;%5Cn%5Ctreturn%20jsDate.getFullYear()%20+%20&#39;-&#39;%20+%20m%20+%20&#39;-&#39;%20+%20d;%5Cn%7D%5Cn%5Cnfunction%20niceDateFormat(jsDate)%20%7B%5Cn%5Ct//%20Formats%20date%20as%20day,%20mmm%20d%5Cn%5Ctvar%20mo%20=%20[&#39;Jan&#39;,%20&#39;Feb&#39;,%20&#39;Mar&#39;,%20&#39;Apr&#39;,%20&#39;May&#39;,%20&#39;Jun&#39;,%20&#39;Jul&#39;,%20&#39;Aug&#39;,%20&#39;Sep&#39;,%20&#39;Oct&#39;,%20&#39;Nov&#39;,%20&#39;Dec&#39;];%5Cn%5Ctvar%20dow%20=%20[&#39;Sun&#39;,%20&#39;Mon&#39;,%20&#39;Tue&#39;,%20&#39;Wed&#39;,%20&#39;Thu&#39;,%20&#39;Fri&#39;,%20&#39;Sat&#39;];%5Cn%5Ct//%20do%20not%20include%20day%20if%20Sunday%5Cn%5Ctvar%20day%20=%20(jsDate.getDay()%20%5Cu003e%200)%20?%20(dow[jsDate.getDay()]%20+%20&#39;,%20&#39;)%20:%20&#39;&#39;;%5Cn%5Ctreturn%20day%20+%20mo[jsDate.getMonth()]%20+%20&#39;%20&#39;%20+%20jsDate.getDate();%5Cn%7D%5Cn%5Cn%5Cn//%20Date%20picker%5Cnvar%20p%20=%20Prompt.create();%5Cnp.title%20=%20&#39;Daily%20Readings&#39;;%5Cnp.addDatePicker(&#39;pickDate&#39;,%20&#39;Select%20date%20for%20readings%E2%80%A6&#39;,%20new%20Date(),%20%7B%5C%22mode%5C%22:%20%5C%22date%5C%22%7D);%5Cnp.addButton(&#39;Select&#39;);%5Cnvar%20didSelect%20=%20p.show();%5Cn%5Cnif%20(didSelect)%20%7B%5Cn%5Ct//%20format%20URL%5Cn%5Ctvar%20ymd%20=%20ymdFormat(p.fieldValues[&#39;pickDate&#39;]);%5Cn%5Ctvar%20targetUrl%20=%20&#39;https://www.ewtn.com/se/readings/readingsservice.svc/day/&#39;%20+%20ymd%20+%20&#39;/en&#39;;%5Cn%5Cn%5Ct//%20HTTP%20Request%5Cn%5Ctvar%20http%20=%20HTTP.create();%5Cn%5Ctvar%20response%20=%20http.request(%7B%5C%22url%5C%22:%20targetUrl,%20%5C%22method%5C%22:%20%5C%22GET%5C%22%7D);%5Cn%5Cn%5Ctif%20(!response.success)%20%7B%5Cn%5Ct%5Ct//%20Error%20in%20retrieving%20data%5Cn%5Ct%5Ctvar%20txt%20=%20response.statusCode%20+%20&#39;%20-%20&#39;%20+%20response.error;%5Cn%5Ct%7D%20else%20if%20(response.responseText.length%20%5Cu003c%201)%20%7B%5Cn%5Ct%5Ct//%20no%20data%5Cn%5Ct%5Ctvar%20txt%20=%20&#39;data%20unavailable%20for%20&#39;+%20ymd;%5Cn%5Ct%7D%20else%20%7B%5Cn%5Ct%5Ct//%20Parse%20and%20format%20readings%5Cn%5Ct%5Ctvar%20liturgy%20=%20JSON.parse(response.responseText);%5Cn%5Ct%5Ct%5Cn%5Ct%5Ctvar%20txt%20=%20niceDateFormat(p.fieldValues[&#39;pickDate&#39;]);%5Cn%5Ct%5Cttxt%20+=%20&#39;%20-%20&#39;%20+%20liturgy.Title%20+%20&#39;%5C%5Cn&#39;;%5Cn%5Ct%5Ct%5Cn%5Ct%5Ctvar%20numReadings%20=%20liturgy.ReadingGroups[0].Readings.length;%5Cn%5Cn%5Ct%5Ctfor%20(var%20i%20=%200;%20i%20%5Cu003c%20numReadings;%20i++)%20%7B%5Cn%5Ct%5Ct%5Ctvar%20ref%20=%20liturgy.ReadingGroups[0].Readings[i].Citations[0].Reference;%5Cn%5Ct%5Ct%5Ctvar%20type%20=%20liturgy.ReadingGroups[0].Readings[i].Type;%5Cn%5Ct%5Ct%5Cttxt%20+=%20&#39;**&#39;%20+%20type%20+%20&#39;:**%20&#39;%20+%20ref%20+%20&#39;%5C%5Cn&#39;;%5Cn%5Ct%5Ct%7D%5Cn%5Ct%5Ct//txt%20+=%20liturgy.Color%20+%20&#39;,%20&#39;%20+%20liturgy.Note%20+%20&#39;%5C%5Cn&#39;;%5Cn%5Ct%7D%5Cn%5Cn%5Ct//%20insert%20text%20into%20editor%5Cn%5Ctvar%20len%20=%20editor.getText().length;%5Cn%5Ctvar%20prefix%20=%20(len%20==%200)%20?%20&#39;&#39;%20:%20&#39;%5C%5Cn&#39;;%20%20//%20beginning%20or%20append%5Cn%5Cteditor.setTextInRange(len,%200,%20prefix%20+%20txt);%5Cn%7D%5Cn%5Cneditor.activate();%5Cn%5Cn%22%7D,%22uuid%22:%22D3710864-B95C-4F12-B9E1-0E435680B157%22%7D],%22shortName%22:%22%22,%22shouldConfirm%22:false,%22disposition%22:0,%22keyCommand%22:%7B%22optionKey%22:false,%22input%22:%22%22,%22controlKey%22:false,%22commandKey%22:false,%22type%22:%22action%22,%22discoverabilityTitle%22:%22Daily%20Readings%22,%22shiftKey%22:false%7D,%22logLevel%22:1,%22notificationType%22:1,%22tintColor%22:%22orange%22,%22actionDescription%22:%22This%20action%20accesses%20the%20EWTN%20website%20for%20references%20for%20the%20Daily%20Readings%20for%20the%20selected%20date%20and%20parses%20the%20JSON%20data%20returned.%20The%20readings%20are%20formatted%20in%20Markdown%20and%20appended%20to%20the%20text%20in%20the%20Drafts%E2%80%99%20editor.%20%5Cn%5Cn(Employs%20several%20JavaScript%20techniques:%20Drafts%E2%80%99%20date%20picker,%20HTTP%20request,%20JSON%20parse,%20and%20simple%20date%20formatting.)%22,%22keyUseIcon%22:false,%22icon%22:%22magazine%22,%22visibility%22:2,%22supportedPlatform%22:%22any%22,%22groupDisposition%22:1,%22name%22:%22Daily%20Readings%22%7D">Install</a>
</div>

<div>
  <h4>Steps</h4>
<ul class='steps'>
  <li>
    <div class='step'><h3>script</h3><pre><code class='language-javascript'>// This script accesses the EWTN website for references for the
// Daily Readings for the selected date and parses the JSON data
// returned. The readings are appended to the text in the editor.


function ymdFormat(jsDate) {
	// Formats date as yyyy-mm-dd
	var m = jsDate.getMonth() + 1;
	m = (m &gt; 9) ? m : &#39;0&#39; + m;
	var d = jsDate.getDate();
	d = (d &gt; 9) ? d : &#39;0&#39; + d;
	return jsDate.getFullYear() + &#39;-&#39; + m + &#39;-&#39; + d;
}

function niceDateFormat(jsDate) {
	// Formats date as day, mmm d
	var mo = [&#39;Jan&#39;, &#39;Feb&#39;, &#39;Mar&#39;, &#39;Apr&#39;, &#39;May&#39;, &#39;Jun&#39;, &#39;Jul&#39;, &#39;Aug&#39;, &#39;Sep&#39;, &#39;Oct&#39;, &#39;Nov&#39;, &#39;Dec&#39;];
	var dow = [&#39;Sun&#39;, &#39;Mon&#39;, &#39;Tue&#39;, &#39;Wed&#39;, &#39;Thu&#39;, &#39;Fri&#39;, &#39;Sat&#39;];
	// do not include day if Sunday
	var day = (jsDate.getDay() &gt; 0) ? (dow[jsDate.getDay()] + &#39;, &#39;) : &#39;&#39;;
	return day + mo[jsDate.getMonth()] + &#39; &#39; + jsDate.getDate();
}


// Date picker
var p = Prompt.create();
p.title = &#39;Daily Readings&#39;;
p.addDatePicker(&#39;pickDate&#39;, &#39;Select date for readings…&#39;, new Date(), {&quot;mode&quot;: &quot;date&quot;});
p.addButton(&#39;Select&#39;);
var didSelect = p.show();

if (didSelect) {
	// format URL
	var ymd = ymdFormat(p.fieldValues[&#39;pickDate&#39;]);
	var targetUrl = &#39;https://www.ewtn.com/se/readings/readingsservice.svc/day/&#39; + ymd + &#39;/en&#39;;

	// HTTP Request
	var http = HTTP.create();
	var response = http.request({&quot;url&quot;: targetUrl, &quot;method&quot;: &quot;GET&quot;});

	if (!response.success) {
		// Error in retrieving data
		var txt = response.statusCode + &#39; - &#39; + response.error;
	} else if (response.responseText.length &lt; 1) {
		// no data
		var txt = &#39;data unavailable for &#39;+ ymd;
	} else {
		// Parse and format readings
		var liturgy = JSON.parse(response.responseText);
		
		var txt = niceDateFormat(p.fieldValues[&#39;pickDate&#39;]);
		txt += &#39; - &#39; + liturgy.Title + &#39;\n&#39;;
		
		var numReadings = liturgy.ReadingGroups[0].Readings.length;

		for (var i = 0; i &lt; numReadings; i++) {
			var ref = liturgy.ReadingGroups[0].Readings[i].Citations[0].Reference;
			var type = liturgy.ReadingGroups[0].Readings[i].Type;
			txt += &#39;**&#39; + type + &#39;:** &#39; + ref + &#39;\n&#39;;
		}
		//txt += liturgy.Color + &#39;, &#39; + liturgy.Note + &#39;\n&#39;;
	}

	// insert text into editor
	var len = editor.getText().length;
	var prefix = (len == 0) ? &#39;&#39; : &#39;\n&#39;;  // beginning or append
	editor.setTextInRange(len, 0, prefix + txt);
}

editor.activate();

</code></pre></div>
  </li>
</ul>
</div>

<div>
  <h4>Options</h4>
  <ul class="steps">
    <li>
  <table class='action-detail'>
    <tr>
      <td class="cell-label">After Success</td>
      <td class="value">
        Nothing
        
      </td>
    </tr>
    <tr>
      <td class="cell-label">Notification</td>
      <td class="value">Error</td>
    </tr>
    <tr>
      <td class="cell-label">Log Level</td>
      <td class="value">Error</td>
    </tr>
  </table>
</li>
</ul>
</div>

<div class="disclaimer">
  Items available in the Drafts Directory are uploaded by community members. Use appropriate caution reviewing downloaded items before use.
</div>


                  </div>
                  <div class="footer-content">
                  <p>
                  <a href="https://itunes.apple.com/app/id1236254471?ls=1&mt=8&at=11l4Cf&ct=site">
                    <img alt="Download on App Store" src="../assets/appstore-deaf597bd57239c5054c59099e54ab9014f1e15eddb961085428e0ce94d4385b.svg" />
                  </a>
                  <a href="https://itunes.apple.com/app/id1435957248?mt=12&at=11l4Cf&ct=site">
                    <img alt="Download on Mac App Store" src="../assets/macappstore-05f5eed00e6bb26b68c1368217276158329862682e6d61b3ed193f819fe02f2f.svg" />
                  </a>
                  </p>
                    &copy; 2012-2022 by Agile Tortoise, Inc.<br/>
                    Drafts is a registered Trademark of Agile Tortoise, Inc.<br/>
                    <a href="https://actions.getdrafts.com/getdrafts.com/support/privacy.html">Privacy</a> | <a href="https://actions.getdrafts.com/getdrafts.com/support/terms.html">Terms</a>
                </div>
                </div>
            </div>
        </div>
    </div>

  </body>
  </html>
