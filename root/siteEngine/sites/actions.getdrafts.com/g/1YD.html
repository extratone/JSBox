<!DOCTYPE html>
<html lang='en'>
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <title>Meeting minutes workflow | Drafts Directory</title>
    <meta name="csrf-param" content="authenticity_token" />
<meta name="csrf-token" content="OfEqRZPre7OoDSKbwvzboqk0+hNyyGuvlw6BNnq1p6NK7gzP94DcViddmcuWv4C8Dpck6IwYIQm6f9NPU005UQ==" />
    <meta http-equiv="content-type" content="text/html;charset=utf-8">
    <meta http-equiv="content-language" content="en">
    <meta http-equiv="content-language" content="en-us">
    
    <meta name="viewport" content="width=device-width, initial-scale=1">
    
    <meta property="og:title" content="Drafts Directory: Meeting minutes workflow" />
    <meta property="og:url" content="https://actions.getdrafts.com/g/1YD" />
    <meta property="og:type" content="website" />
    <meta property="og:description" content="Example actions and other extensions for Drafts, the quick-capture notes app." />
    <meta property="og:image" content="https://actions.getdrafts.com/assets/drafts-ogimage-action-d9c60102fd45e0cb516e1b49ed50a81e3c3a2b90f81f55df8f43d0feb0512978.png" />
    <meta property="twitter:title" content="Drafts Directory: Meeting minutes workflow" />
    <meta property="twitter:url" content="https://actions.getdrafts.com/g/1YD" />
    <meta property="twitter:type" content="website" />
    <meta property="twitter:description" content="Example actions and other extensions for Drafts, the quick-capture notes app." />
    <meta property="twitter:image" content="https://actions.getdrafts.com/assets/drafts-ogimage-action-d9c60102fd45e0cb516e1b49ed50a81e3c3a2b90f81f55df8f43d0feb0512978.png" />

    <link rel="shortcut icon" type="image/x-icon" href="../assets/favicon-114dbb66b0ef0399a14fa5dfcad7e6210bb558c30cea665e04d49b59fec87f70.png" />

    <link rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.4.0/styles/default.min.css">
    <link rel="stylesheet" media="all" href="../assets/application-6e4f014b4c48cd673942dbfbbeb3e571a732b05562ddde5904f3a5c3833e54ff.css" />
    <script src="../assets/application-13492939cb10be5be76b5abb3e9ae0bef0bbae3202cec2b85cf6fca5bc8429c8.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.4.0/highlight.min.js"></script>
    <script>hljs.highlightAll();</script>
    <script async defer data-domain="directory.getdrafts.com" src="https://plausible.io/js/plausible.js"></script>
  </head>

<body data-no-turbolink>

    <div class="page-wrap">
        <div class="side-bar">
            <a href="../index.html" class="site-title fs-6 lh-tight" title="{{ site.title }}">
                <img src="../assets/drafts-directory-header-4d826bd007f515c8e5a10f654e56ad76fbb3bd3103a67ce342283f701f1677fe.svg" alt="Drafts Directory" style="max-height: 30px;" />
            </a>
            <span class="fs-3"><button class="js-main-nav-trigger navigation-list-toggle btn btn-outline" type="button"
                    data-text-toggle="Hide">Menu</button></span>
            <div class="navigation main-nav js-main-nav">
              <ul class="navigation-list">
                <li class="navigation-list-item">
                  <a class="navigation-list-link" href="../index.html">Home</a>
                </li>
                <li class="navigation-list-item">
                  <a class="navigation-list-link" href="../drafts_actions.html">Actions</a>
                </li>
                <li class="navigation-list-item">
                  <a class="navigation-list-link" href="../drafts_action_groups.html">Action Groups</a>
                </li>
                <li class="navigation-list-item">
                  <a class="navigation-list-link" href="../syntax_definitions.html">Syntaxes</a>
                </li>
                <li class="navigation-list-item">
                  <a class="navigation-list-link" href="../theme_definitions.html">Themes</a>
                </li>
                <li class="navigation-list-item">
                  <a class="navigation-list-link" href="../workspaces.html">Workspaces</a>
                </li>
                <li class="navigation-list-item">
                  <hr style="margin:1em; padding: 0;" />
                </li>
                <li class="navigation-list-item">
                  <a class="navigation-list-link" href="../search.html">Search</a>
                </li>
                <li class="navigation-list-item">
                  <hr style="margin:1em; padding: 0;" />
                </li>
                <li class="navigation-list-item">
                    <a class="navigation-list-link nav-external" title="About Drafts" href="../../getdrafts.com/index.html">Get Drafts &#x2192;</a>
                </li>
                <li class="navigation-list-item">
                    <a class="navigation-list-link nav-external" title="Detailed documentation" href="../../docs.getdrafts.com/index.html">User Guide &#x2192;</a>
                </li>
                <li class="navigation-list-item">
                    <a class="navigation-list-link nav-external" title="Get your questions answered in the forums" href="https://forums.getdrafts.com/">Community &#x2192;</a>
                </li>
                <li class="navigation-list-item">
                    <a class="navigation-list-link nav-external" title="Online tools and generators" href="../../tools.getdrafts.com/index.html">Tools &#x2192;</a>
                </li>
                <li class="navigation-list-item">
                    <a class="navigation-list-link nav-external" title="Scripting library reference" href="../../scripting.getdrafts.com/index.html">Script Reference &#x2192;</a>
                </li>
              </ul>
            </div>
            <footer role="contentinfo" class="site-footer">
                <p class="text-small text-grey-dk-000 mb-0">
                    Download: <a href="https://itunes.apple.com/app/id1236254471?ls=1&mt=8&at=11l4Cf&ct=site">iOS</a> | <a href="https://itunes.apple.com/app/id1435957248?mt=12&at=11l4Cf&ct=site">Mac</a>
                </p>
            </footer>
        </div>
        <div class="main-content-wrap js-main-content" tabindex="0">
            <div class="page-header">
                <div class="main-content">
                    <div class="search js-search">
	<div class="search-input-wrap">
<form class="search-form" action="../search.html" accept-charset="UTF-8" method="get"><input name="utf8" type="hidden" value="&#x2713;" />
	<button style='border:none;background-color:transparent;'>
	<svg width="14" height="14" viewBox="0 0 28 28" xmlns="http://www.w3.org/2000/svg"
		class="search-icon">
		<title>Search</title>
		<g fill-rule="nonzero">
			<path
				d="M17.332 20.735c-5.537 0-10-4.6-10-10.247 0-5.646 4.463-10.247 10-10.247 5.536 0 10 4.601 10 10.247s-4.464 10.247-10 10.247zm0-4c3.3 0 6-2.783 6-6.247 0-3.463-2.7-6.247-6-6.247s-6 2.784-6 6.247c0 3.464 2.7 6.247 6 6.247z" />
			<path d="M11.672 13.791L.192 25.271 3.02 28.1 14.5 16.62z" />
		</g>
	</svg>
	</button>
	<input type="text" name="q" id="q" class="js-search-input search-input search" size="12" tabindex="0" placeholder="Search" />
</form>	</div>
</div>
                    <ul class="list-style-none text-small mt-md-1 mb-md-1 pb-4 pb-md-0 js-aux-nav aux-nav">
                        <li class="d-inline-block my-0 mr-2">
                          <a href="../../getdrafts.com/index.html">Get Drafts</a>
                        </li>
                        <li class="d-inline-block my-0">
                          <a href="https://forums.getdrafts.com">Community</a>
                        </li>
                    </ul>
                </div>
            </div>
            <div class="main-content">
                <div id="main-content" class="page-content" role="main">
                  <div class="type">
                    <h4>Action Group</h4>
                  </div>
                  <div class="header">
                      <h1><img src="https://config.agiletortoise.com/drafts-icons/journal-pencil.png" class="action-icon" />Meeting minutes workflow</h1>
                  </div>

                  <div class="content">
                    
<div class='caption'>
  Posted by Bert Kruisdijk,
Last update 9 days ago
</div>


<div class='description'>
	<p>Prepare and process meeting notes in combination with OmniFocus</p>

</div>

<div class="certification">
  
  
</div>

<div>
  <a class="btn btn-blue" href="drafts5://actionGroup?identifier=1YD&amp;data=%7B%22name%22:%22Meeting%20minutes%20workflow%22,%22hidden%22:false,%22tintColor%22:%22violet%22,%22actions%22:[%7B%22uuid%22:%22B38CF47A-E524-40DD-B906-9FE50F3EB3F5%22,%22steps%22:[],%22backingPlatforms%22:3,%22shortName%22:%22%22,%22shouldConfirm%22:false,%22disposition%22:3,%22keyCommand%22:%7B%22optionKey%22:false,%22input%22:%22%22,%22controlKey%22:false,%22commandKey%22:false,%22type%22:%22empty%22,%22discoverabilityTitle%22:%22Invalid%22,%22shiftKey%22:false%7D,%22logLevel%22:2,%22groupDisposition%22:0,%22notificationType%22:2,%22tintColor%22:%22none%22,%22actionDescription%22:%22%22,%22keyUseIcon%22:false,%22icon%22:%22%22,%22visibility%22:480,%22backingIsSeparator%22:true,%22groupUUID%22:%22CC8CE599-5253-472F-AF96-80CA35F2D759%22,%22assignTags%22:[],%22name%22:%22%F0%9F%A5%B5%20Preparation%20for%20a%20meeting%22%7D,%7B%22uuid%22:%22D694C9B9-BB2D-4A47-B891-D1C621462AEC%22,%22steps%22:[%7B%22platforms%22:3,%22data%22:%7B%22script%22:%22//ENVIRONMENT%20SWITCHER%5Cn%5Cnvar%20allWorkspaces%20=%20Workspace.getAll();%5Cn%5Cnvar%20allActiongroups%20=%20ActionGroup.getAll();%5Cn%5Cn//%20Prompt%5Cn%5Cnvar%20p%20=%20Prompt.create();%5Cnp.title%20=%20%5C%22Select%20Workspace%5C%22;%5Cnp.message%20=%20%5C%22%5C%22;%5Cnfor%20(i%20=%200;%20i%20%5Cu003c%20allWorkspaces.length;%20i++)%20%7B%5Cnp.addButton(allWorkspaces[i].name);%5Cn%7D%5Cn%5Cnp.addSwitch(%5C%22showList%5C%22,%20%5C%22Show%20List%20after%20selection%5C%22,%20true)%5Cn%5Cnvar%20con%20=%20p.show();%5Cn%5Cnif%20(con)%20%7B%5Cn%20%20var%20buttonPressed%20=%20p.buttonPressed;%5Cn%5Cn//load%20workspace%5Cnlet%20workspace%20=%20Workspace.find(buttonPressed);%5Cnapp.applyWorkspace(workspace);%5Cn%5Cnif%20(buttonPressed%20==%20%5C%22Scripts%5C%22)%20%7B%5Cn//load%20actionlist%5Cnlet%20actionList%20=%20ActionGroup.find(%5C%22Scripting%5C%22);%5Cnapp.loadActionGroup(actionList);%5Cn%7D%5Cn%5Cnif%20(p.fieldValues[%5C%22showList%5C%22]%20==%20true)%20%7B%5Cn//Show%20draft%20list%5Cnif%20(!app.isDraftListVisible)%20%7B%5Cn%20%20app.showDraftList();%5Cn%7D%5Cn%7D%20else%20%7B%5Cn%20%20context.cancel();%5Cn%7D%5Cn%7D%22,%22allowAsync%22:%22false%22%7D,%22type%22:%22script%22,%22isEnabled%22:true,%22uuid%22:%222BA86CC9-CBA0-488A-8242-0D7207171B18%22%7D],%22backingPlatforms%22:3,%22shortName%22:%22%22,%22shouldConfirm%22:false,%22disposition%22:3,%22keyCommand%22:%7B%22optionKey%22:false,%22input%22:%22%22,%22controlKey%22:false,%22commandKey%22:false,%22type%22:%22action%22,%22discoverabilityTitle%22:%220a.%20Workspace%20selection%22,%22shiftKey%22:false%7D,%22logLevel%22:2,%22groupDisposition%22:0,%22notificationType%22:1,%22tintColor%22:%22violet%22,%22actionDescription%22:%22%22,%22keyUseIcon%22:true,%22icon%22:%22briefcase%22,%22visibility%22:480,%22backingIsSeparator%22:false,%22groupUUID%22:%22CC8CE599-5253-472F-AF96-80CA35F2D759%22,%22assignTags%22:[],%22name%22:%220a.%20Workspace%20selection%22%7D,%7B%22uuid%22:%2291B6D45D-78F9-4A89-8138-ACE3BC4D3116%22,%22steps%22:[%7B%22platforms%22:3,%22data%22:%7B%22waitForResponse%22:%22false%22,%22template%22:%22[[draft]]%22,%22shortcutName%22:%22Notes%20in%20Drafts%20for%20today%22,%22returnToDrafts%22:%22true%22,%22shortcutID%22:%22%22%7D,%22type%22:%22runShortcut%22,%22isEnabled%22:true,%22uuid%22:%22DA8696E8-EF6F-44B2-BA53-9053A123C76F%22%7D],%22groupDisposition%22:0,%22shortName%22:%22%22,%22shouldConfirm%22:false,%22disposition%22:3,%22keyCommand%22:%7B%22optionKey%22:false,%22input%22:%22%22,%22controlKey%22:false,%22commandKey%22:false,%22type%22:%22action%22,%22discoverabilityTitle%22:%220b.%20Prepare%20meeting%20notes%20in%20Drafts%22,%22shiftKey%22:false%7D,%22logLevel%22:2,%22notificationType%22:2,%22tintColor%22:%22violet%22,%22actionDescription%22:%22%22,%22keyUseIcon%22:false,%22icon%22:%22action_runworkflow%22,%22visibility%22:480,%22groupUUID%22:%22CC8CE599-5253-472F-AF96-80CA35F2D759%22,%22assignTags%22:[],%22name%22:%220b.%20Prepare%20meeting%20notes%20in%20Drafts%22%7D,%7B%22uuid%22:%229C478F3B-4066-4E1E-8108-D580BAF40D8C%22,%22steps%22:[%7B%22platforms%22:3,%22data%22:%7B%22script%22:%22//%20select%20from%20a%20list%20of%20drafts%20tagged%20%5C%22template%5C%22%20and%20create%20new%20draft%20based%20on%20selection.%5Cn%5Cnlet%20f%20=%20()%20=%5Cu003e%20%7B%5Cn%5Ct//%20create%20temp%20workspace%20to%20query%20drafts%5Cn%5Ctlet%20workspace%20=%20Workspace.create();%5Cn%5Ctif%20(!workspace)%20%7B%5Cn%5Ct%5Ctreturn%20false;%5Cn%5Ct%7D%5Cn%5Ctworkspace.tagFilter%20=%20%5C%22template%5C%22;%5Cn%5Ctworkspace.setAllSort(%5C%22name%5C%22,%20false,%20true);%5Cn%5Ct//%20get%20list%20of%20drafts%20in%20workspace%5Cn%5Ctlet%20drafts%20=%20workspace.query(%5C%22all%5C%22);%5Cn%5Ct%5Cn%5Ct//%20check%20if%20we%20found%20any%20valid%20templates%5Cn%5Ctif%20(drafts.length%20==%200)%20%7B%5Cn%5Ct%5Ctalert(%5C%22No%20templates%20found.%20To%20make%20templates%20available%20to%20this%20action,%20create%20a%20draft%20with%20the%20template%20content%20and%20assign%20it%20the%20tag%20%5C%5C%5C%22template%5C%5C%5C%22.%5C%22);%5Cn%5Ct%5Ctreturn%20false;%5Cn%5Ct%7D%5Cn%5Ct%5Cn%5Ct//%20prompt%20to%20select%5Cn%5Ctlet%20p%20=%20Prompt.create();%5Cn%5Ctp.title%20=%20%5C%22New%20Draft%20with%20Template%5C%22;%5Cn%5Ctp.message%20=%20%5C%22Select%20a%20template.%20A%20new%20draft%20will%20be%20created%20based%20the%20template%20selected.%5C%22;%5Cn%5Ct%5Cn%5Ctlet%20ix%20=%200%5Cn%5Ctfor%20(let%20d%20of%20drafts)%20%7B%5Cn%5Ct%5Ctp.addButton(d.title,%20ix);%5Cn%5Ct%5Ctix++;%5Cn%5Ct%7D%5Cn%5Ct%5Cn%5Ctif%20(!p.show())%20%7B%5Cn%5Ct%5Ctreturn%20false;%5Cn%5Ct%7D%5Cn%5Ct%5Cn%5Ct//%20get%20the%20selected%20template%20draft%5Cn%5Ctlet%20selectedIndex%20=%20p.buttonPressed;%5Cn%5Ctlet%20template%20=%20drafts[selectedIndex];%5Cn%5Cn%5Ct//%20create%20new%20draft%20and%20assign%20content/tags%5Cn%5Ctlet%20d%20=%20Draft.create();%5Cn%5Ctfor%20(let%20tag%20of%20template.tags)%20%7B%5Cn%5Ct%5Ctif%20(tag%20!=%20%5C%22template%5C%22)%20%7B%5Cn%5Ct%5Ct%5Ctd.addTag(tag);%5Cn%5Ct%5Ct%7D%5Cn%5Ct%7D%5Cn%5Ctd.content%20=%20d.processTemplate(template.content);%5Cn%5Ctd.update();%5Cn%5Ct//%20load%20new%20draft%5Cn%5Cteditor.load(d);%5Cn%5Cteditor.activate();%5Cn%5Ctreturn%20true;%5Cn%7D%5Cn%5Cnif%20(app.isPro)%20%7B%5Cn%5Ctif%20(!f())%20%7B%5Cn%5Ct%5Ctcontext.cancel();%5Cn%5Ct%7D%5Cn%7D%5Cnelse%20%7B%5Cn%5Ctalert(%5C%22Drafts%20Pro%20features%20required%20to%20use%20this%20action.%5C%22)%5Cn%7D%22,%22allowAsync%22:%22false%22%7D,%22type%22:%22script%22,%22isEnabled%22:true,%22uuid%22:%22E59F9E74-3E9C-48F7-9FDE-6A8DAC9C8616%22%7D],%22backingPlatforms%22:3,%22shortName%22:%22Template%22,%22shouldConfirm%22:false,%22disposition%22:3,%22keyCommand%22:%7B%22optionKey%22:false,%22input%22:%22%22,%22controlKey%22:false,%22commandKey%22:false,%22type%22:%22action%22,%22discoverabilityTitle%22:%220c.%20New%20Note%20from%20Template%22,%22shiftKey%22:false%7D,%22logLevel%22:1,%22groupDisposition%22:0,%22notificationType%22:1,%22tintColor%22:%22violet%22,%22actionDescription%22:%22Prompt%20to%20select%20from%20a%20list%20of%20existing%20drafts%20with%20the%20tag%20%E2%80%9Ctemplate%E2%80%9D%20assigned,%20then%20create%20a%20new%20draft%20with%20the%20content%20of%20that%20template.%5Cn%5CnTo%20create%20templates%20available%20in%20this%20action,%20simply%20type%20your%20template%20in%20a%20draft,%20and%20assigned%20the%20tag%20%E2%80%9Ctemplate%E2%80%9D%20to%20that%20draft.%20It%20can%20be%20in%20the%20archive%20or%20inbox.%20The%20template%20can%20contain%20[Drafts%20tags](https://reference.getdrafts.com/topics/templates.html)%20to%20insert%20time%20stamps%20or%20other%20dynamic%20data%20in%20the%20template.%20Also,%20any%20tags%20other%20than%20%E2%80%9Ctemplate%E2%80%9D%20assigned%20to%20the%20template%20draft%20will%20be%20assigned%20to%20the%20new%20draft%20automatically.%22,%22keyUseIcon%22:true,%22icon%22:%22page-add%22,%22visibility%22:480,%22backingIsSeparator%22:false,%22groupUUID%22:%22CC8CE599-5253-472F-AF96-80CA35F2D759%22,%22assignTags%22:[],%22name%22:%220c.%20New%20Note%20from%20Template%22%7D,%7B%22uuid%22:%22928E283B-181C-48B5-B9F4-D6AF89A1FBE2%22,%22steps%22:[%7B%22platforms%22:3,%22data%22:%7B%22waitForResponse%22:%22true%22,%22shortcutName%22:%22Meeting%20sheet%20person%22,%22template%22:%22[[selection_only]]%22,%22shortcutID%22:%22%22%7D,%22type%22:%22runShortcut%22,%22isEnabled%22:true,%22uuid%22:%2229E79C38-75A7-4592-861C-DE4D031E6634%22%7D],%22backingPlatforms%22:3,%22shortName%22:%22%22,%22shouldConfirm%22:false,%22disposition%22:3,%22keyCommand%22:%7B%22optionKey%22:false,%22input%22:%22%22,%22controlKey%22:false,%22commandKey%22:false,%22type%22:%22action%22,%22discoverabilityTitle%22:%220c.%20Meeting%20cheat%20sheet%20person%22,%22shiftKey%22:false%7D,%22logLevel%22:2,%22groupDisposition%22:0,%22notificationType%22:2,%22tintColor%22:%22violet%22,%22actionDescription%22:%22Run%20shortcut%20named%20%5C%22shortcutName%5C%22.%22,%22keyUseIcon%22:false,%22icon%22:%22e-reader%22,%22visibility%22:480,%22backingIsSeparator%22:false,%22groupUUID%22:%22CC8CE599-5253-472F-AF96-80CA35F2D759%22,%22assignTags%22:[],%22name%22:%220c.%20Meeting%20cheat%20sheet%20person%22%7D,%7B%22uuid%22:%22816D595D-92A4-453A-8515-8A562314166E%22,%22steps%22:[%7B%22platforms%22:3,%22data%22:%7B%22waitForResponse%22:%22true%22,%22shortcutName%22:%22Meeting%20sheet%20project%22,%22template%22:%22[[selection_only]]%22,%22shortcutID%22:%22%22%7D,%22type%22:%22runShortcut%22,%22isEnabled%22:true,%22uuid%22:%22DF4A1B4C-1E89-4CCB-872C-5B8707A5F0DA%22%7D],%22backingPlatforms%22:3,%22shortName%22:%22%22,%22shouldConfirm%22:false,%22disposition%22:3,%22keyCommand%22:%7B%22optionKey%22:false,%22input%22:%22%22,%22controlKey%22:false,%22commandKey%22:false,%22type%22:%22action%22,%22discoverabilityTitle%22:%220d.%20Meeting%20cheat%20sheet%20project%22,%22shiftKey%22:false%7D,%22logLevel%22:2,%22groupDisposition%22:0,%22notificationType%22:2,%22tintColor%22:%22violet%22,%22actionDescription%22:%22Run%20shortcut%20named%20%5C%22shortcutName%5C%22.%22,%22keyUseIcon%22:false,%22icon%22:%22e-reader%22,%22visibility%22:480,%22backingIsSeparator%22:false,%22groupUUID%22:%22CC8CE599-5253-472F-AF96-80CA35F2D759%22,%22assignTags%22:[],%22name%22:%220d.%20Meeting%20cheat%20sheet%20project%22%7D,%7B%22uuid%22:%22117B5B7D-C243-4ADA-8536-56A73A768633%22,%22steps%22:[],%22backingPlatforms%22:3,%22shortName%22:%22%22,%22shouldConfirm%22:false,%22disposition%22:3,%22keyCommand%22:%7B%22optionKey%22:false,%22input%22:%22%22,%22controlKey%22:false,%22commandKey%22:false,%22type%22:%22empty%22,%22discoverabilityTitle%22:%22Invalid%22,%22shiftKey%22:false%7D,%22logLevel%22:2,%22groupDisposition%22:0,%22notificationType%22:2,%22tintColor%22:%22none%22,%22actionDescription%22:%22%22,%22keyUseIcon%22:false,%22icon%22:%22%22,%22visibility%22:480,%22backingIsSeparator%22:true,%22groupUUID%22:%22CC8CE599-5253-472F-AF96-80CA35F2D759%22,%22assignTags%22:[],%22name%22:%22%F0%9F%94%97%20Linking%20to%20TOC%20and%20projects%22%7D,%7B%22uuid%22:%22AB8783BB-0C66-4E81-A10A-608BA7CE0EA4%22,%22steps%22:[%7B%22platforms%22:3,%22data%22:%7B%22script%22:%22//%20See%20online%20documentation%20for%20examples%5Cn//%20https://docs.getdrafts.com/docs/actions/scripting%5Cn%5Cnconst%20addToc%20=%20content%20=%5Cu003e%20%7B%5Cn%5Ctconst%20headerLines%20=%20content.split(&#39;%5C%5Cn&#39;).filter(line%20=%5Cu003e%20/%5E%23+%5C%5Cs+[%5E%5C%5Cs]+/.test(line))%5Cn%5Ctif%20(headerLines.length%20==%200)%20%7B%5Cn%5Ct%5Ctalert(%5C%22No%20Markdown%20headers%20(e.g.%20%23%23%20Header)%20found%5C%22)%5Cn%5Ct%5Ctreturn%5Cn%5Ct%7D%5Cn%5Ctconst%20tocLines%20=%20[]%5Cn%5Ctlet%20lastLevel%20=%200%5Cn%5Ctfor%20(let%20i%20=%200;%20i%20%5Cu003c%20headerLines.length;%20i++)%20%7B%5Cn%5Ct%5Ctconst%20splitMatch%20=%20headerLines[i].match(/%5E(%23+)%5C%5Cs+(.*)$/)%5Cn%5Ct%5Ct//%20-%202%20assumes%20the%20first%20header%20is%20h2%5Cn%5Ct%5Ctconst%20level%20=%20splitMatch[1].length%20-%202%5Cn%5Ct%5Ctif%20(level%20%5Cu003c%200)%20%7B%5Cn%5Ct%5Ct%5Ctalert(%5C%22h1%20headers%20(%23)%20are%20not%20compatible%20with%20Table%20of%20Contents.%20Please%20use%20h2%20headers%20(%23%23)%20and%20below.%5C%22)%5Cn%5Ct%5Ct%5Ctreturn%20null%5Cn%5Ct%5Ct%7D%5Cn%5Ct%5Ctif%20(level%20%5Cu003e%20lastLevel%20+%201)%20%7B%5Cn%5Ct%5Ct%5Ctalert(%5C%22Cannot%20make%20a%20table%20of%20contents%20if%20header%20levels%20are%20skipped,%20e.g.%20%23%23%20followed%20by%20%23%23%23%23%5C%22)%5Cn%5Ct%5Ct%5Ctreturn%5Cn%5Ct%5Ct%7D%5Cn%5Ct%5CtlastLevel%20=%20level%5Cn%5Ct%5Ctconst%20headerText%20=%20splitMatch[2]%5Cn%5Ct%5CttocLines.push(%5C%22%20%20%20%20%5C%22.repeat(level)%20+%20%5C%22*%20%5C%22%20+%20headerText)%5Cn%5Ct%7D%5Cn%5Ctif%20(tocLines[0][0]%20!=%20%5C%22*%5C%22)%20%7B%5Cn%5Ct%5Ctalert(%5C%22The%20first%20header%20must%20be%20a%20h2%20(%23%23)%5C%22)%5Cn%5Ct%5Ctreturn%5Cn%5Ct%7D%5Cn%5Cn%5Ctlet%20startMatch%20=%20content.match(/%5Cu003c!--%20toc%20start%20--%5Cu003e/)%5Cn%5Ctlet%20endMatch%20=%20content.match(/%5Cu003c!--%20toc%20end%20--%5Cu003e/)%5Cn%5Ctif%20(startMatch%20==%20null%20%5Cu0026%5Cu0026%20endMatch%20==%20null)%20%7B%5Cn%5Ct%5Ctconst%20firstHeaderMatch%20=%20content.match(/%5E(%23+)%5C%5Cs+(.*)$/m)%5Cn%5Ct%5Ctcontent%20=%20%60$%7Bcontent.substring(0,%20firstHeaderMatch.index)%7D%5Cu003c!--%20toc%20start%20--%5Cu003e%5Cu003c!--%20toc%20end%20--%5Cu003e%5C%5Cn%5C%5Cn$%7Bcontent.substring(firstHeaderMatch.index)%7D%60%5Cn%5Ct%5CtstartMatch%20=%20content.match(/%5Cu003c!--%20toc%20start%20--%5Cu003e/)%5Cn%5Ct%5CtendMatch%20=%20content.match(/%5Cu003c!--%20toc%20end%20--%5Cu003e/)%5Cn%5Ct%7D%5Cn%5Ctif%20(startMatch%20==%20null%20%7C%7C%20endMatch%20==%20null)%20%7B%5Cn%5Ct%5Ctalert(%5C%22You%20need%20both%20%5Cu003c!--%20toc%20start%20--%5Cu003e%20and%20%5Cu003c!--%20toc%20end%20--%5Cu003e%20in%20your%20draft%20to%20place%20a%20table%20of%20contents%5C%22)%5Cn%5Ct%5Ctreturn%5Cn%5Ct%7D%5Cn%5Ctif%20(endMatch.index%20%5Cu003c%20startMatch.index)%20%7B%5Cn%5Ct%5Ctalert(%5C%22%5Cu003c!--%20toc%20start%20--%5Cu003e%20must%20come%20before%20%5Cu003c!--%20toc%20end%20--%5Cu003e%5C%22)%5Cn%5Ct%5Ctreturn%5Cn%5Ct%7D%5Cn%5Ctconst%20startPos%20=%20startMatch.index%20+%20startMatch[0].length%5Cn%5Ctconst%20endPos%20=%20endMatch.index%5Cn%5Ctreturn%20%60$%7Bcontent.substring(0,%20startPos)%7D%5C%5Cn$%7BtocLines.join(%5C%22%5C%5Cn%5C%22)%7D%5C%5Cn$%7Bcontent.substring(endPos)%7D%60%5Cn%7D%5Cn%5Cnconst%20newBody%20=%20addToc(draft.lines.slice(1).join(%5C%22%5C%5Cn%5C%22))%5Cnif%20(newBody%20!=%20null)%20%7B%5Cn%5Ctdraft.content%20=%20%60$%7Bdraft.lines[0]%7D%5C%5Cn$%7BnewBody%7D%60%5Cn%5Ctdraft.update()%5Cn%7D%22,%22allowAsync%22:%22false%22%7D,%22type%22:%22script%22,%22isEnabled%22:true,%22uuid%22:%224AEABE3C-147F-4BDD-835A-369ABECC5164%22%7D],%22backingPlatforms%22:3,%22shortName%22:%22%22,%22shouldConfirm%22:false,%22disposition%22:3,%22keyCommand%22:%7B%22optionKey%22:false,%22input%22:%22%22,%22controlKey%22:false,%22commandKey%22:false,%22type%22:%22action%22,%22discoverabilityTitle%22:%221a.%20Table%20of%20Contents%22,%22shiftKey%22:false%7D,%22logLevel%22:2,%22groupDisposition%22:0,%22notificationType%22:2,%22tintColor%22:%22violet%22,%22actionDescription%22:%22Insert%20a%20table%20of%20contents%20based%20on%20Markdown%20headers.%5Cn%5CnPut%20the%20placeholder%20%5Cu003c!--%20start%20toc%20--%5Cu003e%5Cu003c!--%20end%20toc%20--%5Cu003e%20where%20you%20want%20the%20table%20of%20contents%20to%20appear.%5Cn%5CnYou%20can%20run%20it%20multiple%20times%20and%20it%20will%20update%20the%20table%20of%20contents.%5Cn%5CnIf%20you%20don&#39;t%20use%20a%20placeholder,%20the%20table%20of%20contents%20will%20be%20inserted%20before%20the%20first%20non-title%20header.%5Cn%5CnThis%20is%20similar%20to%20the%20%5C%5C%7B%7BTOC%7D%7D%20feature%20if%20you%20are%20using%20the%20MultiMarkdown%20renderer%20(the%20default),%20except%20it%20will%20put%20your%20table%20of%20contents%20in%20the%20Draft,%20not%20just%20previews.%22,%22keyUseIcon%22:false,%22icon%22:%22list%22,%22visibility%22:480,%22backingIsSeparator%22:false,%22groupUUID%22:%22CC8CE599-5253-472F-AF96-80CA35F2D759%22,%22assignTags%22:[],%22name%22:%221a.%20Table%20of%20Contents%22%7D,%7B%22uuid%22:%22C65CC2F1-7C46-4AC1-9E8F-6EBE43D47D3B%22,%22steps%22:[%7B%22platforms%22:3,%22data%22:%7B%22script%22:%22let%20d%20=%20app.selectDraft(app.currentWorkspace);%5Cnif(d)%20%7B%5Cn%5Cteditor.setSelectedText(%60[[$%7Bd.displayTitle%7D]]%60);%5Cn%7D%22,%22allowAsync%22:%22false%22%7D,%22type%22:%22script%22,%22isEnabled%22:true,%22uuid%22:%2277A6C656-C8B2-4D3D-95E6-8836FC734D34%22%7D],%22backingPlatforms%22:3,%22shortName%22:%22%22,%22shouldConfirm%22:false,%22disposition%22:0,%22keyCommand%22:%7B%22optionKey%22:false,%22input%22:%22%22,%22controlKey%22:false,%22commandKey%22:false,%22type%22:%22action%22,%22discoverabilityTitle%22:%221b.%20Insert%20Link%20to%20Draft%22,%22shiftKey%22:false%7D,%22logLevel%22:0,%22groupDisposition%22:0,%22notificationType%22:0,%22tintColor%22:%22violet%22,%22actionDescription%22:%22Action%20will%20prompt%20to%20select%20a%20draft,%20and%20insert%20a%20wiki-style%20%60[[Title%20of%20Draft]]%60%20link%20to%20the%20draft%20in%20the%20current%20draft.%22,%22keyUseIcon%22:false,%22icon%22:%22link%22,%22visibility%22:480,%22backingIsSeparator%22:false,%22groupUUID%22:%22CC8CE599-5253-472F-AF96-80CA35F2D759%22,%22assignTags%22:[],%22name%22:%221b.%20Insert%20Link%20to%20Draft%22%7D,%7B%22uuid%22:%228C308BBD-466E-4548-861B-22872D69DD76%22,%22steps%22:[%7B%22platforms%22:3,%22data%22:%7B%22script%22:%22let%20open%20=%20(d)%20=%5Cu003e%20%7B%5Cn%5Cteditor.load(d);%5Cn%7D%5Cn%5Cnlet%20f%20=%20()%20=%5Cu003e%20%7B%5Cn%5Ctlet%20title%20=%20draft.displayTitle;%5Cn%5Ctif%20(title.length%20==%200)%20%7B%20return;%20%7D%5Cn%5Ct%5Cn%5Ct//%20query%20for%20other%20drafts%20with%20the%20link%20to%20this%20one...%5Cn%5Ctlet%20pattern%20=%20%60%5C%22[[$%7Btitle%7D]]%5C%22%60;%5Cn%5Ctlet%20drafts%20=%20Draft.query(pattern,%20%5C%22all%5C%22,%20[],%20[],%20%5C%22modified%5C%22,%20true);%5Cn%5Ct%5Cn%5Ct//%20didn&#39;t%20find%20any!%5Cn%5Ctif%20(drafts.length%20==%200)%20%7B%5Cn%5Ct%5Ctapp.displayWarningMessage(%5C%22No%20linked%20drafts%20found.%5C%22);%5Cn%5Ct%5Ctreturn;%5Cn%5Ct%7D%5Cn%5Ct//%20found%20just%201,%20open%20it%5Cn%5Ctif%20(drafts.length%20==%201)%20%7B%5Cn%5Ct%5Ctopen(drafts[0]);%5Cn%5Ct%5Ctreturn;%5Cn%5Ct%7D%5Cn%5Ct%5Cn%5Ct//%20more%20than%20one,%20allow%20use%20to%20choose...%5Cn%5Ctlet%20p%20=%20Prompt.create();%5Cn%5Ctp.title%20=%20%5C%22Select%20Draft%5C%22;%5Cn%5Ctp.message%20=%20%5C%22The%20following%20drafts%20link%20to%20this%20draft.%20Select%20one%20to%20open%20it.%5C%22;%5Cn%5Ct%5Cn%5Ctlet%20map%20=%20%7B%7D;%5Cn%5Ctfor%20(let%20d%20of%20drafts)%20%7B%5Cn%5Ct%5Ctlet%20title%20=%20d.title;%5Cn%5Ct%5Ctmap[title]%20=%20d;%5Cn%5Ct%5Ctp.addButton(title);%5Cn%5Ct%7D%5Cn%5Ct%5Cn%5Ctif%20(!p.show())%20%7B%5Cn%5Ct%5Ctreturn;%5Cn%5Ct%7D%5Cn%5Ct%5Cn%5Ct//%20picked%20one,%20load%20it%20in%20the%20editor%5Cn%5Ctlet%20selected%20=%20map[p.buttonPressed];%5Cn%5Ctopen(selected);%5Cn%7D%5Cn%5Cnf();%5Cn%22,%22allowAsync%22:%22false%22%7D,%22type%22:%22script%22,%22isEnabled%22:true,%22uuid%22:%22608C3482-27A4-4107-8A6D-5FFB386ABF83%22%7D],%22backingPlatforms%22:3,%22shortName%22:%22%22,%22shouldConfirm%22:false,%22disposition%22:0,%22keyCommand%22:%7B%22optionKey%22:false,%22input%22:%22%22,%22controlKey%22:false,%22commandKey%22:false,%22type%22:%22action%22,%22discoverabilityTitle%22:%221c.%20Back%20Links%22,%22shiftKey%22:false%7D,%22logLevel%22:0,%22groupDisposition%22:0,%22notificationType%22:0,%22tintColor%22:%22violet%22,%22actionDescription%22:%22Navigate%20to%20drafts%20with%20link%20to%20the%20current%20draft%20via%20%60[[Title%20of%20Draft]]%60%20style%20links.%5Cn%5CnIf%20only%20one%20draft%20with%20links%20to%20the%20current%20draft%20is%20found,%20navigate%20directly%20to%20that%20draft%20-%20if%20more%20than%20one%20is%20found,%20offer%20selection%20prompt%20to%20choose%20which%20to%20open.%22,%22keyUseIcon%22:false,%22icon%22:%22arrow-up-left%22,%22visibility%22:480,%22backingIsSeparator%22:false,%22groupUUID%22:%22CC8CE599-5253-472F-AF96-80CA35F2D759%22,%22assignTags%22:[],%22name%22:%221c.%20Back%20Links%22%7D,%7B%22uuid%22:%22CEDABC98-A37C-4F51-A389-6D8C626CEE40%22,%22steps%22:[],%22backingPlatforms%22:3,%22shortName%22:%22%22,%22shouldConfirm%22:false,%22disposition%22:3,%22keyCommand%22:%7B%22optionKey%22:false,%22input%22:%22%22,%22controlKey%22:false,%22commandKey%22:false,%22type%22:%22empty%22,%22discoverabilityTitle%22:%22Invalid%22,%22shiftKey%22:false%7D,%22logLevel%22:2,%22groupDisposition%22:0,%22notificationType%22:2,%22tintColor%22:%22none%22,%22actionDescription%22:%22%22,%22keyUseIcon%22:false,%22icon%22:%22%22,%22visibility%22:480,%22backingIsSeparator%22:true,%22groupUUID%22:%22CC8CE599-5253-472F-AF96-80CA35F2D759%22,%22assignTags%22:[],%22name%22:%22%F0%9F%A7%B9%20Neatness%22%7D,%7B%22uuid%22:%2261361C8F-4343-461B-8C07-5859653ABBC8%22,%22steps%22:[%7B%22platforms%22:3,%22data%22:%7B%22script%22:%22//%20See%20online%20documentation%20for%20examples%5Cn//%20http://getdrafts.com/scripting%5Cn%5Cneditor.setText(editor.getText().split(%5C%22%5C%5Cn%5C%22).join(%5C%22%20%20%5C%5Cn%5C%22));%22%7D,%22type%22:%22script%22,%22isEnabled%22:true,%22uuid%22:%228C6DA1C5-2572-47FC-9106-F273EB42D0CA%22%7D],%22backingPlatforms%22:3,%22shortName%22:%22%22,%22shouldConfirm%22:false,%22disposition%22:3,%22keyCommand%22:%7B%22optionKey%22:false,%22input%22:%22%22,%22controlKey%22:false,%22commandKey%22:false,%22type%22:%22action%22,%22discoverabilityTitle%22:%222a.%20Make%20Markdown%20Line%20Breaks%22,%22shiftKey%22:false%7D,%22logLevel%22:2,%22groupDisposition%22:0,%22notificationType%22:2,%22tintColor%22:%22violet%22,%22actionDescription%22:%22%22,%22keyUseIcon%22:false,%22icon%22:%22menu%22,%22visibility%22:480,%22backingIsSeparator%22:false,%22groupUUID%22:%22CC8CE599-5253-472F-AF96-80CA35F2D759%22,%22assignTags%22:[],%22name%22:%222a.%20Make%20Markdown%20Line%20Breaks%22%7D,%7B%22uuid%22:%220A5B9BD7-65F0-44D4-8996-BE06F2139DE7%22,%22steps%22:[%7B%22platforms%22:3,%22data%22:%7B%22hideInterface%22:%22false%22,%22template%22:%22%5Cu003c!DOCTYPE%20html%5Cu003e%5Cn%5Cu003chtml%20dir=%5C%22auto%5C%22%5Cu003e%5Cn%5Cu003chead%5Cu003e%5Cn%5Cu003ctitle%5Cu003ePreview%5Cu003c/title%5Cu003e%5Cn%5Cu003cmeta%20name=%5C%22viewport%5C%22%20content=%5C%22width=device-width,%20initial-scale=1%5C%22%5Cu003e%5Cn%5Cu003cstyle%5Cu003e%5Cn@charset%20%5C%22utf-8%5C%22;%5Cn%5Cnhtml%20%7B%20%5Cn%5Ctfont-size:%20100%25;%5Cn%5Ctfont-family:%20%5C%22Helvetica%20Neue%5C%22,%20%5C%22Helvetica%5C%22,%20sans-serif;%5Cn%7D%5Cnbody%20%7B%5Cn%5Ctmargin:0;%5Cn%5Ctpadding:1em;%5Cn%7D%5Cn@media%20(max-device-width:%20480px)%20%7B%20%5Cn%5Cn%7D%20%5Cn@media%20(min-device-width:%20481px)%20%7B%20%5Cn%5Ctbody%20%7B%5Cn%5Ct%5Ctmargin:auto;%5Cn%5Ct%5Ctmax-width:600px;%5Cn%5Ct%7D%20%5Cn%7D%5Cn%5Cnblockquote%20%7B%5Cn%5Ctfont-style:%20italic;%5Cn%7D%5Cn%5Cncode%20%7B%5Cn%20%20%20%20border-radius:%203px;%5Cn%20%20%20%20background-color:%20%23F8F8F8;%5Cn%20%20%20%20color:%20inherit;%5Cn%7D%5Cn%5Cntable%20%7B%5Cn%20%20margin:%201em%200;%5Cn%20%20border:%201px%20solid%20%23aaa;%5Cn%20%20border-collapse:%20collapse;%5Cn%7D%5Cn%5Cnth%20%7B%5Cn%20%20padding:.25em%20.5em;%5Cn%20%20background:%20%23efefef;%5Cn%20%20border:%201px%20solid%20%23ccc;%20%20%5Cn%7D%5Cn%5Cntd%20%7B%5Cn%20%20padding:.25em%20.5em;%5Cn%20%20border:%201px%20solid%20%23ccc;%5Cn%7D%5Cn%5Cnimg%20%7B%5Cn%20%20%20%20max-width:%2090%25;%5Cn%7D%5Cn%5Cn%5Cu003c/style%5Cu003e%5Cn%5Cu003c/head%5Cu003e%5Cn%5Cu003cbody%5Cu003e%5Cn%20%20%25%25[[draft]]%25%25%5Cn%5Cu003c/body%5Cu003e%5Cn%5Cu003c/html%5Cu003e%5Cn%22%7D,%22type%22:%22htmlpreview%22,%22isEnabled%22:true,%22uuid%22:%22EA15C7C3-AFCC-4601-B6EA-4AFCAA5A1A0A%22%7D],%22groupDisposition%22:0,%22shortName%22:%22%22,%22shouldConfirm%22:false,%22disposition%22:3,%22keyCommand%22:%7B%22optionKey%22:false,%22input%22:%22%22,%22controlKey%22:false,%22commandKey%22:false,%22type%22:%22action%22,%22discoverabilityTitle%22:%222b.%20Markdown%20Preview-Swiss%22,%22shiftKey%22:false%7D,%22logLevel%22:2,%22notificationType%22:1,%22tintColor%22:%22violet%22,%22actionDescription%22:%22Process%20draft%20as%20Markdown%20and%20open%20HTML%20preview%20of%20the%20results%20using%20built-in%20Swiss%20styles.%22,%22keyUseIcon%22:false,%22icon%22:%22action_markdown%22,%22visibility%22:480,%22groupUUID%22:%22CC8CE599-5253-472F-AF96-80CA35F2D759%22,%22assignTags%22:[],%22name%22:%222b.%20Markdown%20Preview-Swiss%22%7D,%7B%22uuid%22:%22EE818C49-4723-459A-A5CC-5B5CCDA5EE23%22,%22steps%22:[],%22backingPlatforms%22:3,%22shortName%22:%22%22,%22shouldConfirm%22:false,%22disposition%22:3,%22keyCommand%22:%7B%22optionKey%22:false,%22input%22:%22%22,%22controlKey%22:false,%22commandKey%22:false,%22type%22:%22empty%22,%22discoverabilityTitle%22:%22Invalid%22,%22shiftKey%22:false%7D,%22logLevel%22:2,%22groupDisposition%22:0,%22notificationType%22:2,%22tintColor%22:%22none%22,%22actionDescription%22:%22%22,%22keyUseIcon%22:false,%22icon%22:%22%22,%22visibility%22:480,%22backingIsSeparator%22:true,%22groupUUID%22:%22CC8CE599-5253-472F-AF96-80CA35F2D759%22,%22assignTags%22:[],%22name%22:%22%F0%9F%9A%9A%20Distribute%20notes%22%7D,%7B%22uuid%22:%22D6CC79E2-5E39-4F0A-BE79-18224AFF081A%22,%22steps%22:[%7B%22platforms%22:1,%22data%22:%7B%22name%22:%22TAD-Share%20as%20File:%20Syntax%22%7D,%22type%22:%22includeAction%22,%22isEnabled%22:true,%22uuid%22:%229581E81C-6B15-4B57-B166-A3C75BD7EAE3%22%7D,%7B%22platforms%22:3,%22data%22:%7B%22sendInBackground%22:%22false%22,%22ccRecipients%22:%22%22,%22toRecipients%22:%22%22,%22bccRecipients%22:%22%22,%22sendAsHTML%22:%22true%22,%22subjectTemplate%22:%22[[title]]%22,%22bodyTemplate%22:%22%25%25Beste,%5Cn%5CnIn%20andere%20mail%20vind%20je%20onderstaande%20notitie%20die%20je%20kan%20openen%20in%20Drafts%20om%20onderstaande%20te%20kunnen%20doen.%5Cn%5CnZou%20je%20het%20volgende%20willen%20doen,%20met%20dit%20verslag?%20:%5Cn%5CnKanaal:%20%5Cn%5Cn1.%20Opmaak%20en%20taal%20controleren%5Cn2.%20Versturen%20naar%20de%20aanwezigen%20en%20cc%20naar%20de%20afwezigen/%20afgemelde%20personen%5Cn3.%20De%20acties%20overnemen:%20versturen%20naar%20Teams%20%5C%22@Inbox%5C%22%20in%20Project%20Mangement,%20verplaatsen%20naar%20kanaal%20en%20de%20juiste%20eigenaar%20er%20aan%20koppelen?%5Cn4.%20De%20besluiten%20overnemen%20in%20Besluiten%20register,%20gelabeld%20met%20hetzelfde%20Scrum%20team%20%5Cu003chier%5Cu003e%20en%20verwijzen%20naar%20dit%20overleg.%5Cn5.%20Het%20verslag%20versturen%20naar%20OneNote%20(ON)%5Cn%5CnAlvast%20bedankt.%5Cn________________________________________________________________________________________________________%5Cn%5Cn[[draft]]%25%25%22%7D,%22type%22:%22mail%22,%22isEnabled%22:true,%22uuid%22:%22D9646F4F-EBBB-4E45-B6D0-DA72291855F9%22%7D],%22groupDisposition%22:0,%22shortName%22:%22%22,%22shouldConfirm%22:false,%22disposition%22:3,%22keyCommand%22:%7B%22optionKey%22:false,%22input%22:%22%22,%22controlKey%22:false,%22commandKey%22:false,%22type%22:%22action%22,%22discoverabilityTitle%22:%223a.%20Mail%20to%20PA%20for%20processing%22,%22shiftKey%22:false%7D,%22logLevel%22:2,%22notificationType%22:1,%22tintColor%22:%22violet%22,%22actionDescription%22:%22%22,%22keyUseIcon%22:false,%22icon%22:%22action_email_filled%22,%22visibility%22:480,%22groupUUID%22:%22CC8CE599-5253-472F-AF96-80CA35F2D759%22,%22assignTags%22:[],%22name%22:%223a.%20Mail%20to%20PA%20for%20processing%22%7D,%7B%22uuid%22:%220CE87AF8-3CD9-4154-9E42-9173CC21A523%22,%22steps%22:[%7B%22platforms%22:3,%22data%22:%7B%22template%22:%22%25%25[[body]]%25%25%22,%22name%22:%22htmlbody%22%7D,%22type%22:%22defineTemplateTag%22,%22isEnabled%22:true,%22uuid%22:%228FB58EDB-9326-4B78-BE8B-1B71B4D3676C%22%7D,%7B%22platforms%22:1,%22data%22:%7B%22sendInBackground%22:%22false%22,%22ccRecipients%22:%22%22,%22toRecipients%22:%22%22,%22bccRecipients%22:%22%22,%22sendAsHTML%22:%22true%22,%22subjectTemplate%22:%22[[title]]%22,%22bodyTemplate%22:%22[[htmlbody]]%22%7D,%22type%22:%22mail%22,%22isEnabled%22:true,%22uuid%22:%2208A1B45E-1FE2-4ADA-A4A3-603E05303938%22%7D,%7B%22platforms%22:2,%22data%22:%7B%22template%22:%22mail-assistant://sendMail?subject=[[title]]%5Cu0026body=[[htmlbody]]%5Cu0026html=true%22,%22encodeTags%22:%22true%22,%22waitForResponse%22:%22true%22%7D,%22type%22:%22callbackUrl%22,%22isEnabled%22:true,%22uuid%22:%2230C53CD1-F966-412E-8318-08B061EA3059%22%7D],%22backingPlatforms%22:3,%22shortName%22:%22%22,%22shouldConfirm%22:false,%22disposition%22:3,%22keyCommand%22:%7B%22optionKey%22:false,%22input%22:%22%22,%22controlKey%22:false,%22commandKey%22:false,%22type%22:%22action%22,%22discoverabilityTitle%22:%223b.%20Mail%20meeting%20minutes%22,%22shiftKey%22:false%7D,%22logLevel%22:2,%22groupDisposition%22:0,%22notificationType%22:2,%22tintColor%22:%22indigo%22,%22actionDescription%22:%22Example%20action%20demonstrating%20how%20to%20use%20Mail%20Assistant%20to%20send%20HTML/Markdown%20mail%20on%20Mac%20via%20URL%20scheme.%5Cn%5CnOn%20iOS,%20a%20Mail%20action%20step%20is%20used%20to%20send%20mail.%5Cn%5CnOn%20Mac,%20the%20[Mail%20Assistant](https://docs.getdrafts.com/misc/mail-assistant)%20must%20be%20installed,%20and%20will%20be%20called%20via%20URL%20scheme%20to%20compose%20the%20email.%22,%22keyUseIcon%22:false,%22icon%22:%22action_email%22,%22visibility%22:480,%22backingIsSeparator%22:false,%22groupUUID%22:%22CC8CE599-5253-472F-AF96-80CA35F2D759%22,%22assignTags%22:[],%22name%22:%223b.%20Mail%20meeting%20minutes%22%7D,%7B%22uuid%22:%220BBAD84E-1CCE-4944-99C3-A1E438C5F0C4%22,%22steps%22:[%7B%22platforms%22:3,%22data%22:%7B%22format%22:%22markdown%22,%22writeType%22:%22prepend%22,%22notebook%22:%22%22,%22oauthIdentifier%22:%22%22,%22section%22:%22Meeting%20notes%22,%22page%22:%22[[safe_title]]%22,%22template%22:%22[[body]]%5Cn%5CnTag:%20[[tags]]%22%7D,%22type%22:%22onenote%22,%22isEnabled%22:true,%22uuid%22:%22A06F84D9-1682-4C89-9C58-9859480BAEE3%22%7D],%22backingPlatforms%22:3,%22shortName%22:%22%22,%22shouldConfirm%22:false,%22disposition%22:3,%22keyCommand%22:%7B%22optionKey%22:false,%22input%22:%22%22,%22controlKey%22:false,%22commandKey%22:false,%22type%22:%22action%22,%22discoverabilityTitle%22:%223c.%20Notes%20on%20ON%22,%22shiftKey%22:false%7D,%22logLevel%22:2,%22groupDisposition%22:0,%22notificationType%22:2,%22tintColor%22:%22violet%22,%22actionDescription%22:%22Save%20to%20timestamped%20note%20in%20the%20%E2%80%9CDrafts%E2%80%9D%20section%20of%20your%20default%20OneNote%20notebook.%22,%22keyUseIcon%22:true,%22icon%22:%22action_clipboard_filled%22,%22visibility%22:224,%22backingIsSeparator%22:false,%22groupUUID%22:%22CC8CE599-5253-472F-AF96-80CA35F2D759%22,%22assignTags%22:[],%22name%22:%223c.%20Notes%20on%20ON%22%7D,%7B%22uuid%22:%22B2F9CE4B-9D98-4787-949A-38B3F0AB2769%22,%22steps%22:[%7B%22platforms%22:3,%22data%22:%7B%22script%22:%22//%20Advanced%20Print%5Cn//%20RV%202020-03-26%20at%2021:01%5Cn%5Cn//%20Chose%20predefined%20css%20drafts%20with%20tag:%20&#39;css-print&#39;%5Cn//%20Print%20current%20draft%20or%20directly%20from%20clipboard.%5Cn//%20Select%20to%20preserve%20ln,%20add%20toc,%20and%20show%20preview%5Cn//%20Settings%20are%20saved%20between%20runs.%5Cn//%20The%20actual%20printing%20is%20in%20the%20following%20action%20step.%5Cn//%20Style%20drafts%20are%20plain%20css,%20so%20easy%20to%20apply%20any%20css.%5Cn%5Cn&#39;use%20strict&#39;;%5Cnlet%20tocHead%20=%20&#39;%23%23%23%20Table%20of%20Contents&#39;%5Cnlet%20path%20=%20&#39;/print-settings.json&#39;%5Cn%5Cnfunction%20main()%20%7B%5Cn%20%20//%20prompt%20to%20select%5Cn%20%20let%20st%20=%20getSettings();%5Cn%20%20let%20p%20=%20Prompt.create();%5Cn%20%20p.title%20=%20%5C%22Print%20Menu%5C%22;%5Cn%20%20//%20p.message%20=%20%5C%22Select%20Print%20Style:%5C%22;%5Cn%20%20p.addSelect(&#39;source&#39;,%20%5C%22Select%20Source:%5C%22,%20[&#39;Current%20Draft&#39;,%20&#39;Text%20in%20Clipboard&#39;],%20[st.source],%20false);%5Cn%20%20p.addSwitch(%5C%22ln%5C%22,%20%5C%22Keep%20Line%20Breaks%5C%22,%20st.ln);%5Cn%20%20p.addSwitch(%5C%22prev%5C%22,%20%5C%22Show%20Preview%5C%22,%20st.prev);%5Cn%20%20p.addSwitch(%5C%22toc%5C%22,%20%5C%22Make%20TOC%5C%22,%20st.toc);%5Cn%20%20%5Cn%20%20let%20cssList%20=%20getCSS();%5Cn%20%20//%20p.addButton(&#39;Default%20Style&#39;,%20-1);%5Cn%20%20let%20i%20=%200%5Cn%20%20for%20(let%20cssObj%20of%20cssList)%20%7B%5Cn%20%20%20%20p.addButton(cssObj.title,%20i);%5Cn%20%20%20%20i++;%5Cn%20%20%7D%5Cn%20%20%5Cn%20%20if%20(!p.show())%20%7B%5Cn%20%20%20%20context.cancel(&#39;canceled%20by%20user&#39;);%5Cn%20%20%20%20return%20false;%5Cn%20%20%7D%5Cn%20%20%5Cn%20%20//%20get%20the%20selected%20css%20draft%5Cn%20%20let%20selIndex%20=%20parseInt(p.buttonPressed);%5Cn%20%20let%20cssObj%20=%20cssList[selIndex];%5Cn%20%20let%20css%20=%20cssObj.css;%5Cn%20%20st.toc%20=%20p.fieldValues[&#39;toc&#39;];%5Cn%20%20st.prev%20=%20p.fieldValues[&#39;prev&#39;];%5Cn%20%20st.ln%20=%20p.fieldValues[&#39;ln&#39;];%5Cn%20%20let%20doc%20=%20&#39;&#39;;%5Cn%20%20%5Cn%20%20//%20let%20sel%20=%20p.fieldValues[&#39;source&#39;][0];%5Cn%20%20st.source%20=%20p.fieldValues[&#39;source&#39;][0];%5Cn%20%20switch%20(st.source)%20%7B%5Cn%20%20%20%20case%20&#39;Current%20Draft&#39;:%5Cn%20%20%20%20%20%20doc%20=%20draft.content;%5Cn%20%20%20%20%20%20break;%5Cn%20%20%20%20case%20&#39;Text%20in%20Clipboard&#39;:%5Cn%20%20%20%20%20%20doc%20=%20app.getClipboard();%5Cn%20%20%20%20%20%20break;%5Cn%20%20%20%20default:%5Cn%20%20%20%20%20%20app.displayErrorMessage(&#39;switch/case%20not%20implemented!&#39;);%5Cn%20%20%20%20%20%20return;%5Cn%20%20%7D%5Cn%20%20makeHTML(doc,%20css,%20st);%5Cn%20%20//%20print%20is%20done%20in%20next%20action%20step,%20using%20[[html]]%20template%20tag.%5Cn%7D%5Cn%5Cnfunction%20getSettings()%20%7B%5Cn%20%20let%20fmCloud%20=%20FileManager.createCloud();%5Cn%20%20let%20settings%20=%20fmCloud.readString(path);%5Cn%20%20if%20(!settings)%20%7B%20%5Cn%20%20%20%20//%20No%20file%20found,%20use%20default;%5Cn%20%20%20%20var%20obj%20=%20%7B&#39;source&#39;:%20&#39;Current%20Draft&#39;,%20&#39;ln&#39;:%20true,%20&#39;toc&#39;:%20false,%20&#39;prev&#39;:%20true%7D%5Cn%20%20%7D%20else%20%7B%5Cn%20%20%20%20var%20obj%20=%20JSON.parse(settings)%5Cn%20%20%7D%5Cn%5Cn%20%20return%20obj;%5Cn%7D%5Cn%5Cnfunction%20saveSettings(obj)%20%7B%5Cn%20%20let%20fmCloud%20=%20FileManager.createCloud();%5Cn%20%20let%20success%20=%20fmCloud.write(path,%20JSON.stringify(obj));%5Cn%7D%5Cn%5Cnfunction%20makeHTML(doc,%20css,%20st)%20%7B%5Cn%20%20let%20mmd%20=%20MultiMarkdown.create();%5Cn%20%20mmd.format%20=%20%5C%22html%5C%22;%5Cn%20%20%5Cn%20%20if%20(st.toc)%20%7B%5Cn%20%20%20%20doc%20=%20doc.replace(/%5C%5Cn/,%20&#39;%5C%5Cn%5C%5Cn&#39;%20+%20tocHead%20+%20&#39;%5C%5Cn%7B%7BTOC%7D%7D&#39;)%5Cn%20%20%7D%5Cn%20%20%5Cn%20%20if%20(st.ln)%20%7B%5Cn%20%20%20%20//%20add%202%20spaces%20to%20end%20of%20line%20%5Cn%20%20%20%20doc%20=%20doc.replace(/(%5C%5CS+?)%20*$/gm,%20&#39;$1%20%20&#39;);%5Cn%20%20%7D%5Cn%5Cn%20%20let%20body%20=%20mmd.render(doc);%5Cn%20%20//%20css%20=%20&#39;&#39;;%5Cn%20%20let%20html%20=%20%60%5Cu003chtml%5Cu003e%5Cn%20%20%5Cu003cstyle%5Cu003e%5Cn%20%20$%7Bcss%7D%5Cn%20%20%5Cu003c/style%5Cu003e%5Cn%20%20%5Cu003cbody%5Cu003e%5Cn%20%20$%7Bbody%7D%5Cn%20%20%5Cu003c/div%5Cu003e%5Cn%20%20%5Cu003c/body%5Cu003e%5Cn%20%20%5Cu003c/html%5Cu003e%5Cn%20%20%60%5Cn%20%20%5Cn%20%20if%20(st.prev)%20%7B%5Cn%20%20%20%20let%20preview%20=%20HTMLPreview.create();%5Cn%20%20%20%20if%20(!preview.show(darklight(html)))%20%7B%5Cn%20%20%20%20%20%20context.cancel(&#39;canceled%20by%20user&#39;);%5Cn%20%20%20%20%20%20return;%5Cn%20%20%20%20%7D%5Cn%20%20%7D%5Cn%20%20saveSettings(st);%5Cn%20%20draft.setTemplateTag(%5C%22html%5C%22,%20html);%5Cn%7D%5Cn%5Cnfunction%20getCSS()%20%7B%5Cn%20%20//%20get%20list%20of%20drafts%20in%20all%5Cn%20%20let%20drafts%20=%20Draft.query(%5C%22%5C%22,%20%5C%22all%5C%22,%20[&#39;css-print&#39;],%20[&#39;&#39;],%20&#39;name&#39;);%5Cn%20%20%5Cn%20%20//%20check%20if%20found%20any%20valid%20ccs%5Cn%20%20if%20(drafts.length%20==%200)%20%7B%5Cn%20%20%20%20alert(%60No%20Style%20Sheet%20found,%5Cn%20%20%20%20only%20Default%20style%20available.%5Cn%20%20%20%20%5Cn%20%20%20%20To%20make%20other%20styles%20available,%5Cn%20%20%20%20create%20a%20draft%20with%20css%20content%5Cn%20%20%20%20and%20assign%20the%20tag%20%5C%22css-print%5C%5C%5C%22.%60);%5Cn%20%20%7D%5Cn%20%20%5Cn%20%20let%20cssList%20=%20[%7B&#39;title&#39;:%20&#39;Default%20Monospace%20Style&#39;,%20&#39;i&#39;:%200,%20&#39;css&#39;:%20defaultCSS%7D];%5Cn%20%20//%20p.addButton(&#39;Default%20Style&#39;,%20-1);%5Cn%20%20let%20i%20=%201%5Cn%20%20for%20(let%20d%20of%20drafts)%20%7B%5Cn%20%20%20%20let%20title%20=%20d.title.replace(/%5C%5C/%5C%5C*%20*(.+?)(.css)?%20*%5C%5C*%5C%5C//,%20&#39;$1&#39;);%5Cn%20%20%20%20let%20css%20=%20d.content;%5Cn%20%20%20%20cssList.push(%7B&#39;title&#39;:%20title,%20&#39;i&#39;:%20i,%20&#39;css&#39;:%20css%7D);%5Cn%20%20%20%20i++;%5Cn%20%20%7D%5Cn%20%20return%20cssList;%5Cn%7D%5Cn%5Cnlet%20defaultCSS%20=%20%60/*%20Default%20CSS%20monospace%20style%20*/%5Cnbody%20%7B%5Cn%20%20font-family:%20Menlo,%20monospace;%5Cn%20%20font-size:%2050%25;%5Cn%7D%60;%5Cn%5Cnfunction%20darklight(html)%20%7B%5Cn%20%20//%20create%20theme%20sensitive%20css%20for%20preview%5Cn%20%20%5Cn%20%20if%20(app.themeMode%20==%20&#39;dark&#39;)%20%7B%5Cn%20%20%20%20var%20css%20=%20%5C%22%5C%5Cnbody%20%7B%20background:%20%23222;%20color:%20%23ddd;%20%7D%5C%5Cn%5C%22;%5Cn%20%20%7D%20else%20%7B%5Cn%20%20%20%20var%20css%20=%20%5C%22%5C%5Cnbody%20%7B%20background:%20%23fff;%20color:%20%23444;%20%7D%5C%5Cn%5C%22;%5Cn%20%20%7D%5Cn%20%20return%20html.replace(/%5Cu003c%5C%5C/style%5Cu003e/,%20css%20+%20&#39;%5Cu003c/style%5Cu003e&#39;);%5Cn%7D%5Cn%5Cnmain();%5Cn%5Cn%22,%22allowAsync%22:%22false%22%7D,%22type%22:%22script%22,%22isEnabled%22:true,%22uuid%22:%221E0B30C6-ADE0-4890-A53E-9D3DF5ED213A%22%7D,%7B%22platforms%22:3,%22data%22:%7B%22template%22:%22[[title]]%22,%22writeType%22:%22replace%22%7D,%22type%22:%22clipboard%22,%22isEnabled%22:true,%22uuid%22:%22D59E0E45-775E-4764-9907-0DD9EE8A79E3%22%7D,%7B%22platforms%22:3,%22data%22:%7B%22format%22:%22html%22,%22baseFontPointSize%22:%2211%22,%22marginTop%22:%2272%22,%22marginLeft%22:%2272%22,%22marginBottom%22:%2272%22,%22marginRight%22:%2272%22,%22template%22:%22[[html]]%22%7D,%22type%22:%22print%22,%22isEnabled%22:true,%22uuid%22:%228DE306D5-D2DA-4A04-B20B-9E85BF378444%22%7D],%22backingPlatforms%22:3,%22shortName%22:%22%22,%22shouldConfirm%22:false,%22disposition%22:3,%22keyCommand%22:%7B%22optionKey%22:false,%22input%22:%22%22,%22controlKey%22:false,%22commandKey%22:false,%22type%22:%22action%22,%22discoverabilityTitle%22:%223d.%20Print/PDF%20export%22,%22shiftKey%22:false%7D,%22logLevel%22:2,%22groupDisposition%22:0,%22notificationType%22:1,%22tintColor%22:%22violet%22,%22actionDescription%22:%22Advanced%20Print%20/%20PDF%20export.%5Cn%5CnPrints%20current%20draft%20or%20directly%20from%20clipboard:%5Cn%5Cn-%20Uses%20predefined%20css-drafts%20with%20tag:%20&#39;css-print&#39;%5Cn-%20Select%20to%20preserve%20line%20breaks,%20add%20TOC,%20or%20show%20preview.%5Cn-%20Settings%20are%20saved%20between%20runs.%5Cn-%20The%20actual%20printing%20is%20in%20a%20separate%20%E2%80%9CPrint%E2%80%9D%20action%20step.%5Cn-%20Style-drafts%20are%20plain%20css,%20so%20easy%20to%20apply%20any%20css.%5Cn-%20PDFs%20can%20be%20made%20in%20the%20iOS%20print%20preview%20(not%20Drafts%20preview)%20by%20two%20finger%20expand%20gesture%20and%20then%20tapping%20share%20button.%22,%22keyUseIcon%22:true,%22icon%22:%22action_print%22,%22visibility%22:480,%22backingIsSeparator%22:false,%22groupUUID%22:%22CC8CE599-5253-472F-AF96-80CA35F2D759%22,%22assignTags%22:[],%22name%22:%223d.%20Print/PDF%20export%22%7D,%7B%22uuid%22:%222544820A-090B-4C07-91F9-1E8F6FFC0287%22,%22steps%22:[],%22backingPlatforms%22:3,%22shortName%22:%22%22,%22shouldConfirm%22:false,%22disposition%22:3,%22keyCommand%22:%7B%22optionKey%22:false,%22input%22:%22%22,%22controlKey%22:false,%22commandKey%22:false,%22type%22:%22empty%22,%22discoverabilityTitle%22:%22Invalid%22,%22shiftKey%22:false%7D,%22logLevel%22:2,%22groupDisposition%22:0,%22notificationType%22:2,%22tintColor%22:%22none%22,%22actionDescription%22:%22%22,%22keyUseIcon%22:false,%22icon%22:%22%22,%22visibility%22:480,%22backingIsSeparator%22:true,%22groupUUID%22:%22CC8CE599-5253-472F-AF96-80CA35F2D759%22,%22assignTags%22:[],%22name%22:%22%E2%98%91%EF%B8%8F%20%F0%9F%94%A8Tasks%20%5Cu0026%20Decisions%22%7D,%7B%22uuid%22:%22C6AD46DF-2DC3-48C6-BFF4-491D4B5FD332%22,%22steps%22:[%7B%22platforms%22:3,%22data%22:%7B%22template%22:%22[[title]]%22,%22writeType%22:%22append%22%7D,%22type%22:%22clipboard%22,%22isEnabled%22:true,%22uuid%22:%22E93EE3B8-18B0-463E-9D17-F7956F82A8A1%22%7D,%7B%22platforms%22:3,%22data%22:%7B%22script%22:%22//%20Start%20every%20line%20with%20a%20@%20to%20denote%20it%20as%20a%20task%5Cn%5Cnconst%20taskPrefix%20=%20%5C%22@%20%5C%22;%5Cn%5Cn//%20Function%20for%20removing%20the%20task%20prefix%5Cnfunction%20removeTaskPrefix(s)%20%7B%5Cn%20%20var%20f%20%20%20%20%20%20%20=%20(taskPrefix),%5Cn%20%20%20%20%20%20r%20%20%20%20%20%20%20=%20%5C%22%5C%22,%5Cn%20%20%20%20%20%20re%20%20%20%20%20%20=%20new%20RegExp(f,%5C%22g%5C%22),%5Cn%20%20%20%20%20%20matches%20=%20s.match(re);%5Cn%5Cn%20%20if%20(matches)%20%7B%5Cn%20%20%20%20return%20s.replace(re,r);%5Cn%20%20%7D%5Cn%7D%5Cn%5Cn//%20Function%20to%20perform%20the%20callback%20url%5Cnfunction%20doCallbackURL(url,%20params)%20%7B%5Cn%20%20var%20cb%20=%20CallbackURL.create();%5Cn%20%20cb.baseURL%20=%20url;%5Cn%5Cn%20%20for(var%20key%20in%20params)%20%7B%5Cn%20%20%20cb.addParameter(key,%20params[key]);%5Cn%20%20%7D%5Cn%5Cn%20%20var%20success%20=%20cb.open();%5Cn%20%20if%20(success)%20%7B%5Cn%20%20%20%20console.log(%5C%22Event%20created%5C%22);%5Cn%20%20%7D%20else%20%7B%5Cn%20%20%20%20console.log(cb.status);%5Cn%20%20%20%20if%20(cb.status%20==%20%5C%22cancel%5C%22)%20%7B%5Cn%20%20%20%20%20%20context.cancel();%5Cn%20%20%20%20%7D%20else%20%7B%5Cn%20%20%20%20%20%20context.fail();%5Cn%20%20%20%20%7D%5Cn%20%20%7D%5Cn%7D%5Cn%5Cn//%20Scan%20for%20the%20task%20prefix%20in%20the%20draft%5Cnvar%20lines%20=%20draft.content.split(%5C%22%5C%5Cn%5C%22);%5Cn%5Cnfor%20(var%20line%20of%20lines)%20%7B%5Cn%20%20//%20If%20the%20line%20includes%20the%20task%20prefix,%20%5Cn%20%20//%20we%20remove%20exclude%20it%20from%20the%20final%20notes%5Cn%20%20if%20(line.startsWith(taskPrefix))%20%7B%5Cn%5Cn%20%20%20%20//%20Remove%20the%20trigger%20from%20the%20line%5Cn%20%20%20%20var%20task%20=%20removeTaskPrefix(line);%5Cn%20%20%20%20var%20alink%20=%20draft.permalink;%5Cn%20%20%20%20console.log(task);%5Cn%20%20%20%20console.log(alink);%5Cn%20%20%20%20%5Cn%20%20%20%20//%20OmniFocus%20URL%20Action%5Cn%20%20%20%20doCallbackURL(%5C%22omnifocus:///add%5C%22,%20%7B%5C%22name%5C%22:%20task,%20%5C%22note%5C%22:%5C%22Title%20and%20link%20to%20note:%20%5C%22%20+%20draft.displayTitle%20+%20%5C%22:%20with%20link:%20%5C%22%20+%20alink,%20%5C%22autosave%5C%22:%20true%7D);%5Cn%20%7D%5Cn%7D%5Cn%5Cn%5Cn%22,%22allowAsync%22:%22false%22%7D,%22type%22:%22script%22,%22isEnabled%22:true,%22uuid%22:%2274ED0963-0318-4656-8DEB-A905AD34E190%22%7D],%22backingPlatforms%22:3,%22shortName%22:%22%22,%22shouldConfirm%22:false,%22disposition%22:3,%22keyCommand%22:%7B%22optionKey%22:false,%22input%22:%22%22,%22controlKey%22:false,%22commandKey%22:false,%22type%22:%22action%22,%22discoverabilityTitle%22:%224a.%20OmniFocus%20tasks%20with%20link-back%22,%22shiftKey%22:false%7D,%22logLevel%22:2,%22groupDisposition%22:0,%22notificationType%22:1,%22tintColor%22:%22violet%22,%22actionDescription%22:%22Parses%20a%20note%20for%20lines%20beginning%20with%20a%20dash.%20Makes%20those%20into%20OmniFocus%20tasks,%20and%20includes%20a%20link%20back%20to%20the%20Draft%20in%20the%20note%20field%20of%20the%20tasks.%20%5Cn%5CnProps%20to%20@RegularCraig%20for%20the%20original%20code.%20%22,%22keyUseIcon%22:false,%22icon%22:%22action_reminders%22,%22visibility%22:480,%22backingIsSeparator%22:false,%22groupUUID%22:%22CC8CE599-5253-472F-AF96-80CA35F2D759%22,%22assignTags%22:[],%22name%22:%224a.%20OmniFocus%20tasks%20with%20link-back%22%7D,%7B%22uuid%22:%22D5B8B342-5111-4D96-8956-094653661E58%22,%22steps%22:[%7B%22platforms%22:0,%22data%22:%7B%22notebookTemplate%22:%22%22,%22format%22:%22text%22,%22writeType%22:%22create%22,%22tagTemplate%22:%22%22,%22template%22:%22[[title]]%20-%20[[draft]]%22,%22nameTemplate%22:%22[[title]]%22%7D,%22type%22:%22evernote%22,%22isEnabled%22:false,%22uuid%22:%22F7C11AB2-EE7D-4372-B9BF-B0756DAE4747%22%7D,%7B%22platforms%22:3,%22data%22:%7B%22script%22:%22//%20@jmvfr%5Cn%5Cnvar%20lines%20=%20draft.content.split(&#39;%5C%5Cn&#39;);%5Cnvar%20s%20=%20&#39;&#39;;%5Cnfor(var%20ix%20in%20lines)%20%7B%5Cnltmp%20=%20new%20String(lines[ix]);%5Cnif(ltmp.charAt(0)==&#39;@&#39;)%20%7B%5Cn%20%20s%20+=%20ltmp.substr(2)%20+%20&#39;%7CFor%20context%20see%20the%20notes%20in%20your%20mail%20with%20title:%20&#39;%20+%20draft.title%20+%20&#39;%5C%5Cn&#39;%5Cn%7D%5Cn%20%5Cn%7D%5Cn%5Cnapp.setClipboard(draft.content);%5Cndraft.content=s;%22,%22allowAsync%22:%22false%22%7D,%22type%22:%22script%22,%22isEnabled%22:true,%22uuid%22:%22E4AD47F7-DFEB-4432-A519-064863D5A238%22%7D,%7B%22platforms%22:3,%22data%22:%7B%22template%22:%22[[draft]]%22,%22delimiter%22:%22%7C%22,%22listNameTemplate%22:%22Inbox%20-%20SL%20Departments%20%5Cu0026%20Project%20Management%22%7D,%22type%22:%22reminderList%22,%22isEnabled%22:true,%22uuid%22:%2298A732FA-FFC5-41D6-A0DE-FDA05C4F2B5D%22%7D,%7B%22platforms%22:3,%22data%22:%7B%22script%22:%22draft.content=app.getClipboard();%22,%22allowAsync%22:%22false%22%7D,%22type%22:%22script%22,%22isEnabled%22:true,%22uuid%22:%227C3A81BB-8B39-4E8A-B769-A84E7E713498%22%7D],%22backingPlatforms%22:3,%22shortName%22:%22%22,%22shouldConfirm%22:false,%22disposition%22:3,%22keyCommand%22:%7B%22optionKey%22:false,%22input%22:%22%22,%22controlKey%22:false,%22commandKey%22:false,%22type%22:%22action%22,%22discoverabilityTitle%22:%224b1.%20Planner%20SL%20-%20General%22,%22shiftKey%22:false%7D,%22logLevel%22:2,%22groupDisposition%22:0,%22notificationType%22:1,%22tintColor%22:%22violet%22,%22actionDescription%22:%22%23%20Dealing%20with%20your%20notes%20%23%5CnThis%20action%20step%20saves%20your%20draft%20in%20Drafts%20notes%20using%20[[title]]%20as%20file%20name%20and%20brings%20all%20your%20tasks%20(a%20line%20with%20&#39;@&#39;%20at%20first%20character)%20in%20OmniFocus%20via%20the%20default%20list%20in%20Reminders%20with%20link%20to%20Notes.%5Cn%5CnTwitter%20:%20@jmvfr%22,%22keyUseIcon%22:false,%22icon%22:%22action_iclouddrive%22,%22visibility%22:480,%22backingIsSeparator%22:false,%22groupUUID%22:%22CC8CE599-5253-472F-AF96-80CA35F2D759%22,%22assignTags%22:[],%22name%22:%224b1.%20Planner%20SL%20-%20General%22%7D,%7B%22uuid%22:%229BCA4A3C-32E9-416A-824C-39A13BF36FBD%22,%22steps%22:[%7B%22platforms%22:3,%22data%22:%7B%22script%22:%22//%20@jmvfr%5Cn%5Cnvar%20lines%20=%20draft.content.split(&#39;%5C%5Cn&#39;);%5Cnvar%20s%20=%20&#39;&#39;;%5Cnfor(var%20ix%20in%20lines)%20%7B%5Cnltmp%20=%20new%20String(lines[ix]);%5Cnif(ltmp.charAt(0)==&#39;@&#39;)%20%7B%5Cn%20%20s%20+=%20ltmp.substr(2)%20+%20&#39;%7CFor%20context%20see%20the%20notes%20in%20your%20mail%20with%20title:%20&#39;%20+%20draft.title%20+%20&#39;%5C%5Cn&#39;%5Cn%7D%5Cn%20%5Cn%7D%5Cn%5Cnapp.setClipboard(draft.content);%5Cndraft.content=s;%22,%22allowAsync%22:%22false%22%7D,%22type%22:%22script%22,%22isEnabled%22:true,%22uuid%22:%22E4AD47F7-DFEB-4432-A519-064863D5A238%22%7D,%7B%22platforms%22:3,%22data%22:%7B%22template%22:%22[[draft]]%22,%22delimiter%22:%22%7C%22,%22listNameTemplate%22:%22Inbox%20-%20SL%20Human%20Resource%22%7D,%22type%22:%22reminderList%22,%22isEnabled%22:true,%22uuid%22:%22C1063856-185E-43C8-8A97-768B6CA4263A%22%7D,%7B%22platforms%22:3,%22data%22:%7B%22script%22:%22draft.content=app.getClipboard();%22,%22allowAsync%22:%22false%22%7D,%22type%22:%22script%22,%22isEnabled%22:true,%22uuid%22:%227C3A81BB-8B39-4E8A-B769-A84E7E713498%22%7D],%22backingPlatforms%22:3,%22shortName%22:%22%22,%22shouldConfirm%22:false,%22disposition%22:3,%22keyCommand%22:%7B%22optionKey%22:false,%22input%22:%22%22,%22controlKey%22:false,%22commandKey%22:false,%22type%22:%22action%22,%22discoverabilityTitle%22:%224b2.%20Planner%20SL%20-%20HRM%22,%22shiftKey%22:false%7D,%22logLevel%22:2,%22groupDisposition%22:0,%22notificationType%22:1,%22tintColor%22:%22violet%22,%22actionDescription%22:%22%23%20Dealing%20with%20your%20notes%20%23%5CnThis%20action%20step%20saves%20your%20draft%20in%20Drafts%20notes%20using%20[[title]]%20as%20file%20name%20and%20brings%20all%20your%20tasks%20(a%20line%20with%20&#39;@&#39;%20at%20first%20character)%20in%20OmniFocus%20via%20the%20default%20list%20in%20Reminders%20with%20link%20to%20Notes.%5Cn%5CnTwitter%20:%20@jmvfr%22,%22keyUseIcon%22:false,%22icon%22:%22action_iclouddrive%22,%22visibility%22:480,%22backingIsSeparator%22:false,%22groupUUID%22:%22CC8CE599-5253-472F-AF96-80CA35F2D759%22,%22assignTags%22:[],%22name%22:%224b2.%20Planner%20SL%20-%20HRM%22%7D,%7B%22uuid%22:%22439B365A-E456-446C-BF1A-DC1768D2185F%22,%22steps%22:[%7B%22platforms%22:3,%22data%22:%7B%22script%22:%22//%20Start%20every%20line%20with%20a%20%F0%9F%94%A8%20to%20denote%20it%20as%20a%20decision%20to%20log%5Cn%5Cnconst%20taskPrefix%20=%20%5C%22%F0%9F%94%A8%5C%22;%5Cn%5Cn//%20Function%20for%20removing%20the%20task%20prefix%5Cnfunction%20removeTaskPrefix(s)%20%7B%5Cn%20%20var%20f%20%20%20%20%20%20%20=%20(taskPrefix),%5Cn%20%20%20%20%20%20r%20%20%20%20%20%20%20=%20%5C%22%5C%22,%5Cn%20%20%20%20%20%20re%20%20%20%20%20%20=%20new%20RegExp(f,%5C%22g%5C%22),%5Cn%20%20%20%20%20%20matches%20=%20s.match(re);%5Cn%5Cn%20%20if%20(matches)%20%7B%5Cn%20%20%20%20return%20s.replace(re,r);%5Cn%20%20%7D%5Cn%7D%5Cn%5Cn//%20Function%20to%20perform%20the%20callback%20url%5Cnfunction%20doCallbackURL(url,%20params)%20%7B%5Cn%20%20var%20cb%20=%20CallbackURL.create();%5Cn%20%20cb.baseURL%20=%20url;%5Cn%5Cn%20%20for(var%20key%20in%20params)%20%7B%5Cn%20%20%20cb.addParameter(key,%20params[key]);%5Cn%20%20%7D%5Cn%5Cn%20%20var%20success%20=%20cb.open();%5Cn%20%20if%20(success)%20%7B%5Cn%20%20%20%20console.log(%5C%22Event%20created%5C%22);%5Cn%20%20%7D%20else%20%7B%5Cn%20%20%20%20console.log(cb.status);%5Cn%20%20%20%20if%20(cb.status%20==%20%5C%22cancel%5C%22)%20%7B%5Cn%20%20%20%20%20%20context.cancel();%5Cn%20%20%20%20%7D%20else%20%7B%5Cn%20%20%20%20%20%20context.fail();%5Cn%20%20%20%20%7D%5Cn%20%20%7D%5Cn%7D%5Cn%5Cn//%20Scan%20for%20the%20task%20prefix%20in%20the%20draft%5Cnvar%20lines%20=%20draft.content.split(%5C%22%5C%5Cn%5C%22);%5Cn%5Cnfor%20(var%20line%20of%20lines)%20%7B%5Cn%20%20//%20If%20the%20line%20includes%20the%20task%20prefix,%20%5Cn%20%20//%20we%20remove%20exclude%20it%20from%20the%20final%20notes%5Cn%20%20if%20(line.startsWith(taskPrefix))%20%7B%5Cn%5Cn%20%20%20%20//%20Remove%20the%20trigger%20from%20the%20line%5Cn%20%20%20%20var%20task%20=%20removeTaskPrefix(line);%5Cn%20%20%20%20var%20alink%20=%20draft.permalink;%5Cn%20%20%20%20console.log(task);%5Cn%20%20%20%20console.log(alink);%5Cn%20%20%20%20%5Cn%20%20%20%20//%20OmniFocus%20URL%20Action%5Cn%20%20%20%20//%20doCallbackURL(%5C%22omnifocus:///add%5C%22,%20%7B%5C%22name%5C%22:%20task,%20%5C%22note%5C%22:%20alink,%20%5C%22autosave%5C%22:%20true%7D);%5Cn%20%20%20%20doCallbackURL(%5C%22omnifocus:///add%5C%22,%20%7B%5C%22name%5C%22:%20task,%20%5C%22note%5C%22:%20alink,%20%5C%22autosave%5C%22:%20true%7D);%5Cn%20%20%20%20///omnifocus:///add?name=Pick%2520up%2520milk%5Cu0026note=You%2520gotta%5Cn%20%7D%5Cn%7D%22,%22allowAsync%22:%22false%22%7D,%22type%22:%22script%22,%22isEnabled%22:true,%22uuid%22:%226481C533-B9D7-477B-AC42-FEA8E6655E04%22%7D],%22backingPlatforms%22:3,%22shortName%22:%22%22,%22shouldConfirm%22:false,%22disposition%22:3,%22keyCommand%22:%7B%22optionKey%22:false,%22input%22:%22%22,%22controlKey%22:false,%22commandKey%22:false,%22type%22:%22action%22,%22discoverabilityTitle%22:%224c.%20Decision%20log%20tasks%20with%20link-back%22,%22shiftKey%22:false%7D,%22logLevel%22:1,%22groupDisposition%22:0,%22notificationType%22:1,%22tintColor%22:%22violet%22,%22actionDescription%22:%22Parses%20a%20note%20for%20lines%20beginning%20with%20a%20dash.%20Makes%20those%20into%20OmniFocus%20tasks,%20and%20includes%20a%20link%20back%20to%20the%20Draft%20in%20the%20note%20field%20of%20the%20tasks.%20%5Cn%5CnProps%20to%20@RegularCraig%20for%20the%20original%20code.%20%22,%22keyUseIcon%22:false,%22icon%22:%22343-scribble%22,%22visibility%22:480,%22backingIsSeparator%22:false,%22groupUUID%22:%22CC8CE599-5253-472F-AF96-80CA35F2D759%22,%22assignTags%22:[],%22name%22:%224c.%20Decision%20log%20tasks%20with%20link-back%22%7D,%7B%22uuid%22:%22D41BD37A-73F3-45F9-A20D-0FAE8D4771C5%22,%22steps%22:[],%22backingPlatforms%22:3,%22shortName%22:%22%22,%22shouldConfirm%22:false,%22disposition%22:3,%22keyCommand%22:%7B%22optionKey%22:false,%22input%22:%22%22,%22controlKey%22:false,%22commandKey%22:false,%22type%22:%22empty%22,%22discoverabilityTitle%22:%22Invalid%22,%22shiftKey%22:false%7D,%22logLevel%22:2,%22groupDisposition%22:0,%22notificationType%22:2,%22tintColor%22:%22none%22,%22actionDescription%22:%22%22,%22keyUseIcon%22:false,%22icon%22:%22%22,%22visibility%22:480,%22backingIsSeparator%22:true,%22groupUUID%22:%22CC8CE599-5253-472F-AF96-80CA35F2D759%22,%22assignTags%22:[],%22name%22:%22%F0%9F%97%82%20Archive%22%7D,%7B%22uuid%22:%22D80AAEF5-C3E5-4E16-98E6-72CE13122A68%22,%22steps%22:[%7B%22platforms%22:3,%22data%22:%7B%22template%22:%22x-devonthink://createmarkdown?title=[[display_title]]%5Cu0026text=[[draft]]%5Cu0026tags=[[tags]]%22,%22useSafari%22:%22false%22,%22encodeTags%22:%22true%22%7D,%22type%22:%22url%22,%22isEnabled%22:true,%22uuid%22:%22E79AAD8F-DE09-4269-878B-B6E4F1EA4FAD%22%7D],%22backingPlatforms%22:3,%22shortName%22:%22%22,%22shouldConfirm%22:false,%22disposition%22:3,%22keyCommand%22:%7B%22optionKey%22:false,%22input%22:%22%22,%22controlKey%22:false,%22commandKey%22:false,%22type%22:%22action%22,%22discoverabilityTitle%22:%225a.%20Send%20to%20DEVONthink%22,%22shiftKey%22:false%7D,%22logLevel%22:2,%22groupDisposition%22:0,%22notificationType%22:2,%22tintColor%22:%22indigo%22,%22actionDescription%22:%22Send%20draft%20to%20DEVONthink%20as%20new%20entry.%22,%22keyUseIcon%22:false,%22icon%22:%22notebook%22,%22visibility%22:480,%22backingIsSeparator%22:false,%22groupUUID%22:%22CC8CE599-5253-472F-AF96-80CA35F2D759%22,%22assignTags%22:[],%22name%22:%225a.%20Send%20to%20DEVONthink%22%7D,%7B%22uuid%22:%2258897A83-2CF3-424A-B712-5A01DF3C6175%22,%22steps%22:[%7B%22platforms%22:3,%22data%22:%7B%22script%22:%22//%20Drafts%20-%20Archive%5Cn//%20move%20draft%20between%20Archive%20and%20Inbox%5Cndraft.isArchived%20=%20!draft.isArchived;%5Cndraft.update();%5Cnapp.displayInfoMessage(draft.isArchived%5Cn%5Ct?%20%5C%22Moved%20to%20Archive%5C%22%20%5Cn%5Ct:%20%5C%22Moved%20to%20Inbox%5C%22);%22%7D,%22type%22:%22script%22,%22isEnabled%22:true,%22uuid%22:%22771936C8-BA78-49DD-AA2A-84212B1080AE%22%7D],%22backingPlatforms%22:3,%22shortName%22:%22%22,%22shouldConfirm%22:false,%22disposition%22:0,%22keyCommand%22:%7B%22optionKey%22:false,%22input%22:%22%22,%22controlKey%22:false,%22commandKey%22:true,%22type%22:%22action%22,%22discoverabilityTitle%22:%225b.%20Archive%20Draft%22,%22shiftKey%22:false%7D,%22logLevel%22:1,%22groupDisposition%22:0,%22notificationType%22:1,%22tintColor%22:%22violet%22,%22actionDescription%22:%22Move%20draft%20between%20Archive%20and%20Inbox%22,%22keyUseIcon%22:true,%22icon%22:%22archive-download%22,%22visibility%22:480,%22backingIsSeparator%22:false,%22groupUUID%22:%22CC8CE599-5253-472F-AF96-80CA35F2D759%22,%22assignTags%22:[],%22name%22:%225b.%20Archive%20Draft%22%7D],%22modifiedAt%22:545907207.73465,%22disposition%22:0,%22uuid%22:%22CC8CE599-5253-472F-AF96-80CA35F2D759%22,%22visibility%22:480,%22createdAt%22:545907207.73465,%22icon%22:%22journal-pencil%22,%22changeTag%22:%22374k%22%7D">Install</a>
</div>

<hr style="margin: 1em 0;"/>
<h4>Included Actions</h4>
<ul class='action-group'>
  	<li class='separator'>
  		<div class='list_content'>
  			 Preparation for a meeting
  		</div>
  	</li>
  	<li>
  		<div class='list_content'>
  			0a. Workspace selection
  		</div>
  	</li>
  	<li>
  		<div class='list_content'>
  			0b. Prepare meeting notes in Drafts
  		</div>
  	</li>
  	<li>
  		<div class='list_content'>
  			0c. New Note from Template
  		</div>
  	</li>
  	<li>
  		<div class='list_content'>
  			0c. Meeting cheat sheet person
  		</div>
  	</li>
  	<li>
  		<div class='list_content'>
  			0d. Meeting cheat sheet project
  		</div>
  	</li>
  	<li class='separator'>
  		<div class='list_content'>
  			 Linking to TOC and projects
  		</div>
  	</li>
  	<li>
  		<div class='list_content'>
  			1a. Table of Contents
  		</div>
  	</li>
  	<li>
  		<div class='list_content'>
  			1b. Insert Link to Draft
  		</div>
  	</li>
  	<li>
  		<div class='list_content'>
  			1c. Back Links
  		</div>
  	</li>
  	<li class='separator'>
  		<div class='list_content'>
  			 Neatness
  		</div>
  	</li>
  	<li>
  		<div class='list_content'>
  			2a. Make Markdown Line Breaks
  		</div>
  	</li>
  	<li>
  		<div class='list_content'>
  			2b. Markdown Preview-Swiss
  		</div>
  	</li>
  	<li class='separator'>
  		<div class='list_content'>
  			 Distribute notes
  		</div>
  	</li>
  	<li>
  		<div class='list_content'>
  			3a. Mail to PA for processing
  		</div>
  	</li>
  	<li>
  		<div class='list_content'>
  			3b. Mail meeting minutes
  		</div>
  	</li>
  	<li>
  		<div class='list_content'>
  			3c. Notes on ON
  		</div>
  	</li>
  	<li>
  		<div class='list_content'>
  			3d. Print/PDF export
  		</div>
  	</li>
  	<li class='separator'>
  		<div class='list_content'>
  			 Tasks &amp; Decisions
  		</div>
  	</li>
  	<li>
  		<div class='list_content'>
  			4a. OmniFocus tasks with link-back
  		</div>
  	</li>
  	<li>
  		<div class='list_content'>
  			4b1. Planner SL - General
  		</div>
  	</li>
  	<li>
  		<div class='list_content'>
  			4b2. Planner SL - HRM
  		</div>
  	</li>
  	<li>
  		<div class='list_content'>
  			4c. Decision log tasks with link-back
  		</div>
  	</li>
  	<li class='separator'>
  		<div class='list_content'>
  			 Archive
  		</div>
  	</li>
  	<li>
  		<div class='list_content'>
  			5a. Send to DEVONthink
  		</div>
  	</li>
  	<li>
  		<div class='list_content'>
  			5b. Archive Draft
  		</div>
  	</li>
</ul>

<div class="disclaimer">
  Items available in the Drafts Directory are uploaded by community members. Use appropriate caution reviewing downloaded items before use.
</div>


                  </div>
                  <div class="footer-content">
                  <p>
                  <a href="https://itunes.apple.com/app/id1236254471?ls=1&mt=8&at=11l4Cf&ct=site">
                    <img alt="Download on App Store" src="../assets/appstore-deaf597bd57239c5054c59099e54ab9014f1e15eddb961085428e0ce94d4385b.svg" />
                  </a>
                  <a href="https://itunes.apple.com/app/id1435957248?mt=12&at=11l4Cf&ct=site">
                    <img alt="Download on Mac App Store" src="../assets/macappstore-05f5eed00e6bb26b68c1368217276158329862682e6d61b3ed193f819fe02f2f.svg" />
                  </a>
                  </p>
                    &copy; 2012-2022 by Agile Tortoise, Inc.<br/>
                    Drafts is a registered Trademark of Agile Tortoise, Inc.<br/>
                    <a href="../../getdrafts.com/support/privacy.html">Privacy</a> | <a href="../../getdrafts.com/support/terms.html">Terms</a>
                </div>
                </div>
            </div>
        </div>
    </div>

  </body>
  </html>
