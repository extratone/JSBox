<!DOCTYPE html>
<html lang='en'>
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <title>time tracking | Drafts Directory</title>
    <meta name="csrf-param" content="authenticity_token" />
<meta name="csrf-token" content="2srcnEkEnk2UojZA8OMWUfTlNVyH3b8MddOz8YxnC82p1foWLW85qBvyjRCkoE1PU0brp3kN9apYouGIpZ+VPw==" />
    <meta http-equiv="content-type" content="text/html;charset=utf-8">
    <meta http-equiv="content-language" content="en">
    <meta http-equiv="content-language" content="en-us">
    
    <meta name="viewport" content="width=device-width, initial-scale=1">
    
    <meta property="og:title" content="Drafts Directory: time tracking" />
    <meta property="og:url" content="https://actions.getdrafts.com/g/144" />
    <meta property="og:type" content="website" />
    <meta property="og:description" content="Example actions and other extensions for Drafts, the quick-capture notes app." />
    <meta property="og:image" content="https://actions.getdrafts.com/assets/drafts-ogimage-action-d9c60102fd45e0cb516e1b49ed50a81e3c3a2b90f81f55df8f43d0feb0512978.png" />
    <meta property="twitter:title" content="Drafts Directory: time tracking" />
    <meta property="twitter:url" content="https://actions.getdrafts.com/g/144" />
    <meta property="twitter:type" content="website" />
    <meta property="twitter:description" content="Example actions and other extensions for Drafts, the quick-capture notes app." />
    <meta property="twitter:image" content="https://actions.getdrafts.com/assets/drafts-ogimage-action-d9c60102fd45e0cb516e1b49ed50a81e3c3a2b90f81f55df8f43d0feb0512978.png" />

    <link rel="shortcut icon" type="image/x-icon" href="../assets/favicon-114dbb66b0ef0399a14fa5dfcad7e6210bb558c30cea665e04d49b59fec87f70.png" />

    <link rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.4.0/styles/default.min.css">
    <link rel="stylesheet" media="all" href="../assets/application-6e4f014b4c48cd673942dbfbbeb3e571a732b05562ddde5904f3a5c3833e54ff.css" />
    <script src="../assets/application-13492939cb10be5be76b5abb3e9ae0bef0bbae3202cec2b85cf6fca5bc8429c8.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.4.0/highlight.min.js"></script>
    <script>hljs.highlightAll();</script>
    <script async defer data-domain="directory.getdrafts.com" src="https://plausible.io/js/plausible.js"></script>
  </head>

<body data-no-turbolink>

    <div class="page-wrap">
        <div class="side-bar">
            <a href="../index.html" class="site-title fs-6 lh-tight" title="{{ site.title }}">
                <img src="../assets/drafts-directory-header-4d826bd007f515c8e5a10f654e56ad76fbb3bd3103a67ce342283f701f1677fe.svg" alt="Drafts Directory" style="max-height: 30px;" />
            </a>
            <span class="fs-3"><button class="js-main-nav-trigger navigation-list-toggle btn btn-outline" type="button"
                    data-text-toggle="Hide">Menu</button></span>
            <div class="navigation main-nav js-main-nav">
              <ul class="navigation-list">
                <li class="navigation-list-item">
                  <a class="navigation-list-link" href="../index.html">Home</a>
                </li>
                <li class="navigation-list-item">
                  <a class="navigation-list-link" href="../drafts_actions.html">Actions</a>
                </li>
                <li class="navigation-list-item">
                  <a class="navigation-list-link" href="../drafts_action_groups.html">Action Groups</a>
                </li>
                <li class="navigation-list-item">
                  <a class="navigation-list-link" href="../syntax_definitions.html">Syntaxes</a>
                </li>
                <li class="navigation-list-item">
                  <a class="navigation-list-link" href="../theme_definitions.html">Themes</a>
                </li>
                <li class="navigation-list-item">
                  <a class="navigation-list-link" href="../workspaces.html">Workspaces</a>
                </li>
                <li class="navigation-list-item">
                  <hr style="margin:1em; padding: 0;" />
                </li>
                <li class="navigation-list-item">
                  <a class="navigation-list-link" href="../search.html">Search</a>
                </li>
                <li class="navigation-list-item">
                  <hr style="margin:1em; padding: 0;" />
                </li>
                <li class="navigation-list-item">
                    <a class="navigation-list-link nav-external" title="About Drafts" href="../../getdrafts.com/index.html">Get Drafts &#x2192;</a>
                </li>
                <li class="navigation-list-item">
                    <a class="navigation-list-link nav-external" title="Detailed documentation" href="../../docs.getdrafts.com/index.html">User Guide &#x2192;</a>
                </li>
                <li class="navigation-list-item">
                    <a class="navigation-list-link nav-external" title="Get your questions answered in the forums" href="https://forums.getdrafts.com/">Community &#x2192;</a>
                </li>
                <li class="navigation-list-item">
                    <a class="navigation-list-link nav-external" title="Online tools and generators" href="../../tools.getdrafts.com/index.html">Tools &#x2192;</a>
                </li>
                <li class="navigation-list-item">
                    <a class="navigation-list-link nav-external" title="Scripting library reference" href="../../scripting.getdrafts.com/index.html">Script Reference &#x2192;</a>
                </li>
              </ul>
            </div>
            <footer role="contentinfo" class="site-footer">
                <p class="text-small text-grey-dk-000 mb-0">
                    Download: <a href="https://itunes.apple.com/app/id1236254471?ls=1&mt=8&at=11l4Cf&ct=site">iOS</a> | <a href="https://itunes.apple.com/app/id1435957248?mt=12&at=11l4Cf&ct=site">Mac</a>
                </p>
            </footer>
        </div>
        <div class="main-content-wrap js-main-content" tabindex="0">
            <div class="page-header">
                <div class="main-content">
                    <div class="search js-search">
	<div class="search-input-wrap">
<form class="search-form" action="../search.html" accept-charset="UTF-8" method="get"><input name="utf8" type="hidden" value="&#x2713;" />
	<button style='border:none;background-color:transparent;'>
	<svg width="14" height="14" viewBox="0 0 28 28" xmlns="http://www.w3.org/2000/svg"
		class="search-icon">
		<title>Search</title>
		<g fill-rule="nonzero">
			<path
				d="M17.332 20.735c-5.537 0-10-4.6-10-10.247 0-5.646 4.463-10.247 10-10.247 5.536 0 10 4.601 10 10.247s-4.464 10.247-10 10.247zm0-4c3.3 0 6-2.783 6-6.247 0-3.463-2.7-6.247-6-6.247s-6 2.784-6 6.247c0 3.464 2.7 6.247 6 6.247z" />
			<path d="M11.672 13.791L.192 25.271 3.02 28.1 14.5 16.62z" />
		</g>
	</svg>
	</button>
	<input type="text" name="q" id="q" class="js-search-input search-input search" size="12" tabindex="0" placeholder="Search" />
</form>	</div>
</div>
                    <ul class="list-style-none text-small mt-md-1 mb-md-1 pb-4 pb-md-0 js-aux-nav aux-nav">
                        <li class="d-inline-block my-0 mr-2">
                          <a href="../../getdrafts.com/index.html">Get Drafts</a>
                        </li>
                        <li class="d-inline-block my-0">
                          <a href="https://forums.getdrafts.com">Community</a>
                        </li>
                    </ul>
                </div>
            </div>
            <div class="main-content">
                <div id="main-content" class="page-content" role="main">
                  <div class="type">
                    <h4>Action Group</h4>
                  </div>
                  <div class="header">
                      <h1><img src="https://config.agiletortoise.com/drafts-icons/stopwatch.png" class="action-icon" />time tracking</h1>
                  </div>

                  <div class="content">
                    
<div class='caption'>
  Posted by @ciaran on Micro.blog or @cpaconnelly on Twitter,
Last update about 2 years ago
</div>


<div class='description'>
	<p>A collection of actions that I use to track my time using plain text and Drafts. Learn about how to use them on my blog at ciaranconnelly.com</p>

<p>2020-02-27 minor update to the process timeslip action: time entries are consolidated based on client names, rather than client numbers. This allows the action to still work even if the user decides not to use client numbers.</p>

</div>

<div class="certification">
  
  
</div>

<div>
  <a class="btn btn-blue" href="drafts5://actionGroup?identifier=144&amp;data=%7B%22name%22:%22time%20tracking%22,%22hidden%22:false,%22tintColor%22:%22blue%22,%22actions%22:[%7B%22uuid%22:%22E25E0324-8FA9-4B1F-B60F-2F191E481D60%22,%22steps%22:[%7B%22platforms%22:3,%22data%22:%7B%22script%22:%22const%20now%20=%20new%20Date();%5Cnvar%20dd%20=%20now.getDate();%5Cnvar%20mm%20=%20now.getMonth()+1;%5Cnconst%20yyyy%20=%20now.getFullYear();%5Cnconst%20dayIndex%20=%20now.getDay();%5Cnconst%20week%20=%20[&#39;sunday&#39;,&#39;monday&#39;,&#39;tuesday&#39;,&#39;wednesday&#39;,&#39;thursday&#39;,&#39;friday&#39;,&#39;saturday&#39;];%5Cnconst%20day%20=%20week[dayIndex];%5Cn%5Cnif%20(dd%20%5Cu003c%2010)%20%7B%5Cn%20%20%20%20dd%20=%20&#39;0&#39;%20+%20dd;%5Cn%7D%20%5Cn%5Cnif%20(mm%20%5Cu003c%2010)%20%7B%5Cn%20%20%20%20mm%20=%20&#39;0&#39;%20+%20mm;%5Cn%7D%20%5Cn%5Cnconst%20today%20=%20yyyy+&#39;-&#39;+mm+&#39;-&#39;+dd+&#39;%20&#39;+day+&#39;%20&#39;;%5Cnlet%20selRange%20=%20editor.getSelectedRange();%5Cn%5Cneditor.setSelectedText(today);%5Cneditor.setSelectedRange(selRange[0]+today.length,0);%5Cn%22%7D,%22type%22:%22script%22,%22isEnabled%22:true,%22uuid%22:%226B91F211-9167-40AA-B5D0-824FAE94D283%22%7D],%22backingPlatforms%22:3,%22shortName%22:%22%22,%22shouldConfirm%22:false,%22disposition%22:3,%22keyCommand%22:%7B%22optionKey%22:false,%22input%22:%22%22,%22controlKey%22:false,%22commandKey%22:false,%22type%22:%22action%22,%22discoverabilityTitle%22:%22insert%20date%22,%22shiftKey%22:false%7D,%22logLevel%22:1,%22groupDisposition%22:0,%22notificationType%22:1,%22tintColor%22:%22none%22,%22actionDescription%22:%22Inserts%20today&#39;s%20date%20in%20following%20format:%5Cn%5CnYYYY-MM-DD%20someday%20%22,%22keyUseIcon%22:true,%22icon%22:%22563-calendar%22,%22visibility%22:480,%22backingIsSeparator%22:false,%22groupUUID%22:%22F2124A6B-C1E9-4935-9CC6-E025451D3123%22,%22assignTags%22:[],%22name%22:%22insert%20date%22%7D,%7B%22uuid%22:%2234C113A2-FB20-4C3E-8F5C-31A537EAE6FB%22,%22steps%22:[%7B%22platforms%22:3,%22data%22:%7B%22script%22:%22//%20inserts%20current%20time%20rounded%20up%20or%20down%20to%20the%20closest%206%20minute%20interval%5Cn%5Cn%5Cn//%20basic%20info%5Cnconst%20currentTime%20=%20new%20Date();%5Cnvar%20hours%20=%20currentTime.getHours();%5Cnconst%20minutes%20=%20currentTime.getMinutes();%5Cn%5Cn%5Cn//%20round%20to%206%20minutes%5Cnvar%20minutesRounded%20=%206%20*%20Math.round(minutes/6);%20%5Cn%5Cn%5Cn//%20handle%20cases%20when%20minutes%20round%20to%2060,%20and%20when%20hours%20increment%20to%2024%5Cnif%20(minutesRounded%20==%2060)%20%7B%5Cn%5CtminutesRounded%20=%200;%5Cn%5Cthours++;%5Cn%7D%5Cnif%20(hours%20==%2024)%20%7Bhours%20=%200%7D;%5Cn%5Cn%5Cn//%20add%20leading%20zeros%5Cnif%20(hours%20%5Cu003c%2010)%20%7Bhours%20=%20&#39;0&#39;%20+%20hours%7D;%5Cnif%20(minutesRounded%20%5Cu003c%2010)%20%7BminutesRounded%20=%20&#39;0&#39;%20+%20minutesRounded%7D;%5Cn%5Cn%5Cn//%20assemble%20string%20and%20put%20it%20in%20the%20draft%5Cnconst%20time%20=%20hours%20+%20%5C%22:%5C%22%20+%20minutesRounded%20+%20&#39;%20&#39;;%5Cnlet%20selRange%20=%20editor.getSelectedRange();%5Cneditor.setSelectedText(time);%5Cneditor.setSelectedRange(selRange[0]%20+%20time.length,%200);%5Cneditor.focus();%22%7D,%22type%22:%22script%22,%22isEnabled%22:true,%22uuid%22:%220D93A11F-16AD-40EC-B61B-FD8AAF6B6094%22%7D],%22backingPlatforms%22:3,%22shortName%22:%22%22,%22shouldConfirm%22:false,%22disposition%22:0,%22keyCommand%22:%7B%22optionKey%22:false,%22input%22:%22%22,%22controlKey%22:false,%22commandKey%22:false,%22type%22:%22action%22,%22discoverabilityTitle%22:%22insert%20time%22,%22shiftKey%22:false%7D,%22logLevel%22:1,%22groupDisposition%22:0,%22notificationType%22:1,%22tintColor%22:%22none%22,%22actionDescription%22:%22inserts%20current%20time%20rounded%20to%20nearest%20tenth%20of%20an%20hour%22,%22keyUseIcon%22:true,%22icon%22:%22596-wristwatch%22,%22visibility%22:480,%22backingIsSeparator%22:false,%22groupUUID%22:%22F2124A6B-C1E9-4935-9CC6-E025451D3123%22,%22assignTags%22:[],%22name%22:%22insert%20time%22%7D,%7B%22uuid%22:%22DB405C7B-D5D2-4C81-A933-01AEE85CB7BC%22,%22steps%22:[%7B%22platforms%22:3,%22data%22:%7B%22script%22:%22//%20how%20to%20start%20a%20workday,%20perhaps%20called%20via%20Workflow%20%5Cn%5Cn%5Cn//%20function%20to%20round%20hour%20and%20time%20to%20the%20nearest%206%20minute%20increment%5Cnfunction%20roundTime(date)%20%7B%5Cn%5Ctvar%20hours%20=%20date.getHours();%5Cn%5Ctvar%20minutes%20=%20date.getMinutes();%5Cn%5Cn%5Cn%5Ct//%20round%20to%206%20minutes%5Cn%5Ctvar%20minutesRounded%20=%206%20*%20Math.round(minutes/6);%20%5Cn%5Cn%5Cn%5Ct//%20handle%20cases%20when%20minutes%20round%20to%2060,%20and%20when%20hours%20increment%20to%2024%5Cn%5Ctif%20(minutesRounded%20==%2060)%20%7B%5Cn%5Ct%5CtminutesRounded%20=%200;%5Cn%5Ct%5Cthours++;%5Cn%5Ct%7D%5Cn%5Ctif%20(hours%20==%2024)%20%7Bhours%20=%200%7D;%5Cn%5Cn%5Ct//%20add%20leading%20zeros%5Cn%5Ctif%20(hours%20%5Cu003c%2010)%20%7Bhours%20=%20&#39;0&#39;%20+%20hours%7D;%5Cn%5Ctif%20(minutesRounded%20%5Cu003c%2010)%20%7BminutesRounded%20=%20&#39;0&#39;%20+%20minutesRounded%7D;%5Cn%5Cn%5Ct//%20assemble%20string%20and%20put%20it%20in%20the%20draft%5Cn%5Ctreturn%20hours%20+%20%5C%22:%5C%22%20+%20minutesRounded%20+%20&#39;%20&#39;;%5Cn%7D%5Cn%5Cn%5Cn%5Cn//%20create%20a%20new%20draft%20with%20the%20desired%20content%5Cnconst%20now%20=%20new%20Date();%5Cnvar%20d%20=%20Draft.create();%5Cnd.content%20=%20strftime(now,%20&#39;%25Y-%25m-%25d%20%25A&#39;).toLowerCase()%20+%20&#39;%5C%5Cn%5C%5Cn&#39;%20+%20roundTime(now);%5Cn//d.content%20=%20d.content.toLowerCase();%5Cnd.addTag(&#39;time&#39;);%5Cnd.update();%20%5Cneditor.load(d);%5Cn%22,%22allowAsync%22:%22false%22%7D,%22type%22:%22script%22,%22isEnabled%22:true,%22uuid%22:%22698D2179-F25B-4EE4-926A-C0A35A367451%22%7D],%22backingPlatforms%22:3,%22shortName%22:%22%22,%22shouldConfirm%22:false,%22disposition%22:0,%22keyCommand%22:%7B%22optionKey%22:false,%22input%22:%22%22,%22controlKey%22:false,%22commandKey%22:false,%22type%22:%22action%22,%22discoverabilityTitle%22:%22start%20timeslip%22,%22shiftKey%22:false%7D,%22logLevel%22:2,%22groupDisposition%22:0,%22notificationType%22:2,%22tintColor%22:%22none%22,%22actionDescription%22:%22To%20be%20used%20at%20the%20start%20of%20a%20day%20with%20work:%5Cn%5CnJust%20does%20the%20date,%20time,%20and%20adds%20a%20%E2%80%9Ctime%E2%80%9D%20tag%22,%22keyUseIcon%22:true,%22icon%22:%22hourglass%22,%22visibility%22:480,%22backingIsSeparator%22:false,%22groupUUID%22:%22F2124A6B-C1E9-4935-9CC6-E025451D3123%22,%22assignTags%22:[],%22name%22:%22start%20timeslip%22%7D,%7B%22uuid%22:%2203221276-DE63-424B-B22A-5A2B3495B6F6%22,%22steps%22:[%7B%22platforms%22:3,%22data%22:%7B%22name%22:%22getClient%22%7D,%22type%22:%22includeAction%22,%22isEnabled%22:true,%22uuid%22:%22F8EB0D74-4E91-41D8-9466-98D305FA5936%22%7D,%7B%22platforms%22:3,%22data%22:%7B%22script%22:%22//%20quick%20action%20to%20get%20billing%20number%20for%20a%20client%5Cn//%20takes%20highlighted%20text%20if%20any,%20or%20prompts%20if%20none%5Cn%5Cnvar%20c%20=%20%5C%22%5C%22;%5Cnlet%20sel%20=%20editor.getSelectedText();%5Cn%5Cnif%20(!sel%20%7C%7C%20sel.length%20==%200)%20%7B%5Cn%5Ctlet%20p%20=%20Prompt.create();%5Cn%5Ctp.title%20=%20%5C%22Client%20Lookup%5C%22;%5Cn%5Ctp.message%20=%20%5C%22enter%20client%20name%5C%22;%5Cn%5Ctp.addTextField(%5C%22client%5C%22,%20%5C%22Client%5C%22,%20%5C%22%5C%22,%20%7BwantsFocus:true%7D);%5Cn%5Ctp.addButton(%5C%22Lookup%5C%22);%5Cn%5Ctp.show();%5Cn%5Ctc%20=%20p.fieldValues[%5C%22client%5C%22];%5Cn%7D%20else%20%7B%5Cn%5Ctc%20=%20sel;%5Cn%7D%5Cn%5Cnlet%20info%20=%20getClient(c);%5Cn%5Cnif%20(!info)%20%7B%5Cn%5Ctcontext.cancel();%5Cn%7D%20else%20%7B%5Cn%5Ctapp.setClipboard(info.name%20+%20%5C%22%20(%5C%22%20+%20info.number%20+%5C%22)%5C%22);%5Cn%5Ctalert(%5C%22Client%20Name:%20%5C%22%20+%20info.name%20+%20%5C%22%5C%5CnClient%20Number:%20%5C%22%20+%20info.number);%5Cn%7D%22,%22allowAsync%22:%22false%22%7D,%22type%22:%22script%22,%22isEnabled%22:true,%22uuid%22:%228D4AE6F0-FA43-43EA-B2E0-72E9925C3466%22%7D],%22backingPlatforms%22:3,%22shortName%22:%22%22,%22shouldConfirm%22:false,%22disposition%22:0,%22keyCommand%22:%7B%22optionKey%22:false,%22input%22:%22%22,%22controlKey%22:false,%22commandKey%22:false,%22type%22:%22action%22,%22discoverabilityTitle%22:%22get%20client%20number%22,%22shiftKey%22:false%7D,%22logLevel%22:2,%22groupDisposition%22:0,%22notificationType%22:0,%22tintColor%22:%22violet%22,%22actionDescription%22:%22Looks%20up%20client%20number%20of%20selected%20text,%20or%20prompts%20if%20no%20selection%5CnDisplays%20an%20alert%20with%20client-matter%20number%20and%20sets%20the%20clipboard%20contents%20to%20the%20number%22,%22keyUseIcon%22:true,%22icon%22:%22badge-ID%22,%22visibility%22:480,%22backingIsSeparator%22:false,%22groupUUID%22:%22F2124A6B-C1E9-4935-9CC6-E025451D3123%22,%22assignTags%22:[],%22name%22:%22get%20client%20number%22%7D,%7B%22uuid%22:%224CBEC62F-B402-47CD-9F6F-BFB408D4E39C%22,%22steps%22:[%7B%22platforms%22:3,%22data%22:%7B%22name%22:%22dumbify%22%7D,%22type%22:%22includeAction%22,%22isEnabled%22:true,%22uuid%22:%22A4901A69-BCB4-498D-A863-0971887235E7%22%7D,%7B%22platforms%22:3,%22data%22:%7B%22name%22:%22getClient%22%7D,%22type%22:%22includeAction%22,%22isEnabled%22:true,%22uuid%22:%22CCBC5625-62D4-439B-8AE5-49798D57ED39%22%7D,%7B%22platforms%22:3,%22data%22:%7B%22script%22:%22//%20take%20timeslip%20and%20create:%5Cn//%20content%20and%20subject%20of%20email%20to%20assistant%5Cn//%20addition%20to%20pipe(%7C)-delimited%20files%20in%20iCloud%20%5Cu0026%20Dropbox%5Cn//%20addition%20to%20csv%20file%20in%20OneDrive%5Cn%5Cn%5Cn%5Cn//%20function%20to%20calculate%20durations%20from%20time-based%20strings%5Cnfunction%20duration(start,%20end)%20%7B%5Cn%5Ctvar%20h1%20=%20start.slice(0,2);%5Cn%5Ctvar%20h2%20=%20end.slice(0,2);%5Cn%5Ctvar%20hours%20=%20h2%20-%20h1;%5Cn%5Ctvar%20m1%20=%20start.slice(3);%5Cn%5Ctvar%20m2%20=%20end.slice(3);%5Cn%5Ctvar%20tenths%20=%20(m2%20-%20m1)/60;%5Cn%5Ctvar%20totalTime%20=%20hours%20+%20tenths;%5Cn%5Ctreturn%20totalTime.toFixed(1);%5Cn%7D%5Cn%5Cn%5Cn%5Cn//%20function%20to%20combine%20entries%20if%20they%20have%20the%20same%20client%20and%20project%5Cnfunction%20combineEntriesForCSV%20(dictList)%20%7B%5Cn%5Ctlet%20result%20=%20[];%5Cn%5Ctresult[0]%20=%20dictList[0];%5Cn%5Ctfor%20(i%20=%201;%20i%20%5Cu003c%20dictList.length;%20i++)%20%7B%5Ct%5Ctlet%20matched%20=%20false;%5Cn%5Ct%5Ctfor%20(e%20in%20result)%20%7B%5Cn%5Ct%5Ct%5Ctif%20(result[e].client%20==%20dictList[i].client%20%5Cu0026%5Cu0026%20result[e].project%20==%20dictList[i].project)%20%7B%5Cn%5Ct%5Ct%5Ct%5Ctresult[e].duration%20=%20Number(result[e].duration)%20+%20Number(dictList[i].duration);%5Cn%5Ct%5Ct%5Ct%5Ctresult[e].duration%20=%20result[e].duration.toFixed(1);%5Cn%5Ct%5Ct%5Ct%5Ctresult[e].note%20+=%20%5C%22%20%5C%22%20+%20dictList[i].note;%5Cn%5Ct%5Ct%5Ct%5Ctmatched%20=%20true;%5Cn%5Ct%5Ct%5Ct%5Ctbreak;%5Cn%5Ct%5Ct%5Ct%7D%5Cn%5Ct%5Ct%7D%5Cn%5Ct%5Ctif%20(!matched)%20%7B%5Cn%5Ct%5Ct%5Ctresult.push(dictList[i]);%5Cn%5Ct%5Ct%7D%5Cn%5Ct%7D%5Cn%5Ctreturn%20result;%5Cn%7D%5Cn%5Cn%5Cn%5Cn//%20function%20to%20combine%20entries%20if%20they%20have%20the%20same%20client%5Cnfunction%20combineEntriesForEmail%20(dictList)%20%7B%5Cn%5Ctlet%20result%20=%20[];%5Cn%5Ctresult[0]%20=%20dictList[0];%5Cn%5Ctfor%20(i%20=%201;%20i%20%5Cu003c%20dictList.length;%20i++)%20%7B%5Cn%5Ct%5Ctlet%20matched%20=%20false;%5Cn%5Ct%5Ctfor%20(e%20in%20result)%20%7B%5Cn%5Ct%5Ct%5Ctif%20(result[e].client%20==%20dictList[i].client)%20%7B%5Cn%5Ct%5Ct%5Ct%5Ctresult[e].duration%20=%20Number(result[e].duration)%20+%20Number(dictList[i].duration);%5Cn%5Ct%5Ct%5Ct%5Ctresult[e].duration%20=%20result[e].duration.toFixed(1);%5Cn%5Ct%5Ct%5Ct%5Ctresult[e].note%20+=%20%5C%22%20%5C%22%20+%20dictList[i].note;%5Cn%5Ct%5Ct%5Ct%5Ctmatched%20=%20true;%5Cn%5Ct%5Ct%5Ct%5Ctbreak;%5Cn%5Ct%5Ct%5Ct%7D%5Cn%5Ct%5Ct%7D%5Cn%5Ct%5Ctif%20(!matched)%20%7B%5Cn%5Ct%5Ct%5Ctresult.push(dictList[i]);%5Cn%5Ct%5Ct%7D%5Cn%5Ct%7D%5Cn%5Ctreturn%20result;%5Cn%7D%5Cn%5Cn%5Cn%5Cn//%20-------------%5Cn//%20now%20process%20the%20timeslip:%5Cn//%20-------------%5Cn%5Cn%5Cn%5Cn//%20get%20content%20and%20remove%20double-quotes,%20if%20any%5Cnconst%20timeslip%20=%20editor.getText().replace(&#39;%5C%22&#39;,%20%5C%22&#39;%5C%22);%5Cn%5Cn//%20grab%20the%20date%5Cnconst%20date%20=%20timeslip.match(/%5E%5C%5Cd%5C%5Cd%5C%5Cd%5C%5Cd-%5C%5Cd%5C%5Cd-%5C%5Cd%5C%5Cd/g);%5Cn%5Cn//%20grab%20the%20times:%5Cnconst%20times%20=%20timeslip.match(/%5E%5C%5Cd%5C%5Cd%5C%5C:%5C%5Cd%5C%5Cd/gm);%5Cn%5Cn//%20grab%20the%20lines%20with%20relevant%20data:%5Cnvar%20lines%20=%20timeslip.match(/%5E%5C%5Cd%5C%5Cd:%5C%5Cd%5C%5Cd.*%5C%5Cn?/gm);%5Cnlines.pop();%20//%20remove%20the%20final%20line%20that%20just%20contains%20the%20stop%20time%5Cn%5Cn//%20compile%20everything%20into%20useful%20list%20of%20objects%5Cnvar%20entries%20=%20[];%5Cnfor%20(i%20=%200;%20i%20%5Cu003c%20lines.length;%20i++)%20%7B%5Cn%5Ctentries[i]%20=%20%7B%7D%5Cn%5Ctentries[i].date%20=%20date;%5Cn%5Ctentries[i].duration%20=%20duration(times[i],times[i+1]);%5Cn%5Ct//%20console.log(%5C%22line%20%5C%22%20+%20i%20+%20%5C%22%20=%20%5C%22%20+%20lines[i]);%5Cn%5Ctlet%20name%20=%20lines[i].match(/.+?(?=(,%7C%5C%5Cn%7C%20-%20))/g)[0].slice(6).trim();%20//%20match%20beginning%20of%20line,%20as%20few%20as%20possible,%20to%20comma,%20new%20line,%20or%20space-hyphen-space%5Cn%5Ctentries[i].client%20=%20getClient(name).name;%20//%20standardize%20the%20client%20name%5Cn%5Ct%5Cn%5Ctentries[i].project%20=%20lines[i].match(/,%20[%5C%5Cw%20]+(?=(%20%5C%5C-%20%7C%5C%5Cn))/g);%20//%20match%20from%20comma%20space%20until%20you%20either%20get%20a%20new%20line%20or%20an%20isolated%20hyphen%20%5Cn%5Ct%5Ctif%20(entries[i].project%20===%20null)%20%7B%5Cn%5Ct%5Ct%5Ctentries[i].project%20=%20&#39;&#39;;%5Cn%5Ct%5Ct%7D%20else%20%7B%5Cn%5Ct%5Ct%5Ctentries[i].project%20=%20entries[i].project[0].slice(2).toLowerCase().trim();%5Cn%5Ct%5Ct%7D%5Cn%5Ctentries[i].note%20=%20lines[i].match(/-%20.*/g);%20%20%20//%20match%20from%20hyphen%20space%20forward%5Cn%5Ct%5Ctif%20(entries[i].note%20===%20null)%20%7B%5Cn%5Ct%5Ct%5Ctentries[i].note%20=%20&#39;&#39;;%5Cn%5Ct%5Ct%7D%5Ctelse%20%7B%5Cn%5Ct%5Ct%5Ctentries[i].note%20=%20entries[i].note[0].slice(2).trim();%5Cn%5Ct%5Ct%7D%5Cn%5Ctentries[i].billable%20=%20getClient(entries[i].client).billable;%5Cn%5Ctentries[i].number%20=%20getClient(entries[i].client).number;%5Cn%7D%5Cn//%20eliminate%20non-trackable%20time%5Cnentries%20=%20entries.filter(x%20=%5Cu003e%20x.number%20!=%20%5C%220%5C%22);%5Cn//%20sort%20trackable%20time%5Cnentries%20=%20entries.sort((a,b)%20=%5Cu003e%20b.billable%20-%20a.billable);%5Cn%5Cn%5Cn%5Cn//%20------------%5Cn//%20prepare%20email%20contents%20and%20text/csv%20additions%5Cn//%20------------%5Cn%5Cn%5Cn%5Cn//%20consolidate%20entries%20for%20files%5Cnentries%20=%20combineEntriesForCSV(entries);%5Cn%5Cn%5Cn//%20build%20text%20addition%5Cnvar%20txtAddition%20=%20[];%5Cnfor%20(e%20in%20entries)%20%7B%5Cn%5CttxtAddition.push(entries[e].date%20+%20%5C%22%7C%5C%22%20+%20entries[e].duration%20+%20%5C%22%7C%5C%22%20+%20entries[e].client%20+%20%5C%22%7C%5C%22%20+%20entries[e].project%20+%20%5C%22%7C%5C%22%20+%20entries[e].note%20+%20%5C%22%7C%5C%22%20+%20entries[e].billable);%5Cn%7D%5Cn%5Cn%5Cn//%20build%20.csv%20addition%5Cnvar%20csvAddition%20=%20[];%5Cnfor%20(e%20in%20entries)%20%7B%5Cn%5CtcsvAddition.push(entries[e].date%20+%20&#39;,&#39;%20+%20entries[e].duration%20+%20&#39;,&#39;%20+%20entries[e].client%20+%20&#39;,&#39;%20+%20entries[e].project%20+%20&#39;,%5C%22&#39;%20+%20entries[e].note.replace(/%5C%22/g,&#39;%5C%22%5C%22&#39;)%20+%20&#39;%5C%22,&#39;%20+%20entries[e].billable);%5Cn%7D%5Cn%5Cn%5Cn//%20consolidate%20entries%20for%20email%20and%20build%20email%20contents%5Cnentries%20=%20combineEntriesForEmail(entries);%5Cnvar%20emailContents%20=%20&#39;&#39;;%5Cnfor%20(e%20in%20entries)%20%7B%5Cn%5CtemailContents%20+=%20entries[e].duration%20+%20%5C%22%5C%5Cn%5C%22%20+%20entries[e].client%20+%20%5C%22%20(%5C%22%20+%20entries[e].number%20+%20%5C%22)%5C%5Cn%5C%22%20+%20entries[e].note%20+%20%5C%22%5C%5Cn%5C%5Cn%5C%22%5Cn%7D%5Cn%5Cn//%20add%20a%20total%20for%20the%20day%5Cnvar%20dayTotal%20=%200;%5Cnfor%20(e%20in%20entries)%20%7B%5Cn%5CtdayTotal%20+=%20Number(entries[e].duration);%5Cn%7D%5CndayTotal%20=%20dayTotal.toFixed(1);%5CnemailContents%20+=%20%5C%22----%5C%5Cn%5C%22%20+%20dayTotal%20+%20%5C%22%20total%5C%22;%5Cn%5Cn%5Cn%5Cn//%20------------%5Cn//%20define%20tags%20to%20be%20used%20in%20later%20action%20steps%5Cn//%20------------%5Cn%5Cn%5Cndraft.setTemplateTag(&#39;slipDate&#39;,%20date);%5Cndraft.setTemplateTag(&#39;emailContents&#39;,%20emailContents);%5Cndraft.setTemplateTag(&#39;txtAddition&#39;,%20txtAddition.join(&#39;%5C%5Cn&#39;));%5Cndraft.setTemplateTag(&#39;csvAddition&#39;,%20csvAddition.join(&#39;%5C%5Cn&#39;));%5Cn%5Cn%5Cnconsole.log(csvAddition.join(&#39;%5C%5Cn&#39;)%20+%20%5C%22%5C%5Cn%5C%5Cn%5C%22);%22,%22allowAsync%22:%22false%22%7D,%22type%22:%22script%22,%22isEnabled%22:true,%22uuid%22:%22394C71C1-675B-41DF-B80D-19290D8667B8%22%7D,%7B%22platforms%22:3,%22data%22:%7B%22sendInBackground%22:%22false%22,%22ccRecipients%22:%22%22,%22toRecipients%22:%22%22,%22bccRecipients%22:%22%22,%22sendAsHTML%22:%22false%22,%22bodyTemplate%22:%22[[emailContents]]%22,%22subjectTemplate%22:%22time%20for%20[[slipDate]]%22%7D,%22type%22:%22mail%22,%22isEnabled%22:true,%22uuid%22:%2231C14036-8CEF-4483-9D7B-AEA0B3245FE7%22%7D,%7B%22platforms%22:3,%22data%22:%7B%22writeType%22:%22append%22,%22template%22:%22[[txtAddition]]%22,%22folderTemplate%22:%22/%22,%22local%22:%22false%22,%22fileNameTemplate%22:%22time.txt%22%7D,%22type%22:%22file%22,%22isEnabled%22:true,%22uuid%22:%22F1FBEE6E-6553-40D8-9BB2-5240F7AD7AEF%22%7D,%7B%22platforms%22:3,%22data%22:%7B%22writeType%22:%22append%22,%22folderTemplate%22:%22/%22,%22oauthIdentifier%22:%22%22,%22template%22:%22[[txtAddition]]%22,%22fileNameTemplate%22:%22time.txt%22%7D,%22type%22:%22dropbox%22,%22isEnabled%22:true,%22uuid%22:%22BCDC2FD4-E4D7-4F82-97F6-BCF4AF037B66%22%7D,%7B%22platforms%22:3,%22data%22:%7B%22fileNameTemplate%22:%22time.csv%22,%22folderTemplate%22:%22/%22,%22oauthIdentifier%22:%22%22,%22template%22:%22[[csvAddition]]%22,%22writeType%22:%22append%22%7D,%22type%22:%22onedrive%22,%22isEnabled%22:true,%22uuid%22:%22F4EDA537-F61D-4394-975B-B8D32D738901%22%7D],%22backingPlatforms%22:3,%22shortName%22:%22%22,%22shouldConfirm%22:false,%22disposition%22:3,%22keyCommand%22:%7B%22optionKey%22:false,%22input%22:%22%22,%22controlKey%22:false,%22commandKey%22:false,%22type%22:%22action%22,%22discoverabilityTitle%22:%22process%20timeslip%22,%22shiftKey%22:false%7D,%22logLevel%22:2,%22groupDisposition%22:0,%22notificationType%22:2,%22tintColor%22:%22red%22,%22actionDescription%22:%22%23%23%202020-02-27%20changes%5Cn%5Cnimproved%20to%20consolidate%20entries%20based%20on%20client%20name,%20rather%20than%20client%20number%20in%20case%20you%20decide%20not%20to%20use%20client%20numbers.%5Cn%5Cn%E2%80%94%E2%80%94%5Cn%5Cnprocesses%20a%20time%20slip%20creating%20an%20email%20and%20adding%20to%20a%20pair%20of%20csv%20files%20for%20record%20keeping/analysis%5Cn%5CnImproved!!%20%20more%20flexible%20format%20-%20all%20lines%20that%20don%E2%80%99t%20start%20with%20a%20time%20are%20ignored,%20so%20there%E2%80%99s%20plenty%20of%20room%20for%20comments,%20etc.%5Cn%22,%22keyUseIcon%22:false,%22icon%22:%22334-backintime2%22,%22visibility%22:480,%22backingIsSeparator%22:false,%22groupUUID%22:%22F2124A6B-C1E9-4935-9CC6-E025451D3123%22,%22assignTags%22:[%22processed%22],%22name%22:%22process%20timeslip%22%7D,%7B%22uuid%22:%22E0EA6725-EB22-491A-9567-C32B1D01B9B4%22,%22steps%22:[%7B%22platforms%22:3,%22data%22:%7B%22script%22:%22//%20script%20to%20analyze%20time%20stored%20in%20iCloud%20file%5Cn//%20and%20report%20results%20in%20web%20preview%5Cn%5Cn%5Cn%5Cn//%20set%20global%20variables%5Cn%5Cnconst%20fileName%20=%20&#39;time.txt&#39;;%20//%20file%20name%20and%20path%5Cn%5Cn%5Cn%5Cn//%20collect%20start%20and%20end%20dates%20%5Cnlet%20thisYear%20=%20[Date.january(),%20Date.december().moveToLastDayOfMonth()];%5Cnlet%20lastYear%20=%20[Date.january().addYears(-1),%20Date.december().moveToLastDayOfMonth().addYears(-1)];%5Cn%5Cnlet%20thisMonth%20=%20[Date.today().moveToFirstDayOfMonth(),%20Date.today().moveToLastDayOfMonth()];%5Cnlet%20lastMonth%20=%20[Date.today().moveToFirstDayOfMonth().addMonths(-1),%20Date.today().moveToFirstDayOfMonth().addMonths(-1).moveToLastDayOfMonth()];%5Cn%5Cnlet%20thisWeek%20=%20[Date.sunday(),%20Date.saturday()];%5Cnlet%20lastWeek%20=%20[Date.sunday().addDays(-7),%20Date.saturday().addDays(-7)];%5Cn%5Cnlet%20dates%20=%20[thisYear,lastYear,thisMonth,lastMonth,thisWeek,lastWeek];%5Cn%5Cn//%20------------%5Cn//%20useful%20functions%5Cn//%20------------%5Cn%5Cn%5Cn%5Cn//%20return%20the%20billable,%20non-billable,%20and%20total%20duration%20for%20a%20given%20set%20of%20entries%5Cnfunction%20totalTime%20(entries)%20%7B%5Cn%5Ctlet%20billable%20=%200;%5Cn%5Ctlet%20nonbillable%20=%200;%5Cn%5Ctlet%20total%20=%200;%5Cn%5Ctfor%20(e%20in%20entries)%20%7B%5Cn%5Ct%5Cttotal%20+=%20Number(entries[e].duration);%5Cn%5Ct%5Ctif%20(entries[e].billable%20==%20%5C%22true%5C%22)%20%7B%5Cn%5Ct%5Ct%5Ctbillable%20+=%20Number(entries[e].duration);%5Cn%5Ct%5Ct%7D%20else%20%7B%5Cn%5Ct%5Ct%5Ctnonbillable%20+=%20Number(entries[e].duration);%5Cn%5Ct%5Ct%7D%5Cn%5Ct%7D%5Cn%5Cttotal%20=%20total.toFixed(1);%5Cn%5Ctbillable%20=%20billable.toFixed(1);%5Cn%5Ctnonbillable%20=%20nonbillable.toFixed(1);%5Cn%5Ctreturn%20[billable,nonbillable,total];%5Cn%7D%5Cn%5Cn%5Cn%5Cn//%20function%20to%20filter%20entries%20based%20on%20dates%5Cn//%20assumes%20entries%20have%20date%20properties%20that%20are%20Dates,%20not%20strings%5Cnfunction%20dateFilter%20(entries,%20[start,%20end])%20%7B%5Cn%5Ctreturn%20entries.filter(e%20=%5Cu003e%20Date.parse(e.date)%20%5Cu003e=%20start%20%5Cu0026%5Cu0026%20Date.parse(e.date)%20%5Cu003c=%20end);%5Cn%7D%5Cn%5Cn%5Cn%5Cn//%20function%20to%20parse%20%7C-delimited%20file%20into%20JSON%5Cnfunction%20parsePipeFile%20(content)%20%7B%5Cn%5Ctlet%20entries%20=%20[];%5Cn%5Ctlet%20lines%20=%20content.split(%5C%22%5C%5Cn%5C%22);%5Cn%5Ctlet%20headers%20=%20lines[0].split(%5C%22%7C%5C%22);%5Cn%5Ctfor%20(i%20=%201;%20i%20%5Cu003c%20lines.length;%20i++)%20%7B%5Cn%5Ct%5Ctlet%20obj%20=%20%7B%7D;%5Cn%5Ct%5Ctlet%20values%20=%20lines[i].split(%5C%22%7C%5C%22);%5Cn%5Ct%5Ctlet%20pairs%20=%20[];%5Cn%5Ct%5Ctfor%20(h%20in%20headers)%20%7B%5Cn%5Ct%5Ct%5Ctobj[headers[h]]%20=%20values[h];%5Cn%5Ct%5Ct%7D%5Cn%5Ct%5Ctentries.push(obj);%5Cn%5Ct%7D%5Cn%5Ctreturn%20entries;%5Cn%7D%5Cn%5Cn%5Cn%5Cn//%20------------%5Cn//%20compile%20markdown%20to%20turn%20into%20HTML%20report%5Cn//%20------------%5Cn%5Cn%5Cn%5Cn//%20parse%20the%20txt%20file%20into%20a%20list%20of%20entries%5CnmyCloud%20=%20FileManager.createCloud();%5Cnlet%20content%20=%20myCloud.read(%5C%22/%5C%22%20+%20fileName);%5Cnlet%20entries%20=%20parsePipeFile(content);%5Cn%5Cnlet%20billableData%20=%20[&#39;billable&#39;];%5Cnlet%20nonbillableData%20=%20[&#39;admin&#39;];%5Cnlet%20totalData%20=%20[&#39;total&#39;];%5Cn%5Cnfor%20(d%20in%20dates)%20%7B%5Cn%5Ctlet%20result%20=%20totalTime(dateFilter(entries,%20dates[d]));%5Cn%5CtbillableData.push(result[0]);%5Cn%5CtnonbillableData.push(result[1]);%5Cn%5CttotalData.push(result[2]);%5Cn%7D%5Cn%5Cnlet%20report%20=%20%5C%22%23%20Time%20Report%5C%5Cn%5C%5Cn%7Cperiod%7C%5C%22%20+%20thisYear[0].toString(%5C%22yyyy%5C%22)%20+%20%5C%22%7C%5C%22%20+%20lastYear[0].toString(%5C%22yyyy%5C%22)%20+%20%5C%22%7C%5C%22%20+%20thisMonth[0].toString(%5C%22MMMM%5C%22)%20+%20%5C%22%7C%5C%22%20+%20lastMonth[0].toString(%5C%22MMMM%5C%22)%20+%20%5C%22%7Cthis%20week%7Clast%20week%7C%5C%5Cn%7C---:%7C---:%7C---:%7C---:%7C---:%7C---:%7C---:%7C%5C%5Cn%7C%5C%22%20+%20billableData.join(%5C%22%7C%5C%22)%20+%20%5C%22%7C%5C%5Cn%7C%5C%22%20+%20nonbillableData.join(%5C%22%7C%5C%22)%20+%20%5C%22%7C%5C%5Cn%7C%5C%22%20+%20totalData.join(%5C%22%7C%5C%22)%20+%20%5C%22%7C%5C%22;%5Cn%5Cn%5Cnconsole.log(report);%5Cn%5Cndraft.setTemplateTag(%5C%22report%5C%22,report);%5Cn%22,%22allowAsync%22:%22false%22%7D,%22type%22:%22script%22,%22isEnabled%22:true,%22uuid%22:%22FDF3F9E0-0499-4ABA-82C5-FB030349F122%22%7D,%7B%22platforms%22:3,%22data%22:%7B%22template%22:%22%5Cu003c!DOCTYPE%20html%5Cu003e%5Cn%5Cu003chtml%20dir=%5C%22auto%5C%22%5Cu003e%5Cn%5Cu003chead%5Cu003e%5Cn%5Cu003ctitle%5Cu003ePreview%5Cu003c/title%5Cu003e%5Cn%5Cu003cmeta%20name=%5C%22viewport%5C%22%20content=%5C%22width=device-width,%20initial-scale=1%5C%22%5Cu003e%5Cn%5Cu003cstyle%5Cu003e%5Cn@charset%20%5C%22utf-8%5C%22;%5Cn%5Cnhtml%20%7B%20%5Cn%5Ctfont-size:%20100%25;%5Cn%5Ctfont-family:%20%5C%22Concourse%20c3%20tab%5C%22,%20%5C%22Helvetica%5C%22,%20sans-serif;%5Cn%7D%5Cnbody%20%7B%5Cn%5Ctmargin:0;%5Cn%5Ctpadding:1em;%5Cn%7D%5Cn@media%20(max-device-width:%20480px)%20%7B%20%5Cn%5Cn%7D%20%5Cn@media%20(min-device-width:%20481px)%20%7B%20%5Cn%5Ctbody%20%7B%5Cn%5Ct%5Ctmargin:auto;%5Cn%5Ct%5Ctmax-width:600px;%5Cn%5Ct%7D%20%5Cn%7D%5Cn%5Cnblockquote%20%7B%5Cn%5Ctfont-style:%20italic;%5Cn%7D%5Cn%5Cncode%20%7B%5Cn%20%20%20%20border-radius:%203px;%5Cn%20%20%20%20background-color:%20%23F8F8F8;%5Cn%20%20%20%20color:%20inherit;%5Cn%7D%5Cn%5Cntable%20%7B%5Cn%20%20margin:%201em%200;%5Cn%20%20border:%201px%20solid%20%23aaa;%5Cn%20%20border-collapse:%20collapse;%5Cn%7D%5Cn%5Cnth%20%7B%5Cn%20%20padding:.25em%20.5em;%5Cn%20%20background:%20%23efefef;%5Cn%20%20border:%201px%20solid%20%23ccc;%20%20%5Cn%7D%5Cn%5Cntd%20%7B%5Cn%20%20padding:.25em%20.5em;%5Cn%20%20border:%201px%20solid%20%23ccc;%5Cn%7D%5Cn%5Cnimg%20%7B%5Cn%20%20%20%20max-width:%2090%25;%5Cn%7D%5Cn%5Cn%5Cu003c/style%5Cu003e%5Cn%5Cu003c/head%5Cu003e%5Cn%5Cu003cbody%5Cu003e%5Cn%20%20%25%25[[report]]%25%25%5Cn%5Cu003c/body%5Cu003e%5Cn%5Cu003c/html%5Cu003e%5Cn%22%7D,%22type%22:%22htmlpreview%22,%22isEnabled%22:true,%22uuid%22:%221C649434-FF9A-478E-945D-CE1B776D07FA%22%7D],%22backingPlatforms%22:3,%22shortName%22:%22%22,%22shouldConfirm%22:false,%22disposition%22:0,%22keyCommand%22:%7B%22optionKey%22:false,%22input%22:%22%22,%22controlKey%22:false,%22commandKey%22:false,%22type%22:%22action%22,%22discoverabilityTitle%22:%22time%20report%22,%22shiftKey%22:false%7D,%22logLevel%22:2,%22groupDisposition%22:0,%22notificationType%22:2,%22tintColor%22:%22orange%22,%22actionDescription%22:%22%22,%22keyUseIcon%22:false,%22icon%22:%22graph-bar%22,%22visibility%22:480,%22backingIsSeparator%22:false,%22groupUUID%22:%22F2124A6B-C1E9-4935-9CC6-E025451D3123%22,%22assignTags%22:[],%22name%22:%22time%20report%22%7D,%7B%22uuid%22:%2248EFC7A8-D1FD-42C2-A61A-801050D9ED43%22,%22steps%22:[%7B%22platforms%22:3,%22data%22:%7B%22script%22:%22//%20function%20that%20takes%20string%20returns%20client%20object%20with%20matching%20alias%5Cn//%20or%20prompts%20to%20correct%20string%20or%20add%20new%20client%20object%20if%20no%20match%5Cn//%20client%20object%20includes%20name,%20nickname,%20number,%20billable,%20alias,%20and%20description%5Cn%5Cnfunction%20getClient(candidate)%20%7B%5Cn%5Ct%5Cn%5Ctconst%20fileName%20=%20%20%5C%22clientList.json%5C%22;%5Cn%5Ct%5Cn%5Ct//%20make%20candidate%20lowercase%20for%20easy%20comparison%5Cn%5Ctcandidate%20=%20candidate.toLowerCase().trim();%5Cn%5Ct%5Cn%5Ct//%20load%20contents%20of%20file%5Cn%5CtmyCloud%20=%20FileManager.createCloud();%5Cn%5Ctlet%20contents%20=%20myCloud.read(%5C%22/%5C%22%20+%20fileName);%5Cn%5Ctconsole.log(contents);%5Cn%5Ctif%20(contents%20==%20null)%20%7B%20contents%20=%20&#39;%7B%5C%22clients%5C%22:[]%7D&#39;%20%7D;%5Cn%5Ctconsole.log(contents);%5Cn%5Ctlet%20clientList%20=%20JSON.parse(contents);%5Cn%5Ct%5Cn%5Ct//%20filter%20potential%20matches%5Cn%5Ctlet%20matches%20=%20clientList.clients.filter(c%20=%5Cu003e%20c.alias.includes(candidate));%5Cn%5Ct%5Cn%5Ctswitch%20(matches.length)%20%7B%5Cn%5Ct%5Ct%5Cn%5Ct%5Ct//%20if%20one%20match,%20return%20match%5Cn%5Ct%5Ctcase%201:%5Cn%5Ct%5Ct%5Ctreturn(matches[0]);%5Cn%5Ct%5Ct%5Cn%5Ct%5Ct//%20if%20no%20match,%20prompt%20for%20correction%20or%20new%20client%5Cn%5Ct%5Ctcase%200:%5Cn%5Ct%5Ct%5Ctlet%20p%20=%20Prompt.create();%5Cn%5Ct%5Ct%5Ctp.title%20=%20%5C%22no%20match%5C%22;%5Cn%5Ct%5Ct%5Ctp.message%20=%20%5C%22there%20was%20no%20match%20for%20%5C%22%20+%20candidate%20+%20%5C%22%5C%5Cn%5C%5Cn%20if%20there%20was%20a%20typo,%20enter%20corrected%20name.%20If%20%5C%22%20+%20candidate%20+%20%5C%22%20is%20a%20new%20client,%20enter%20name,%20nickname,%20aliases%20(separated%20by%20a%20comma)%20and%20a%20client-number%5C%22;%5Cn%5Ct%5Ct%5Ctp.addTextField(%5C%22clientName%5C%22,%20%5C%22Corrected/New%20Client%20Name%5C%22,%20candidate,%20%7BwantsFocus:true%7D);%5Cn%5Ct%5Ct%5Ctp.addTextField(%5C%22clientNickname%5C%22,%20%5C%22Nickname%20(for%20iCloud%20folder)%5C%22,%20%5C%22%5C%22);%5Cn%5Ct%5Ct%5Ctp.addTextField(%5C%22clientAliases%5C%22,%20%5C%22Client%20Aliases%5C%22,%20%5C%22%5C%22);%5Cn%5Ct%5Ct%5Ctp.addTextField(%5C%22clientNumber%5C%22,%20%5C%22Client%20Number%5C%22,%20%5C%22%5C%22,%20%7Bplaceholder:%5C%2200000-0%5C%22%7D);%5Cn%5Ct%5Ct%5Ctp.addSwitch(%5C%22billable%5C%22,%20%5C%22Billable?%5C%22,%20true);%5Cn%5Ct%5Ct%5Ctp.addTextField(%5C%22description%5C%22,%20%5C%22Description%5C%22,%20%5C%22%5C%22);%5Cn%5Ct%5Ct%5Ctp.addButton(%5C%22Correct%5C%22);%5Cn%5Ct%5Ct%5Ctp.addButton(%5C%22Add%5C%22);%5Cn%5Cn%5Cn%5Ct%5Ct%5Ct//%20display%20the%20prompt%5Cn%5Ct%5Ct%5Ctlet%20didNotCancel%20=%20p.show();%5Cn%5Cn%5Cn%5Ct%5Ct%5Ct//%20if%20cancelled,%20just%20quit;%5Cn%5Ct%5Ct%5Ctif%20(!didNotCancel)%20%7B%20%5Cn%5Ct%5Ct%5Ct%5Ctcontext.cancel(%5C%22user%20cancelled%5C%22);%5Cn%5Ct%5Ct%5Ct%5Ctreturn;%5Cn%5Ct%5Ct%5Ct%5Ct%5Cn%5Ct%5Ct%5Ct%7D%20else%20%7B%5Cn%5Ct%5Ct%5Ct%5Cn%5Ct%5Ct%5Ct//%20if%20chose%20to%20add%20new%20client,%20add%20to%20list%20and%20return%20new%20info%5Cn%5Ct%5Ct%5Ctif%20(p.buttonPressed%20==%20%5C%22Add%5C%22)%20%7B%5Cn%5Ct%5Ct%5Ct%5Ctlet%20newClientName%20=%20p.fieldValues[%5C%22clientName%5C%22];%5Cn%5Ct%5Ct%5Ct%5CtnewClientName%20=%20newClientName.toLowerCase().trim();%5Cn%5Ct%5Ct%5Ct%5Ctlet%20newClientNickname%20=%20p.fieldValues[%5C%22clientNickname%5C%22];%5Cn%5Ct%5Ct%5Ct%5CtnewClientNickname%20=%20newClientNickname.toLowerCase().trim();%5Cn%5Ct%5Ct%5Ct%5Ctlet%20alias%20=%20p.fieldValues[%5C%22clientAliases%5C%22].split(%5C%22,%5C%22);%5Cn%5Ct%5Ct%5Ct%5Ctalias%20=%20alias.map(x%20=%5Cu003e%20x.toLowerCase().trim());%5Cn%5Ct%5Ct%5Ct%5Ctalias.push(newClientName);%5Cn%5Ct%5Ct%5Ct%5Ctalias.push(newClientNickname);%5Cn%5Ct%5Ct%5Ct%5Ctalias%20=%20[...new%20Set(alias)];%20//%20eliminate%20any%20duplicates%5Cn%5Ct%5Ct%5Ct%5Ctlet%20number%20=%20p.fieldValues[%5C%22clientNumber%5C%22];%5Cn%5Ct%5Ct%5Ct%5Ctlet%20bill%20=%20p.fieldValues[%5C%22billable%5C%22];%5Cn%5Ct%5Ct%5Ct%5Ctlet%20description%20=%20p.fieldValues[%5C%22description%5C%22];%5Cn%5Ct%5Ct%5Ct%5Ct%5Ct%5Ct%5Ct%5Cn%5Ct%5Ct%5Ct%5Ct//%20build%20a%20new%20client%20object%5Cn%5Ct%5Ct%5Ct%5Ctlet%20newClient%20=%20%7B%5Cn%5Ct%5Ct%5Ct%5Ct%5Ctname:%20newClientName,%5Cn%5Ct%5Ct%5Ct%5Ct%5Ctnickname:%20newClientNickname,%5Cn%5Ct%5Ct%5Ct%5Ct%5Ctnumber:%20number,%5Cn%5Ct%5Ct%5Ct%5Ct%5Ctbillable:%20bill,%5Cn%5Ct%5Ct%5Ct%5Ct%5Ctalias:%20alias,%5Cn%5Ct%5Ct%5Ct%5Ct%5Ctdescription:%20description%5Cn%5Ct%5Ct%5Ct%5Ct%7D;%5Cn%5Ct%5Ct%5Ct%5Ct%5Cn%5Ct%5Ct%5Ct%5Ct//%20add%20new%20client%20to%20list%5Cn%5Ct%5Ct%5Ct%5CtclientList.clients.push(newClient);%5Cn%5Cn%5Ct%5Ct%5Ct%5Ct//%20write%20the%20updated%20client%20list%20to%20the%20file%5Cn%5Ct%5Ct%5Ct%5Ctcontents%20=%20JSON.stringify(clientList);%5Cn%5Ct%5Ct%5Ct%5Ctlet%20success%20=%20myCloud.write(%5C%22/%5C%22%20+%20fileName,%20contents);%5Cn%5Ct%5Ct%5Ct%5Ctif%20(success)%20%7Balert(candidate%20+%20%5C%22%20added!%5C%22);%7D%5Cn%5Ct%5Ct%5Ct%5Ctelse%20%7Balert(%5C%22error:%20file%20wasn&#39;t%20written%5C%22);%7D%5Cn%5Ct%5Ct%5Ct%5Ctreturn(getClient(newClientName));%5Cn%5Ct%5Ct%5Ct%7D%5Cn%5Ct%5Ct%5Ct%5Cn%5Ct%5Ct%5Ct//%20if%20corrected,%20re-run%20function%20with%20corrected%20candidate%5Cn%5Ct%5Ct%5Ctif%20(p.buttonPressed%20==%20%5C%22Correct%5C%22)%20%7B%5Cn%5Ct%5Ct%5Ct%5Ctconsole.log(%5C%22correct%20selected.%20Now%20running%20getClient%20on:%20%5C%22%20+%20p.fieldValues[%5C%22clientName%5C%22]);%5Cn%5Ct%5Ct%5Ct%5Ctreturn(getClient(p.fieldValues[%5C%22clientName%5C%22]));%5Cn%5Ct%5Ct%5Ct%7D%5Cn%5Ct%5Ct%5Ct%7D%5Cn%5Cn%5Cn%5Ct%5Ct//%20if%20multiple%20matches,%20chose%20among%20them%5Cn%5Ct%5Ctdefault:%5Cn%5Ct%5Ct%5Ctlet%20q%20=%20Prompt.create();%5Cn%5Ct%5Ct%5Ctq.title%20=%20%5C%22multiple%20matches%5C%22;%5Cn%5Ct%5Ct%5Ctq.message%20=%20%5C%22choose%20which%20client%20you%20meant:%5C%22;%5Cn%5Ct%5Ct%5Ctfor%20(c%20in%20matches)%20%7B%5Cn%5Ct%5Ct%5Ct%5Ctq.addButton(matches[c].name);%5Cn%5Ct%5Ct%5Ct%7D%5Cn%5Ct%5Ct%5Ctq.show();%5Cn%5Ct%5Ct%5Ctlet%20choice%20=%20matches.filter(c%20=%5Cu003e%20c.name%20==%20(q.buttonPressed));%5Cn%5Ct%5Ct%5Ctreturn(choice[0]);%5Cn%5Ct%7D%5Cn%7D%5Cn%22,%22allowAsync%22:%22false%22%7D,%22type%22:%22script%22,%22isEnabled%22:true,%22uuid%22:%22AEA36478-93F2-4C63-9DCD-1379BE0BBD4C%22%7D],%22backingPlatforms%22:3,%22shortName%22:%22%22,%22shouldConfirm%22:false,%22disposition%22:3,%22keyCommand%22:%7B%22optionKey%22:false,%22input%22:%22%22,%22controlKey%22:false,%22commandKey%22:false,%22type%22:%22action%22,%22discoverabilityTitle%22:%22getClient%22,%22shiftKey%22:false%7D,%22logLevel%22:2,%22groupDisposition%22:0,%22notificationType%22:2,%22tintColor%22:%22gray%22,%22actionDescription%22:%22A%20function:%5Cn%5CngetClientNumber(client,%20lookup%20file%20path)%5Cn%5CnIt%20checks%20for%20a%20client%20name%20in%20a%20JSON%20file%20saved%20as%20clientList.json%20in%20your%20Drafts%20iCloud%20folder,%20adds%20it%20if%20not%20already%20present,%20and%20presents%20the%20client-matter%20number%5Cn%22,%22keyUseIcon%22:false,%22icon%22:%22transfer-alt%22,%22visibility%22:480,%22backingIsSeparator%22:false,%22groupUUID%22:%22F2124A6B-C1E9-4935-9CC6-E025451D3123%22,%22assignTags%22:[],%22name%22:%22getClient%22%7D,%7B%22uuid%22:%220FFEF30C-BD29-477F-ADC1-17CBAF3EEDD3%22,%22steps%22:[%7B%22platforms%22:3,%22data%22:%7B%22script%22:%22//%20this%20action%20replaces%20curly%20quotes%20with%20straight%20quotes%5Cn//%20and%20en%20and%20em%20dashes%20with%20hyphens%20to%20avoid%20ascii%20issues%5Cn%5Cn%5Cnfunction%20dumbify(str)%20%7B%5Cn%5Ctlet%20result%20=%20str.replace(/[%5C%5Cu201C%5C%5Cu201D]/g,%20&#39;%5C%5C%5C%22&#39;);%20//%20replace%20double%20quotes%5Cnresult%20=%20result.replace(/[%5C%5Cu2018%5C%5Cu2019%5C%5Cu0027]/g,%20&#39;%5C%5C&#39;&#39;);%20//%20replace%20single%20quotes%5Cnresult%20=%20result.replace(/%5C%5Cu2014/g,%20&#39;--&#39;);%20//%20replace%20em-dashes%5Cnresult%20=%20result.replace(/%5C%5Cu2013/g,%20&#39;-&#39;);%20//%20replace%20en-dashes%5Cn%5Ctreturn%20result;%5Cn%7D%5Cn%5Cneditor.setText(dumbify(editor.getText()));%22,%22allowAsync%22:%22false%22%7D,%22type%22:%22script%22,%22isEnabled%22:true,%22uuid%22:%2297688BF1-E03B-4FED-8E9E-A572D5B4EC1F%22%7D],%22backingPlatforms%22:3,%22shortName%22:%22%22,%22shouldConfirm%22:false,%22disposition%22:3,%22keyCommand%22:%7B%22optionKey%22:false,%22input%22:%22%22,%22controlKey%22:false,%22commandKey%22:false,%22type%22:%22action%22,%22discoverabilityTitle%22:%22dumbify%22,%22shiftKey%22:false%7D,%22logLevel%22:2,%22groupDisposition%22:0,%22notificationType%22:2,%22tintColor%22:%22gray%22,%22actionDescription%22:%22%22,%22keyUseIcon%22:false,%22icon%22:%22677-emoticon-sad%22,%22visibility%22:480,%22backingIsSeparator%22:false,%22groupUUID%22:%22F2124A6B-C1E9-4935-9CC6-E025451D3123%22,%22assignTags%22:[],%22name%22:%22dumbify%22%7D],%22modifiedAt%22:603343794.974378,%22disposition%22:0,%22uuid%22:%22F2124A6B-C1E9-4935-9CC6-E025451D3123%22,%22visibility%22:480,%22createdAt%22:603343794.974377,%22icon%22:%22stopwatch%22,%22changeTag%22:%221wm0%22%7D">Install</a>
</div>

<hr style="margin: 1em 0;"/>
<h4>Included Actions</h4>
<ul class='action-group'>
  	<li>
  		<div class='list_content'>
  			insert date
  		</div>
  	</li>
  	<li>
  		<div class='list_content'>
  			insert time
  		</div>
  	</li>
  	<li>
  		<div class='list_content'>
  			start timeslip
  		</div>
  	</li>
  	<li>
  		<div class='list_content'>
  			get client number
  		</div>
  	</li>
  	<li>
  		<div class='list_content'>
  			process timeslip
  		</div>
  	</li>
  	<li>
  		<div class='list_content'>
  			time report
  		</div>
  	</li>
  	<li>
  		<div class='list_content'>
  			getClient
  		</div>
  	</li>
  	<li>
  		<div class='list_content'>
  			dumbify
  		</div>
  	</li>
</ul>

<div class="disclaimer">
  Items available in the Drafts Directory are uploaded by community members. Use appropriate caution reviewing downloaded items before use.
</div>


                  </div>
                  <div class="footer-content">
                  <p>
                  <a href="https://itunes.apple.com/app/id1236254471?ls=1&mt=8&at=11l4Cf&ct=site">
                    <img alt="Download on App Store" src="../assets/appstore-deaf597bd57239c5054c59099e54ab9014f1e15eddb961085428e0ce94d4385b.svg" />
                  </a>
                  <a href="https://itunes.apple.com/app/id1435957248?mt=12&at=11l4Cf&ct=site">
                    <img alt="Download on Mac App Store" src="../assets/macappstore-05f5eed00e6bb26b68c1368217276158329862682e6d61b3ed193f819fe02f2f.svg" />
                  </a>
                  </p>
                    &copy; 2012-2022 by Agile Tortoise, Inc.<br/>
                    Drafts is a registered Trademark of Agile Tortoise, Inc.<br/>
                    <a href="../../getdrafts.com/support/privacy.html">Privacy</a> | <a href="../../getdrafts.com/support/terms.html">Terms</a>
                </div>
                </div>
            </div>
        </div>
    </div>

  </body>
  </html>
