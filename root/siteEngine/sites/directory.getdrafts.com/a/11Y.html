<!DOCTYPE html>
<html lang='en'>
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <title>extended drafts search | Drafts Directory</title>
    <meta name="csrf-param" content="authenticity_token" />
<meta name="csrf-token" content="n0bm8BL0+fvwqI3C/gciHtB++mvuj35Cu49moM4bBsWSvK0tFKaRdHo92f1VMBnauLRz4W5mHGD1wf3TRS4fSg==" />
    <meta http-equiv="content-type" content="text/html;charset=utf-8">
    <meta http-equiv="content-language" content="en">
    <meta http-equiv="content-language" content="en-us">
    
    <meta name="viewport" content="width=device-width, initial-scale=1">
    
    <meta property="og:title" content="Drafts Directory: extended drafts search" />
    <meta property="og:url" content="https://directory.getdrafts.com/a/11Y" />
    <meta property="og:type" content="website" />
    <meta property="og:description" content="Example actions and other extensions for Drafts, the quick-capture notes app." />
    <meta property="og:image" content="https://directory.getdrafts.com/assets/drafts-ogimage-action-d9c60102fd45e0cb516e1b49ed50a81e3c3a2b90f81f55df8f43d0feb0512978.png" />
    <meta property="twitter:title" content="Drafts Directory: extended drafts search" />
    <meta property="twitter:url" content="https://directory.getdrafts.com/a/11Y" />
    <meta property="twitter:type" content="website" />
    <meta property="twitter:description" content="Example actions and other extensions for Drafts, the quick-capture notes app." />
    <meta property="twitter:image" content="https://directory.getdrafts.com/assets/drafts-ogimage-action-d9c60102fd45e0cb516e1b49ed50a81e3c3a2b90f81f55df8f43d0feb0512978.png" />

    <link rel="shortcut icon" type="image/x-icon" href="../assets/favicon-114dbb66b0ef0399a14fa5dfcad7e6210bb558c30cea665e04d49b59fec87f70.png" />

    <link rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.4.0/styles/default.min.css">
    <link rel="stylesheet" media="all" href="../assets/application-6e4f014b4c48cd673942dbfbbeb3e571a732b05562ddde5904f3a5c3833e54ff.css" />
    <script src="../assets/application-13492939cb10be5be76b5abb3e9ae0bef0bbae3202cec2b85cf6fca5bc8429c8.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.4.0/highlight.min.js"></script>
    <script>hljs.highlightAll();</script>
    <script async defer data-domain="directory.getdrafts.com" src="https://plausible.io/js/plausible.js"></script>
  </head>

<body data-no-turbolink>

    <div class="page-wrap">
        <div class="side-bar">
            <a href="../index.html" class="site-title fs-6 lh-tight" title="{{ site.title }}">
                <img src="../assets/drafts-directory-header-4d826bd007f515c8e5a10f654e56ad76fbb3bd3103a67ce342283f701f1677fe.svg" alt="Drafts Directory" style="max-height: 30px;" />
            </a>
            <span class="fs-3"><button class="js-main-nav-trigger navigation-list-toggle btn btn-outline" type="button"
                    data-text-toggle="Hide">Menu</button></span>
            <div class="navigation main-nav js-main-nav">
              <ul class="navigation-list">
                <li class="navigation-list-item">
                  <a class="navigation-list-link" href="../index.html">Home</a>
                </li>
                <li class="navigation-list-item">
                  <a class="navigation-list-link" href="../drafts_actions.html">Actions</a>
                </li>
                <li class="navigation-list-item">
                  <a class="navigation-list-link" href="../drafts_action_groups.html">Action Groups</a>
                </li>
                <li class="navigation-list-item">
                  <a class="navigation-list-link" href="../syntax_definitions.html">Syntaxes</a>
                </li>
                <li class="navigation-list-item">
                  <a class="navigation-list-link" href="../theme_definitions.html">Themes</a>
                </li>
                <li class="navigation-list-item">
                  <a class="navigation-list-link" href="../workspaces.html">Workspaces</a>
                </li>
                <li class="navigation-list-item">
                  <hr style="margin:1em; padding: 0;" />
                </li>
                <li class="navigation-list-item">
                  <a class="navigation-list-link" href="../search.html">Search</a>
                </li>
                <li class="navigation-list-item">
                  <hr style="margin:1em; padding: 0;" />
                </li>
                <li class="navigation-list-item">
                    <a class="navigation-list-link nav-external" title="About Drafts" href="../../getdrafts.com/index.html">Get Drafts &#x2192;</a>
                </li>
                <li class="navigation-list-item">
                    <a class="navigation-list-link nav-external" title="Detailed documentation" href="../../docs.getdrafts.com/index.html">User Guide &#x2192;</a>
                </li>
                <li class="navigation-list-item">
                    <a class="navigation-list-link nav-external" title="Get your questions answered in the forums" href="https://forums.getdrafts.com/">Community &#x2192;</a>
                </li>
                <li class="navigation-list-item">
                    <a class="navigation-list-link nav-external" title="Online tools and generators" href="../../tools.getdrafts.com/index.html">Tools &#x2192;</a>
                </li>
                <li class="navigation-list-item">
                    <a class="navigation-list-link nav-external" title="Scripting library reference" href="../../scripting.getdrafts.com/index.html">Script Reference &#x2192;</a>
                </li>
              </ul>
            </div>
            <footer role="contentinfo" class="site-footer">
                <p class="text-small text-grey-dk-000 mb-0">
                    Download: <a href="https://itunes.apple.com/app/id1236254471?ls=1&mt=8&at=11l4Cf&ct=site">iOS</a> | <a href="https://itunes.apple.com/app/id1435957248?mt=12&at=11l4Cf&ct=site">Mac</a>
                </p>
            </footer>
        </div>
        <div class="main-content-wrap js-main-content" tabindex="0">
            <div class="page-header">
                <div class="main-content">
                    <div class="search js-search">
	<div class="search-input-wrap">
<form class="search-form" action="../search.html" accept-charset="UTF-8" method="get"><input name="utf8" type="hidden" value="&#x2713;" />
	<button style='border:none;background-color:transparent;'>
	<svg width="14" height="14" viewBox="0 0 28 28" xmlns="http://www.w3.org/2000/svg"
		class="search-icon">
		<title>Search</title>
		<g fill-rule="nonzero">
			<path
				d="M17.332 20.735c-5.537 0-10-4.6-10-10.247 0-5.646 4.463-10.247 10-10.247 5.536 0 10 4.601 10 10.247s-4.464 10.247-10 10.247zm0-4c3.3 0 6-2.783 6-6.247 0-3.463-2.7-6.247-6-6.247s-6 2.784-6 6.247c0 3.464 2.7 6.247 6 6.247z" />
			<path d="M11.672 13.791L.192 25.271 3.02 28.1 14.5 16.62z" />
		</g>
	</svg>
	</button>
	<input type="text" name="q" id="q" class="js-search-input search-input search" size="12" tabindex="0" placeholder="Search" />
</form>	</div>
</div>
                    <ul class="list-style-none text-small mt-md-1 mb-md-1 pb-4 pb-md-0 js-aux-nav aux-nav">
                        <li class="d-inline-block my-0 mr-2">
                          <a href="../../getdrafts.com/index.html">Get Drafts</a>
                        </li>
                        <li class="d-inline-block my-0">
                          <a href="https://forums.getdrafts.com">Community</a>
                        </li>
                    </ul>
                </div>
            </div>
            <div class="main-content">
                <div id="main-content" class="page-content" role="main">
                  <div class="type">
                    <h4>Action</h4>
                  </div>
                  <div class="header">
                      <h1><img src="https://config.agiletortoise.com/drafts-icons/search.png" class="action-icon" />extended drafts search</h1>
                  </div>

                  <div class="content">
                    
<div class='caption'>
        Posted by FlohGro,
    Last update
    about 2 months ago
</div>

    <div class='update_notes'>
      <h3>UPDATES</h3>
      <div id="firstUpdateNote">
      <h4>about 2 months ago</h4>
      <p>reverted disabled regex search</p>

      </div>
      <a href="11Y.html#" onclick="document.getElementById('firstUpdateNote').classList.add('hide');document.getElementById('additionalNotes').classList.remove('hide');this.classList.add('hide');return false;">show all updates...</a>
      <div id="additionalNotes" class='hide'>
        <div>
        <h4>about 2 months ago</h4>
        <p>reverted disabled regex search</p>

        </div>
        <div>
        <h4>about 2 months ago</h4>
        <p>disabled regex search - if you want to enable it - follow the instructions in the script step of the action</p>

        </div>
        <div>
        <h4>3 months ago</h4>
        <p>name change and description update</p>

        </div>
      </div>
    </div>

    <div class='description'>
        <p><em>created by <a href="https://twitter.com/FlohGro">@FlohGro</a> / more on my <a href="http://www.flohgro.com/blog">Blog</a></em></p>

<h2>extended drafts search</h2>

<p>This actions gives you some options to search through your drafts library which are not possible with the standard search or the quick search view.</p>

<p>First you can search through your library by </p>

<ul>
<li>the title of the drafts</li>
<li>the whole content of drafts</li>
</ul>

<p>Additionally you can also search through all your drafts with a regex expression.</p>

<p>Last but not least you can search for a tag - select the tag you wanted and query for all drafts with that tag.</p>

<h2>[Configuration]</h2>

<p>You can just use the action as it is. If you don’t need one of the search types you can modify this line <code>const searchTypes = [&quot;in titles&quot;, &quot;in content&quot;, &quot;as regex&quot;, &quot;in tags&quot;];</code> and just remove e.g. „<em>&ldquo;as regex&rdquo;,</em>“* *from the list.</p>

<h2>[Usage]</h2>

<p>Just run the action anytime you want to search in you drafts library. It will display a prompt where you can type your query and then press the button to select the type of your search. If the resulting prompt shows the draft you searched for just select it and it will be opened. If you didn’t found what you searched for just „cancel“ the draft selection prompt and the action will ask you if you want to perform another search.</p>

<hr>

<p><em>If you find this useful and want to support me you can</em> </p>

<p><a href="https://www.buymeacoffee.com/flohgro" target="_blank"><img src="https://cdn.buymeacoffee.com/buttons/v2/default-blue.png" alt="Buy Me A Coffee" style="height: 51px !important;width: 209px !important;" ></a></p>

    </div>

<div class="certification">
  
  <a class='trusted' href='11Y.html#' title='From trusted community member'><img style="width:24px;height:24px;vertical-align:middle;" src="../assets/trusted-c3f95628f768e0a0ed09961d556a8012d1b1be6ae9e6adede683513eec0df814.svg" /> Trusted member</a>
</div>

<div style="margin: 2em 0;">
    <a class="btn btn-blue" href="drafts5://action?identifier=11Y&amp;data=%7B%22uuid%22:%2297FCA65F-15B6-4454-8AED-07E8B64E22F3%22,%22steps%22:[%7B%22platforms%22:3,%22data%22:%7B%22script%22:%22//%20search%20drafts%5Cn%5Cn//%20regex%20removed%20since%20its%20also%20available%20in%20the%20quick%20search%20-%20if%20you%20want%20to%20enable%20regex%20search%20just%20comment%20out%20line%204%20and%20comment%20in%20line%205%5Cn//const%20searchTypes%20=%20[%5C%22in%20titles%5C%22,%20%5C%22in%20content%5C%22,%20%5C%22in%20tags%5C%22];%5Cnconst%20searchTypes%20=%20[%5C%22in%20titles%5C%22,%20%5C%22in%20content%5C%22,%20%5C%22as%20regex%5C%22,%20%5C%22in%20tags%5C%22];%5Cnvar%20foundDrafts%20=%20[];%5Cnvar%20runSearch%20=%20true;%5Cnvar%20searchTypeDesctiptor%20=%20%5C%22%5C%22;%5Cn%5Cn%5Cnfunction%20queryByTitle(query)%20%7B%5Cn%20%20let%20searchResults%20=%20[];%5Cn%20%20let%20allDrafts%20=%20Draft.query(query,%20%5C%22all%5C%22,%20[],%20[],%20%5C%22modified%5C%22,%20true,%20true);%5Cn%20%20for%20(d%20of%20allDrafts)%20%7B%5Cn%20%20%20%20if%20(d.title.includes(query))%20%7B%5Cn%20%20%20%20%20%20searchResults.push(d);%5Cn%20%20%20%20%7D%5Cn%20%20%7D%5Cn%20%20return%20searchResults;%5Cn%7D%5Cn%5Cnfunction%20queryByString(query)%20%7B%5Cn%20%20let%20searchResults%20=%20Draft.query(query,%20%5C%22all%5C%22,%20[],%20[],%20%5C%22modified%5C%22,%20true,%20true);%5Cn%20%20return%20searchResults;%5Cn%7D%5Cn%5Cn%5Cnfunction%20queryByRegex(query)%20%7B%5Cn%20%20let%20searchResults%20=%20[];%5Cn%5Cn%20%20let%20allDrafts%20=%20Draft.query(%5C%22%5C%22,%20%5C%22all%5C%22,%20[],%20[],%20%5C%22modified%5C%22,%20true,%20true);%5Cn%5Cn%20%20for%20(d%20of%20allDrafts)%20%7B%5Cn%20%20%20%20if%20(d.content.match(query))%20%7B%5Cn%20%20%20%20%20%20searchResults.push(d);%5Cn%20%20%20%20%7D%5Cn%20%20%7D%5Cn%20%20return%20searchResults;%5Cn%7D%5Cn%5Cnfunction%20queryByTags(query,%20isTagSearch)%20%7B%5Cn%20%20let%20searchResults%20=%20[];%5Cn%5Cn%20%20if%20(isTagSearch)%20%7B%5Cn%20%20%20%20let%20allDrafts%20=%20Draft.query(%5C%22%5C%22,%20%5C%22all%5C%22,%20[],%20[],%20%5C%22modified%5C%22,%20true,%20true);%5Cn%20%20%20%20for%20(d%20of%20allDrafts)%20%7B%5Cn%20%20%20%20%20%20for%20(tag%20of%20d.tags)%20%7B%5Cn%20%20%20%20%20%20%20%20if%20(tag.includes(query))%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20if%20(!searchResults.includes(tag))%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20%20%20searchResults.push(tag);%5Cn%20%20%20%20%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%7D%5Cn%20%20%20%20%7D%5Cn%20%20%7D%20else%20%7B%5Cn%20%20%20%20let%20allDrafts%20=%20Draft.query(%5C%22%5C%22,%20%5C%22all%5C%22,%20[query],%20[],%20%5C%22modified%5C%22,%20true,%20true);%5Cn%20%20%20%20for%20(d%20of%20allDrafts)%20%7B%5Cn%20%20%20%20%20%20searchResults.push(d);%5Cn%20%20%20%20%7D%5Cn%20%20%7D%5Cn%5Cn%20%20return%20searchResults;%5Cn%7D%5Cn%5Cn%5Cnfunction%20selectFoundTag(tagsList)%20%7B%5Cn%20%20tagsList.sort();%5Cn%20%20let%20pSelectTag%20=%20Prompt.create();%5Cn%20%20for%20(tag%20of%20tagsList)%20%7B%5Cn%20%20%20%20pSelectTag.addButton(tag);%5Cn%20%20%7D%5Cn%20%20if%20(pSelectTag.show())%20%7B%5Cn%20%20%20%20return%20pSelectTag.buttonPressed;%5Cn%20%20%7D%20else%20%7B%5Cn%20%20%20%20return%20%5C%22NO%20TAG%20SELECTED%5C%22;%5Cn%20%20%7D%5Cn%7D%5Cn%5Cnfunction%20searchAgain(msg)%7B%5Cn%5Ctlet%20pSearchAgain%20=%20Prompt.create();%5Cn%5CtpSearchAgain.title%20=%20%5C%22search%20again?%5C%22%5Cn%5CtpSearchAgain.message%20=%20%5C%22because%20%5C%22%20+%20msg;%5Cn%5CtpSearchAgain.addButton(%5C%22YES%5C%22,true);%5Cn%5CtpSearchAgain.addButton(%5C%22NO%5C%22,false);%5Cn%5CtpSearchAgain.isCancellable%20=%20false;%5Cn%5CtpSearchAgain.show();%5Cn%5Ctreturn%20pSearchAgain.buttonPressed;%5Cn%5Cn%7D%5Cn%5Cn%5Cn%5Cnfunction%20selectResultToOpen(foundDrafts)%20%7B%5Cn%20%20pOpenDraft%20=%20Prompt.create();%5Cn%20%20pOpenDraft.title%20=%20%5C%22select%20draft%20to%20open%5C%22;%5Cn%5Cn%20%20for%20(d%20of%20foundDrafts)%20%7B%5Cn%20%20%20%20pOpenDraft.addButton(d.title,%20d);%5Cn%20%20%7D%5Cn%5Cn%20%20if%20(pOpenDraft.show())%20%7B%5Cn%20%20%20%20editor.load(pOpenDraft.buttonPressed);%5Cn%20%20%20%20runSearch%20=%20false;%5Cn%20%20%7D%20else%20%7B%5Cn%5CtrunSearch%20=%20searchAgain(%5C%22you%20did%20not%20select%20to%20open%20a%20draft%20in%20the%20%5C%22%20+%20%20%20%20%20%20%20%20%20searchTypeDesctiptor%20+%20%5C%22%20search%5C%22);%5Cn%20%20%7D%5Cn%5Cn%7D%5Cn%5Cnfunction%20performSearch()%20%7B%5Cn%20%20//%20prompt%20which%20search%5Cn%20%20pSearchBy%20=%20Prompt.create();%5Cn%20%20pSearchBy.title%20=%20%5C%22search%20for%5C%22;%5Cn%5Cn%20%20pSearchBy.addTextField(%5C%22query%5C%22,%20%5C%22%5C%22,%20%5C%22%5C%22,%20%7B%5Cn%20%20%20%20%5C%22wantsFocus%5C%22:%20true%5Cn%20%20%7D);%5Cn%5Cn%20%20for%20(searchType%20of%20searchTypes)%20%7B%5Cn%20%20%20%20pSearchBy.addButton(searchType);%5Cn%20%20%7D%5Cn%5Cn%5Cn%5Cn%20%20if%20(pSearchBy.show())%20%7B%5Cn%20%20%20%20let%20query%20=%20pSearchBy.fieldValues[%5C%22query%5C%22];%5Cn%20%20%20%20if%20(query%20==%20%5C%22%5C%22)%20%7B%5Cn%20%20%20%20%20%20context.fail(%5C%22no%20search%20query%20was%20entered%5C%22);%5Cn%20%20%20%20%20%20app.displayErrorMessage(%5C%22no%20search%20query%20was%20entered%5C%22);%5Cn%20%20%20%20%7D%20else%20%7B%5Cn%20%20%20%20%20%20switch%20(pSearchBy.buttonPressed)%20%7B%5Cn%20%20%20%20%20%20%20%20case%20%5C%22in%20titles%5C%22:%5Cn%20%20%20%20%20%20%20%20%5CtsearchTypeDesctiptor%20=%20%5C%22title%5C%22;%5Cn%20%20%20%20%20%20%20%20%20%20foundDrafts%20=%20queryByTitle(query);%5Cn%20%20%20%20%20%20%20%20%20%20break;%5Cn%20%20%20%20%20%20%20%20case%20%5C%22in%20content%5C%22:%5Cn%20%20%20%20%20%20%20%20searchTypeDesctiptor%20=%20%5C%22content%5C%22;%5Cn%20%20%20%20%20%20%20%20%20%20foundDrafts%20=%20queryByString(query);%5Cn%20%20%20%20%20%20%20%20%20%20break;%5Cn%20%20%20%20%20%20%20%20case%20%5C%22as%20regex%5C%22:%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20searchTypeDesctiptor%20=%20%5C%22regex%5C%22;%5Cn%20%20%20%20%20%20%20%20%20%20foundDrafts%20=%20queryByRegex(query);%5Cn%20%20%20%20%20%20%20%20%20%20break;%5Cn%20%20%20%20%20%20%20%20case%20%5C%22in%20tags%5C%22:%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20searchTypeDesctiptor%20=%20%5C%22tag%5C%22;%5Cn%20%20%20%20%20%20%20%20%20%20foundDrafts%20=%20queryByTags(query,%20true);%5Cn%20%20%20%20%20%20%20%20%20%20if%20(foundDrafts.length%20%5Cu003e%200)%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20%20%20let%20selectedTag%20=%20selectFoundTag(foundDrafts);%5Cn%20%20%20%20%20%20%20%20%20%20%20%20if%20(selectedTag%20==%20%5C%22NO%20TAG%20SELECTED%5C%22)%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20foundDrafts%20=%20[];%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20runSearch%20=%20searchAgain(%5C%22you%20did%20not%20select%20a%20tag%20to%20query%20for%20drafts%5C%22);%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%7D%20else%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20foundDrafts%20=%20queryByTags(selectedTag,%20false);%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%20%20%20%20break;%5Cn%20%20%20%20%20%20%20%20default:%5Cn%20%20%20%20%20%20%20%20%20%20context.fail(%5C%22searchType%20not%20implemented!%5C%22);%5Cn%20%20%20%20%20%20%20%20%20%20break;%5Cn%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20if%20(foundDrafts.length%20%5Cu003e%200)%20%7B%5Cn%20%20%20%20%20%20%20%20selectResultToOpen(foundDrafts);%5Cn%20%20%20%20%20%20%7D%20else%20%7B%5Cn%20%20%20%20%20%20%5Ct%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20runSearch%20=%20searchAgain(%5C%22no%20drafts%20where%20found%20with%20your%20%5C%22%20+%20%20%20%20%20%20%20%20%20searchTypeDesctiptor%20+%20%20%5C%22%20search%20for%20%5C%5C%5C%22%5C%22%20+%20query%20+%20%5C%22%5C%5C%5C%22%5C%22)%5Cn%20%20%20%20%20%20%7D%5Cn%5Cn%20%20%20%20%7D%5Cn%20%20%7D%20else%20%7B%5Cn%20%20%20%20context.cancel();%5Cn%20%20%20%20runSearch%20=%20false;%5Cn%20%20%7D%5Cn%7D%5Cn%5Cnwhile(runSearch)%7B%5CnperformSearch();%5Cn%7D%22,%22allowAsync%22:%22false%22%7D,%22type%22:%22script%22,%22isEnabled%22:true,%22uuid%22:%22493F9E4F-7560-4ADB-80D6-DE1666F67589%22%7D],%22backingPlatforms%22:3,%22shortName%22:%22%22,%22shouldConfirm%22:false,%22disposition%22:0,%22keyCommand%22:%7B%22optionKey%22:false,%22input%22:%22%22,%22controlKey%22:false,%22commandKey%22:false,%22type%22:%22action%22,%22discoverabilityTitle%22:%22extended%20drafts%20search%22,%22shiftKey%22:false%7D,%22logLevel%22:2,%22groupDisposition%22:0,%22notificationType%22:2,%22tintColor%22:%22indigo%22,%22actionDescription%22:%22*created%20by%20[@FlohGro](https://twitter.com/FlohGro)%20/%20more%20on%20my%20[Blog](http://www.flohgro.com/blog)*%5Cn%5Cn%23%23%20extended%20drafts%20search%5Cn%5CnThis%20actions%20gives%20you%20some%20options%20to%20search%20through%20your%20drafts%20library%20which%20are%20not%20possible%20with%20the%20standard%20search%20or%20the%20quick%20search%20view.%5Cn%5CnFirst%20you%20can%20search%20through%20your%20library%20by%20%5Cn%5Cn-%20the%20title%20of%20the%20drafts%5Cn-%20the%20whole%20content%20of%20drafts%5Cn%5CnAdditionally%20you%20can%20also%20search%20through%20all%20your%20drafts%20with%20a%20regex%20expression.%5Cn%5CnLast%20but%20not%20least%20you%20can%20search%20for%20a%20tag%20-%20select%20the%20tag%20you%20wanted%20and%20query%20for%20all%20drafts%20with%20that%20tag.%5Cn%5Cn%23%23%20[Configuration]%5Cn%5Cn%5CnYou%20can%20just%20use%20the%20action%20as%20it%20is.%20If%20you%20don%E2%80%99t%20need%20one%20of%20the%20search%20types%20you%20can%20modify%20this%20line%20%60const%20searchTypes%20=%20[%5C%22in%20titles%5C%22,%20%5C%22in%20content%5C%22,%20%5C%22as%20regex%5C%22,%20%5C%22in%20tags%5C%22];%60%20and%20just%20remove%20e.g.%20%E2%80%9E*%5C%22as%20regex%5C%22,*%E2%80%9C*%20*from%20the%20list.%5Cn%5Cn%23%23%20[Usage]%5Cn%5Cn%5CnJust%20run%20the%20action%20anytime%20you%20want%20to%20search%20in%20you%20drafts%20library.%20It%20will%20display%20a%20prompt%20where%20you%20can%20type%20your%20query%20and%20then%20press%20the%20button%20to%20select%20the%20type%20of%20your%20search.%20If%20the%20resulting%20prompt%20shows%20the%20draft%20you%20searched%20for%20just%20select%20it%20and%20it%20will%20be%20opened.%20If%20you%20didn%E2%80%99t%20found%20what%20you%20searched%20for%20just%20%E2%80%9Ecancel%E2%80%9C%20the%20draft%20selection%20prompt%20and%20the%20action%20will%20ask%20you%20if%20you%20want%20to%20perform%20another%20search.%5Cn%5Cn%5Cn---%5Cn%5Cn*If%20you%20find%20this%20useful%20and%20want%20to%20support%20me%20you%20can*%20%5Cn%5Cn%5Cu003ca%20href=%5C%22https://www.buymeacoffee.com/flohgro%5C%22%20target=%5C%22_blank%5C%22%5Cu003e%5Cu003cimg%20src=%5C%22https://cdn.buymeacoffee.com/buttons/v2/default-blue.png%5C%22%20alt=%5C%22Buy%20Me%20A%20Coffee%5C%22%20style=%5C%22height:%2051px%20!important;width:%20209px%20!important;%5C%22%20%5Cu003e%5Cu003c/a%5Cu003e%22,%22keyUseIcon%22:false,%22icon%22:%22search%22,%22visibility%22:480,%22backingIsSeparator%22:false,%22groupUUID%22:%22D3BA6BF3-ED1E-4639-9C1C-0B0AE5DB2467%22,%22assignTags%22:[],%22name%22:%22extended%20drafts%20search%22%7D">Install</a>
</div>

<div>
  <h4>Steps</h4>
<ul class='steps'>
  <li>
    <div class='step'><h3>script</h3><pre><code class='language-javascript'>// search drafts

// regex removed since its also available in the quick search - if you want to enable regex search just comment out line 4 and comment in line 5
//const searchTypes = [&quot;in titles&quot;, &quot;in content&quot;, &quot;in tags&quot;];
const searchTypes = [&quot;in titles&quot;, &quot;in content&quot;, &quot;as regex&quot;, &quot;in tags&quot;];
var foundDrafts = [];
var runSearch = true;
var searchTypeDesctiptor = &quot;&quot;;


function queryByTitle(query) {
  let searchResults = [];
  let allDrafts = Draft.query(query, &quot;all&quot;, [], [], &quot;modified&quot;, true, true);
  for (d of allDrafts) {
    if (d.title.includes(query)) {
      searchResults.push(d);
    }
  }
  return searchResults;
}

function queryByString(query) {
  let searchResults = Draft.query(query, &quot;all&quot;, [], [], &quot;modified&quot;, true, true);
  return searchResults;
}


function queryByRegex(query) {
  let searchResults = [];

  let allDrafts = Draft.query(&quot;&quot;, &quot;all&quot;, [], [], &quot;modified&quot;, true, true);

  for (d of allDrafts) {
    if (d.content.match(query)) {
      searchResults.push(d);
    }
  }
  return searchResults;
}

function queryByTags(query, isTagSearch) {
  let searchResults = [];

  if (isTagSearch) {
    let allDrafts = Draft.query(&quot;&quot;, &quot;all&quot;, [], [], &quot;modified&quot;, true, true);
    for (d of allDrafts) {
      for (tag of d.tags) {
        if (tag.includes(query)) {
          if (!searchResults.includes(tag)) {
            searchResults.push(tag);
          }
        }
      }
    }
  } else {
    let allDrafts = Draft.query(&quot;&quot;, &quot;all&quot;, [query], [], &quot;modified&quot;, true, true);
    for (d of allDrafts) {
      searchResults.push(d);
    }
  }

  return searchResults;
}


function selectFoundTag(tagsList) {
  tagsList.sort();
  let pSelectTag = Prompt.create();
  for (tag of tagsList) {
    pSelectTag.addButton(tag);
  }
  if (pSelectTag.show()) {
    return pSelectTag.buttonPressed;
  } else {
    return &quot;NO TAG SELECTED&quot;;
  }
}

function searchAgain(msg){
	let pSearchAgain = Prompt.create();
	pSearchAgain.title = &quot;search again?&quot;
	pSearchAgain.message = &quot;because &quot; + msg;
	pSearchAgain.addButton(&quot;YES&quot;,true);
	pSearchAgain.addButton(&quot;NO&quot;,false);
	pSearchAgain.isCancellable = false;
	pSearchAgain.show();
	return pSearchAgain.buttonPressed;

}



function selectResultToOpen(foundDrafts) {
  pOpenDraft = Prompt.create();
  pOpenDraft.title = &quot;select draft to open&quot;;

  for (d of foundDrafts) {
    pOpenDraft.addButton(d.title, d);
  }

  if (pOpenDraft.show()) {
    editor.load(pOpenDraft.buttonPressed);
    runSearch = false;
  } else {
	runSearch = searchAgain(&quot;you did not select to open a draft in the &quot; +         searchTypeDesctiptor + &quot; search&quot;);
  }

}

function performSearch() {
  // prompt which search
  pSearchBy = Prompt.create();
  pSearchBy.title = &quot;search for&quot;;

  pSearchBy.addTextField(&quot;query&quot;, &quot;&quot;, &quot;&quot;, {
    &quot;wantsFocus&quot;: true
  });

  for (searchType of searchTypes) {
    pSearchBy.addButton(searchType);
  }



  if (pSearchBy.show()) {
    let query = pSearchBy.fieldValues[&quot;query&quot;];
    if (query == &quot;&quot;) {
      context.fail(&quot;no search query was entered&quot;);
      app.displayErrorMessage(&quot;no search query was entered&quot;);
    } else {
      switch (pSearchBy.buttonPressed) {
        case &quot;in titles&quot;:
        	searchTypeDesctiptor = &quot;title&quot;;
          foundDrafts = queryByTitle(query);
          break;
        case &quot;in content&quot;:
        searchTypeDesctiptor = &quot;content&quot;;
          foundDrafts = queryByString(query);
          break;
        case &quot;as regex&quot;:
                searchTypeDesctiptor = &quot;regex&quot;;
          foundDrafts = queryByRegex(query);
          break;
        case &quot;in tags&quot;:
                searchTypeDesctiptor = &quot;tag&quot;;
          foundDrafts = queryByTags(query, true);
          if (foundDrafts.length &gt; 0) {
            let selectedTag = selectFoundTag(foundDrafts);
            if (selectedTag == &quot;NO TAG SELECTED&quot;) {
              foundDrafts = [];
              runSearch = searchAgain(&quot;you did not select a tag to query for drafts&quot;);
            } else {
              foundDrafts = queryByTags(selectedTag, false);
            }
          }
          break;
        default:
          context.fail(&quot;searchType not implemented!&quot;);
          break;
      }
      if (foundDrafts.length &gt; 0) {
        selectResultToOpen(foundDrafts);
      } else {
      	               runSearch = searchAgain(&quot;no drafts where found with your &quot; +         searchTypeDesctiptor +  &quot; search for \&quot;&quot; + query + &quot;\&quot;&quot;)
      }

    }
  } else {
    context.cancel();
    runSearch = false;
  }
}

while(runSearch){
performSearch();
}</code></pre></div>
  </li>
</ul>
</div>

<div>
  <h4>Options</h4>
  <ul class="steps">
    <li>
  <table class='action-detail'>
    <tr>
      <td class="cell-label">After Success</td>
      <td class="value">
        Nothing
        
      </td>
    </tr>
    <tr>
      <td class="cell-label">Notification</td>
      <td class="value">Info</td>
    </tr>
    <tr>
      <td class="cell-label">Log Level</td>
      <td class="value">Info</td>
    </tr>
  </table>
</li>
</ul>
</div>

<div class="disclaimer">
  Items available in the Drafts Directory are uploaded by community members. Use appropriate caution reviewing downloaded items before use.
</div>


                  </div>
                  <div class="footer-content">
                  <p>
                  <a href="https://itunes.apple.com/app/id1236254471?ls=1&mt=8&at=11l4Cf&ct=site">
                    <img alt="Download on App Store" src="../assets/appstore-deaf597bd57239c5054c59099e54ab9014f1e15eddb961085428e0ce94d4385b.svg" />
                  </a>
                  <a href="https://itunes.apple.com/app/id1435957248?mt=12&at=11l4Cf&ct=site">
                    <img alt="Download on Mac App Store" src="../assets/macappstore-05f5eed00e6bb26b68c1368217276158329862682e6d61b3ed193f819fe02f2f.svg" />
                  </a>
                  </p>
                    &copy; 2012-2022 by Agile Tortoise, Inc.<br/>
                    Drafts is a registered Trademark of Agile Tortoise, Inc.<br/>
                    <a href="../../getdrafts.com/support/privacy.html">Privacy</a> | <a href="../../getdrafts.com/support/terms.html">Terms</a>
                </div>
                </div>
            </div>
        </div>
    </div>

  </body>
  </html>
