<!DOCTYPE html>
<html lang='en'>
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <title>Publish tag to iCloud Drive | Drafts Directory</title>
    <meta name="csrf-param" content="authenticity_token" />
<meta name="csrf-token" content="FB+5DdZh4MMicXOMq+mnPrg4vsb2Jhg4+BF5pVWKW9gZ5fLQ0DOITKjkJ7MA3pz60PI3THbPehq2X+LW3r9CVw==" />
    <meta http-equiv="content-type" content="text/html;charset=utf-8">
    <meta http-equiv="content-language" content="en">
    <meta http-equiv="content-language" content="en-us">
    
    <meta name="viewport" content="width=device-width, initial-scale=1">
    
    <meta property="og:title" content="Drafts Directory: Publish tag to iCloud Drive" />
    <meta property="og:url" content="https://directory.getdrafts.com/a/1L8" />
    <meta property="og:type" content="website" />
    <meta property="og:description" content="Example actions and other extensions for Drafts, the quick-capture notes app." />
    <meta property="og:image" content="https://directory.getdrafts.com/assets/drafts-ogimage-action-d9c60102fd45e0cb516e1b49ed50a81e3c3a2b90f81f55df8f43d0feb0512978.png" />
    <meta property="twitter:title" content="Drafts Directory: Publish tag to iCloud Drive" />
    <meta property="twitter:url" content="https://directory.getdrafts.com/a/1L8" />
    <meta property="twitter:type" content="website" />
    <meta property="twitter:description" content="Example actions and other extensions for Drafts, the quick-capture notes app." />
    <meta property="twitter:image" content="https://directory.getdrafts.com/assets/drafts-ogimage-action-d9c60102fd45e0cb516e1b49ed50a81e3c3a2b90f81f55df8f43d0feb0512978.png" />

    <link rel="shortcut icon" type="image/x-icon" href="../assets/favicon-114dbb66b0ef0399a14fa5dfcad7e6210bb558c30cea665e04d49b59fec87f70.png" />

    <link rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.4.0/styles/default.min.css">
    <link rel="stylesheet" media="all" href="../assets/application-6e4f014b4c48cd673942dbfbbeb3e571a732b05562ddde5904f3a5c3833e54ff.css" />
    <script src="../assets/application-13492939cb10be5be76b5abb3e9ae0bef0bbae3202cec2b85cf6fca5bc8429c8.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.4.0/highlight.min.js"></script>
    <script>hljs.highlightAll();</script>
    <script async defer data-domain="directory.getdrafts.com" src="https://plausible.io/js/plausible.js"></script>
  </head>

<body data-no-turbolink>

    <div class="page-wrap">
        <div class="side-bar">
            <a href="../index.html" class="site-title fs-6 lh-tight" title="{{ site.title }}">
                <img src="../assets/drafts-directory-header-4d826bd007f515c8e5a10f654e56ad76fbb3bd3103a67ce342283f701f1677fe.svg" alt="Drafts Directory" style="max-height: 30px;" />
            </a>
            <span class="fs-3"><button class="js-main-nav-trigger navigation-list-toggle btn btn-outline" type="button"
                    data-text-toggle="Hide">Menu</button></span>
            <div class="navigation main-nav js-main-nav">
              <ul class="navigation-list">
                <li class="navigation-list-item">
                  <a class="navigation-list-link" href="../index.html">Home</a>
                </li>
                <li class="navigation-list-item">
                  <a class="navigation-list-link" href="../drafts_actions.html">Actions</a>
                </li>
                <li class="navigation-list-item">
                  <a class="navigation-list-link" href="../drafts_action_groups.html">Action Groups</a>
                </li>
                <li class="navigation-list-item">
                  <a class="navigation-list-link" href="../syntax_definitions.html">Syntaxes</a>
                </li>
                <li class="navigation-list-item">
                  <a class="navigation-list-link" href="../theme_definitions.html">Themes</a>
                </li>
                <li class="navigation-list-item">
                  <a class="navigation-list-link" href="../workspaces.html">Workspaces</a>
                </li>
                <li class="navigation-list-item">
                  <hr style="margin:1em; padding: 0;" />
                </li>
                <li class="navigation-list-item">
                  <a class="navigation-list-link" href="../search.html">Search</a>
                </li>
                <li class="navigation-list-item">
                  <hr style="margin:1em; padding: 0;" />
                </li>
                <li class="navigation-list-item">
                    <a class="navigation-list-link nav-external" title="About Drafts" href="../../getdrafts.com/index.html">Get Drafts &#x2192;</a>
                </li>
                <li class="navigation-list-item">
                    <a class="navigation-list-link nav-external" title="Detailed documentation" href="../../docs.getdrafts.com/index.html">User Guide &#x2192;</a>
                </li>
                <li class="navigation-list-item">
                    <a class="navigation-list-link nav-external" title="Get your questions answered in the forums" href="https://forums.getdrafts.com/">Community &#x2192;</a>
                </li>
                <li class="navigation-list-item">
                    <a class="navigation-list-link nav-external" title="Online tools and generators" href="../../tools.getdrafts.com/index.html">Tools &#x2192;</a>
                </li>
                <li class="navigation-list-item">
                    <a class="navigation-list-link nav-external" title="Scripting library reference" href="../../scripting.getdrafts.com/index.html">Script Reference &#x2192;</a>
                </li>
              </ul>
            </div>
            <footer role="contentinfo" class="site-footer">
                <p class="text-small text-grey-dk-000 mb-0">
                    Download: <a href="https://itunes.apple.com/app/id1236254471?ls=1&mt=8&at=11l4Cf&ct=site">iOS</a> | <a href="https://itunes.apple.com/app/id1435957248?mt=12&at=11l4Cf&ct=site">Mac</a>
                </p>
            </footer>
        </div>
        <div class="main-content-wrap js-main-content" tabindex="0">
            <div class="page-header">
                <div class="main-content">
                    <div class="search js-search">
	<div class="search-input-wrap">
<form class="search-form" action="../search.html" accept-charset="UTF-8" method="get"><input name="utf8" type="hidden" value="&#x2713;" />
	<button style='border:none;background-color:transparent;'>
	<svg width="14" height="14" viewBox="0 0 28 28" xmlns="http://www.w3.org/2000/svg"
		class="search-icon">
		<title>Search</title>
		<g fill-rule="nonzero">
			<path
				d="M17.332 20.735c-5.537 0-10-4.6-10-10.247 0-5.646 4.463-10.247 10-10.247 5.536 0 10 4.601 10 10.247s-4.464 10.247-10 10.247zm0-4c3.3 0 6-2.783 6-6.247 0-3.463-2.7-6.247-6-6.247s-6 2.784-6 6.247c0 3.464 2.7 6.247 6 6.247z" />
			<path d="M11.672 13.791L.192 25.271 3.02 28.1 14.5 16.62z" />
		</g>
	</svg>
	</button>
	<input type="text" name="q" id="q" class="js-search-input search-input search" size="12" tabindex="0" placeholder="Search" />
</form>	</div>
</div>
                    <ul class="list-style-none text-small mt-md-1 mb-md-1 pb-4 pb-md-0 js-aux-nav aux-nav">
                        <li class="d-inline-block my-0 mr-2">
                          <a href="../../getdrafts.com/index.html">Get Drafts</a>
                        </li>
                        <li class="d-inline-block my-0">
                          <a href="https://forums.getdrafts.com">Community</a>
                        </li>
                    </ul>
                </div>
            </div>
            <div class="main-content">
                <div id="main-content" class="page-content" role="main">
                  <div class="type">
                    <h4>Action</h4>
                  </div>
                  <div class="header">
                      <h1><img src="https://config.agiletortoise.com/drafts-icons/btn_tags_selected.png" class="action-icon" />Publish tag to iCloud Drive</h1>
                  </div>

                  <div class="content">
                    
<div class='caption'>
        Posted by agiletortoise,
    Last update
    over 1 year ago
</div>


    <div class='description'>
        <p>Prompt for use to select a tag. Query for all drafts in the inbox with the selected tag, and write each to a separate file in “/Tags/“ sub folder of the Drafts iCloud Drive folder.</p>

<p>Great for backing up all active drafts with a certain tag, or bulk publishing a series of drafts.</p>

<p>Configuration options can be configured at the top of the script to setup default tags to prompt for, destination folder, and to set Drafts templates to use to name the files and for the content of the files.</p>

    </div>

<div class="certification">
  
  <a class='trusted' href='1L8.html#' title='From trusted community member'><img style="width:24px;height:24px;vertical-align:middle;" src="../assets/trusted-c3f95628f768e0a0ed09961d556a8012d1b1be6ae9e6adede683513eec0df814.svg" /> Trusted member</a>
</div>

<div style="margin: 2em 0;">
    <a class="btn btn-blue" href="drafts5://action?identifier=1L8&amp;data=%7B%22uuid%22:%22D7BBE84B-15FC-42DF-BDBD-6E07106F2078%22,%22steps%22:[%7B%22platforms%22:3,%22data%22:%7B%22script%22:%22//%20START%20configuration%20options%5Cn%5Cn//%20set%20to%20sub%20folder%20path%20for%20a%20folder%20in%20the%20Drafts%20iCloud%20Drive%20folder.%5Cnlet%20destinationFolder%20=%20%5C%22/Tags/%5C%22;%5Cn//%20The%20template%20to%20use%20naming%20the%20export%20files%5Cnlet%20fileNameTemplate%20=%20%5C%22[[safe_title]].md%5C%22;%5Cn//%20Temnplate%20to%20use%20for%20the%20content%20of%20the%20files%5Cnlet%20contentTemplate%20=%20%5C%22[[draft]]%5C%22;%5Cn//%20Array%20of%20tag%20names%20to%20always%20include%20in%20the%20prompt.%20Recently%20used%20tags%20will%20also%20be%20included.%5Cnlet%20alwaysIncludeTags%20=%20[%5C%22personal%5C%22,%20%5C%22hold%5C%22];%5Cn%5Cn//%20END%20configuration%20options%5Cn%22,%22allowAsync%22:%22false%22%7D,%22type%22:%22script%22,%22isEnabled%22:true,%22uuid%22:%22EB0EB510-46FF-4A5E-A87E-BFC8E097FD87%22%7D,%7B%22platforms%22:3,%22data%22:%7B%22script%22:%22%5Cnlet%20f%20=%20()%20=%5Cu003e%20%7B%5Cn%5Ct//%20merge%20tags%20to%20prompt%20for...%5Cn%5Ctlet%20tags%20=%20[...alwaysIncludeTags,%20...Draft.recentTags()];%5Cn%5Ctif%20(tags.length%20==%200)%20%7B%5Cn%5Ct%5Ctreturn%20false;%5Cn%5Ct%7D%5Ct%5Cn%5Cn%5Ct//%20prompt%20to%20select%20a%20tag%20to%20export%5Cn%5Ctlet%20p%20=%20Prompt.create();%5Cn%5Ctp.title%20=%20%5C%22Select%20Tag%20to%20Publish%5C%22;%5Cn%5Ctp.message%20=%20%5C%22All%20inbox%20drafts%20with%20the%20tag%20selected%20will%20be%20exported%20to%20files%20in%20the%20%5C%22%20+%20destinationFolder%20+%20%5C%22%20folder%20in%20iCloud%20Drive.%5C%22;%5Cn%5Cn%5Ctfor%20(let%20tag%20of%20tags)%20%7B%5Cn%5Ct%5Ctp.addButton(tag);%5Cn%5Ct%7D%5Cn%5Ctif%20(!p.show())%20%7B%5Cn%5Ct%5Ctreturn%20false;%5Cn%5Ct%7D%5Cn%5Ctlet%20tag%20=%20p.buttonPressed;%5Cn%5Cn%5Ct//%20query%20for%20inbox%20drafts%20with%20the%20designated%20tag%5Cn%5Ctlet%20drafts%20=%20Draft.query(%5C%22%5C%22,%20%5C%22inbox%5C%22,%20[tag]);%5Cn%5Ctif%20(drafts.length%20==%200)%20%7B%5Cn%5Ct%5Ctconsole.log(%5C%22No%20drafts%20matching%20tag%20found%5C%22);%5Cn%5Ct%5Ctreturn%20true;%5Cn%5Ct%7D%5Cn%5Cn%5Ct//%20write%20each%20draft%20to%20iCloud%20Drive.%5Cn%5Ctlet%20fm%20=%20FileManager.createCloud();%5Cn%5Ctfor%20(let%20d%20of%20drafts)%20%7B%5Cn%5Ct%5Ctlet%20fileName%20=%20d.processTemplate(fileNameTemplate);%5Cn%5Ct%5Ctlet%20path%20=%20destinationFolder%20+%20tag%20+%20%5C%22/%5C%22%20+%20fileName;%5Cn%5Ct%5Ctlet%20content%20=%20d.processTemplate(contentTemplate);%5Cn%5Ct%5Ctif%20(fm.write(path,%20content))%20%7B%5Cn%5Ct%5Ct%5Ctconsole.log(%5C%22Created%20file:%20%5C%22%20+%20path);%5Cn%5Ct%5Ct%7D%5Cn%5Ct%5Ctelse%20%7B%5Cn%5Ct%5Ct%5Ctconsole.log(%5C%22Error%20creating%20file:%20%5C%22%20+%20path);%5Cn%5Ct%5Ct%5Ctreturn%20false;%5Cn%5Ct%5Ct%7D%5Cn%5Ct%7D%5Cn%5Cn%5Ctalert(%5C%22Published%20%5C%22%20+%20drafts.length%20+%20%5C%22%20files%20to%20%5C%22%20+%20destinationFolder)%20+%20%5C%22%20in%20the%20Drafts%20iCloud%20Drive%20folder%5C%22;%5Cn%5Ctreturn%20true;%5Ct%5Cn%7D%5Cn%5Cnif%20(!f())%20%7B%5Cn%5Ctcontext.fail();%5Cn%7D%22,%22allowAsync%22:%22false%22%7D,%22type%22:%22script%22,%22isEnabled%22:true,%22uuid%22:%2279039D0D-EDE3-4679-9E0B-7E6610831AB9%22%7D],%22groupDisposition%22:0,%22shortName%22:%22%22,%22shouldConfirm%22:false,%22disposition%22:3,%22keyCommand%22:%7B%22optionKey%22:false,%22input%22:%22%22,%22controlKey%22:false,%22commandKey%22:false,%22type%22:%22action%22,%22discoverabilityTitle%22:%22Publish%20tag%20to%20iCloud%20Drive%22,%22shiftKey%22:false%7D,%22logLevel%22:2,%22notificationType%22:2,%22tintColor%22:%22gray%22,%22actionDescription%22:%22Prompt%20for%20use%20to%20select%20a%20tag.%20Query%20for%20all%20drafts%20in%20the%20inbox%20with%20the%20selected%20tag,%20and%20write%20each%20to%20a%20separate%20file%20in%20%E2%80%9C/Tags/%E2%80%9C%20sub%20folder%20of%20the%20Drafts%20iCloud%20Drive%20folder.%5Cn%5CnGreat%20for%20backing%20up%20all%20active%20drafts%20with%20a%20certain%20tag,%20or%20bulk%20publishing%20a%20series%20of%20drafts.%5Cn%5CnConfiguration%20options%20can%20be%20configured%20at%20the%20top%20of%20the%20script%20to%20setup%20default%20tags%20to%20prompt%20for,%20destination%20folder,%20and%20to%20set%20Drafts%20templates%20to%20use%20to%20name%20the%20files%20and%20for%20the%20content%20of%20the%20files.%5Cn%5Cn%22,%22keyUseIcon%22:true,%22icon%22:%22btn_tags_selected%22,%22visibility%22:480,%22groupUUID%22:%2238577D7C-7990-44B1-8072-631961910600%22,%22assignTags%22:[],%22name%22:%22Publish%20tag%20to%20iCloud%20Drive%22%7D">Install</a>
</div>

<div>
  <h4>Steps</h4>
<ul class='steps'>
  <li>
    <div class='step'><h3>script</h3><pre><code class='language-javascript'>// START configuration options

// set to sub folder path for a folder in the Drafts iCloud Drive folder.
let destinationFolder = &quot;/Tags/&quot;;
// The template to use naming the export files
let fileNameTemplate = &quot;[[safe_title]].md&quot;;
// Temnplate to use for the content of the files
let contentTemplate = &quot;[[draft]]&quot;;
// Array of tag names to always include in the prompt. Recently used tags will also be included.
let alwaysIncludeTags = [&quot;personal&quot;, &quot;hold&quot;];

// END configuration options
</code></pre></div>
  </li>
  <li>
    <div class='step'><h3>script</h3><pre><code class='language-javascript'>
let f = () =&gt; {
	// merge tags to prompt for...
	let tags = [...alwaysIncludeTags, ...Draft.recentTags()];
	if (tags.length == 0) {
		return false;
	}	

	// prompt to select a tag to export
	let p = Prompt.create();
	p.title = &quot;Select Tag to Publish&quot;;
	p.message = &quot;All inbox drafts with the tag selected will be exported to files in the &quot; + destinationFolder + &quot; folder in iCloud Drive.&quot;;

	for (let tag of tags) {
		p.addButton(tag);
	}
	if (!p.show()) {
		return false;
	}
	let tag = p.buttonPressed;

	// query for inbox drafts with the designated tag
	let drafts = Draft.query(&quot;&quot;, &quot;inbox&quot;, [tag]);
	if (drafts.length == 0) {
		console.log(&quot;No drafts matching tag found&quot;);
		return true;
	}

	// write each draft to iCloud Drive.
	let fm = FileManager.createCloud();
	for (let d of drafts) {
		let fileName = d.processTemplate(fileNameTemplate);
		let path = destinationFolder + tag + &quot;/&quot; + fileName;
		let content = d.processTemplate(contentTemplate);
		if (fm.write(path, content)) {
			console.log(&quot;Created file: &quot; + path);
		}
		else {
			console.log(&quot;Error creating file: &quot; + path);
			return false;
		}
	}

	alert(&quot;Published &quot; + drafts.length + &quot; files to &quot; + destinationFolder) + &quot; in the Drafts iCloud Drive folder&quot;;
	return true;	
}

if (!f()) {
	context.fail();
}</code></pre></div>
  </li>
</ul>
</div>

<div>
  <h4>Options</h4>
  <ul class="steps">
    <li>
  <table class='action-detail'>
    <tr>
      <td class="cell-label">After Success</td>
      <td class="value">
        Default
        
      </td>
    </tr>
    <tr>
      <td class="cell-label">Notification</td>
      <td class="value">Info</td>
    </tr>
    <tr>
      <td class="cell-label">Log Level</td>
      <td class="value">Info</td>
    </tr>
  </table>
</li>
</ul>
</div>

<div class="disclaimer">
  Items available in the Drafts Directory are uploaded by community members. Use appropriate caution reviewing downloaded items before use.
</div>


                  </div>
                  <div class="footer-content">
                  <p>
                  <a href="https://itunes.apple.com/app/id1236254471?ls=1&mt=8&at=11l4Cf&ct=site">
                    <img alt="Download on App Store" src="../assets/appstore-deaf597bd57239c5054c59099e54ab9014f1e15eddb961085428e0ce94d4385b.svg" />
                  </a>
                  <a href="https://itunes.apple.com/app/id1435957248?mt=12&at=11l4Cf&ct=site">
                    <img alt="Download on Mac App Store" src="../assets/macappstore-05f5eed00e6bb26b68c1368217276158329862682e6d61b3ed193f819fe02f2f.svg" />
                  </a>
                  </p>
                    &copy; 2012-2022 by Agile Tortoise, Inc.<br/>
                    Drafts is a registered Trademark of Agile Tortoise, Inc.<br/>
                    <a href="../../getdrafts.com/support/privacy.html">Privacy</a> | <a href="../../getdrafts.com/support/terms.html">Terms</a>
                </div>
                </div>
            </div>
        </div>
    </div>

  </body>
  </html>
