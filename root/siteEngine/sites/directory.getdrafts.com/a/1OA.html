<!DOCTYPE html>
<html lang='en'>
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <title>Fill Markdown Links (Reference Links) (1.2)  | Drafts Directory</title>
    <meta name="csrf-param" content="authenticity_token" />
<meta name="csrf-token" content="oglCsGjevSZAHf9ir+xUyUbzuwnGFftgPHpEOW9NdZCv8wltbozVqcqIq10E228NLjkyg0b8mUJyNN9K5HhsHw==" />
    <meta http-equiv="content-type" content="text/html;charset=utf-8">
    <meta http-equiv="content-language" content="en">
    <meta http-equiv="content-language" content="en-us">
    
    <meta name="viewport" content="width=device-width, initial-scale=1">
    
    <meta property="og:title" content="Drafts Directory: Fill Markdown Links (Reference Links) (1.2) " />
    <meta property="og:url" content="https://directory.getdrafts.com/a/1OA" />
    <meta property="og:type" content="website" />
    <meta property="og:description" content="Example actions and other extensions for Drafts, the quick-capture notes app." />
    <meta property="og:image" content="https://directory.getdrafts.com/assets/drafts-ogimage-action-d9c60102fd45e0cb516e1b49ed50a81e3c3a2b90f81f55df8f43d0feb0512978.png" />
    <meta property="twitter:title" content="Drafts Directory: Fill Markdown Links (Reference Links) (1.2) " />
    <meta property="twitter:url" content="https://directory.getdrafts.com/a/1OA" />
    <meta property="twitter:type" content="website" />
    <meta property="twitter:description" content="Example actions and other extensions for Drafts, the quick-capture notes app." />
    <meta property="twitter:image" content="https://directory.getdrafts.com/assets/drafts-ogimage-action-d9c60102fd45e0cb516e1b49ed50a81e3c3a2b90f81f55df8f43d0feb0512978.png" />

    <link rel="shortcut icon" type="image/x-icon" href="../assets/favicon-114dbb66b0ef0399a14fa5dfcad7e6210bb558c30cea665e04d49b59fec87f70.png" />

    <link rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.4.0/styles/default.min.css">
    <link rel="stylesheet" media="all" href="../assets/application-6e4f014b4c48cd673942dbfbbeb3e571a732b05562ddde5904f3a5c3833e54ff.css" />
    <script src="../assets/application-13492939cb10be5be76b5abb3e9ae0bef0bbae3202cec2b85cf6fca5bc8429c8.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.4.0/highlight.min.js"></script>
    <script>hljs.highlightAll();</script>
    <script async defer data-domain="directory.getdrafts.com" src="https://plausible.io/js/plausible.js"></script>
  </head>

<body data-no-turbolink>

    <div class="page-wrap">
        <div class="side-bar">
            <a href="../index.html" class="site-title fs-6 lh-tight" title="{{ site.title }}">
                <img src="../assets/drafts-directory-header-4d826bd007f515c8e5a10f654e56ad76fbb3bd3103a67ce342283f701f1677fe.svg" alt="Drafts Directory" style="max-height: 30px;" />
            </a>
            <span class="fs-3"><button class="js-main-nav-trigger navigation-list-toggle btn btn-outline" type="button"
                    data-text-toggle="Hide">Menu</button></span>
            <div class="navigation main-nav js-main-nav">
              <ul class="navigation-list">
                <li class="navigation-list-item">
                  <a class="navigation-list-link" href="../index.html">Home</a>
                </li>
                <li class="navigation-list-item">
                  <a class="navigation-list-link" href="../drafts_actions.html">Actions</a>
                </li>
                <li class="navigation-list-item">
                  <a class="navigation-list-link" href="../drafts_action_groups.html">Action Groups</a>
                </li>
                <li class="navigation-list-item">
                  <a class="navigation-list-link" href="../syntax_definitions.html">Syntaxes</a>
                </li>
                <li class="navigation-list-item">
                  <a class="navigation-list-link" href="../theme_definitions.html">Themes</a>
                </li>
                <li class="navigation-list-item">
                  <a class="navigation-list-link" href="../workspaces.html">Workspaces</a>
                </li>
                <li class="navigation-list-item">
                  <hr style="margin:1em; padding: 0;" />
                </li>
                <li class="navigation-list-item">
                  <a class="navigation-list-link" href="../search.html">Search</a>
                </li>
                <li class="navigation-list-item">
                  <hr style="margin:1em; padding: 0;" />
                </li>
                <li class="navigation-list-item">
                    <a class="navigation-list-link nav-external" title="About Drafts" href="../../getdrafts.com/index.html">Get Drafts &#x2192;</a>
                </li>
                <li class="navigation-list-item">
                    <a class="navigation-list-link nav-external" title="Detailed documentation" href="../../docs.getdrafts.com/index.html">User Guide &#x2192;</a>
                </li>
                <li class="navigation-list-item">
                    <a class="navigation-list-link nav-external" title="Get your questions answered in the forums" href="https://forums.getdrafts.com/">Community &#x2192;</a>
                </li>
                <li class="navigation-list-item">
                    <a class="navigation-list-link nav-external" title="Online tools and generators" href="../../tools.getdrafts.com/index.html">Tools &#x2192;</a>
                </li>
                <li class="navigation-list-item">
                    <a class="navigation-list-link nav-external" title="Scripting library reference" href="../../scripting.getdrafts.com/index.html">Script Reference &#x2192;</a>
                </li>
              </ul>
            </div>
            <footer role="contentinfo" class="site-footer">
                <p class="text-small text-grey-dk-000 mb-0">
                    Download: <a href="https://itunes.apple.com/app/id1236254471?ls=1&mt=8&at=11l4Cf&ct=site">iOS</a> | <a href="https://itunes.apple.com/app/id1435957248?mt=12&at=11l4Cf&ct=site">Mac</a>
                </p>
            </footer>
        </div>
        <div class="main-content-wrap js-main-content" tabindex="0">
            <div class="page-header">
                <div class="main-content">
                    <div class="search js-search">
	<div class="search-input-wrap">
<form class="search-form" action="../search.html" accept-charset="UTF-8" method="get"><input name="utf8" type="hidden" value="&#x2713;" />
	<button style='border:none;background-color:transparent;'>
	<svg width="14" height="14" viewBox="0 0 28 28" xmlns="http://www.w3.org/2000/svg"
		class="search-icon">
		<title>Search</title>
		<g fill-rule="nonzero">
			<path
				d="M17.332 20.735c-5.537 0-10-4.6-10-10.247 0-5.646 4.463-10.247 10-10.247 5.536 0 10 4.601 10 10.247s-4.464 10.247-10 10.247zm0-4c3.3 0 6-2.783 6-6.247 0-3.463-2.7-6.247-6-6.247s-6 2.784-6 6.247c0 3.464 2.7 6.247 6 6.247z" />
			<path d="M11.672 13.791L.192 25.271 3.02 28.1 14.5 16.62z" />
		</g>
	</svg>
	</button>
	<input type="text" name="q" id="q" class="js-search-input search-input search" size="12" tabindex="0" placeholder="Search" />
</form>	</div>
</div>
                    <ul class="list-style-none text-small mt-md-1 mb-md-1 pb-4 pb-md-0 js-aux-nav aux-nav">
                        <li class="d-inline-block my-0 mr-2">
                          <a href="../../getdrafts.com/index.html">Get Drafts</a>
                        </li>
                        <li class="d-inline-block my-0">
                          <a href="https://forums.getdrafts.com">Community</a>
                        </li>
                    </ul>
                </div>
            </div>
            <div class="main-content">
                <div id="main-content" class="page-content" role="main">
                  <div class="type">
                    <h4>Action</h4>
                  </div>
                  <div class="header">
                      <h1><img src="https://config.agiletortoise.com/drafts-icons/link.png" class="action-icon" />Fill Markdown Links (Reference Links) (1.2) </h1>
                  </div>

                  <div class="content">
                    
<div class='caption'>
        Posted by kjaymiller,
    Last update
    over 3 years ago
</div>


    <div class='description'>
        <p>Description:<br>
Ever been writing and had to stop to look up a link. </p>

<p>with this action you can leave those links empty like this “<a href="1OA.html">your link text</a>”. </p>

<p>Once you run this action it will look for all of the empty links and then ask you to fill them. </p>

<p>You can manually enter a url (or whatever text you like, who am I to judge), paste from the clipboard if you’ve been doing some research, or you can open google to search for your link text.  When you go back to your draft you can paste in the text. </p>

<p>Ver. 1.2.4 Update: <br>
- FIX: menu message now terminated on new lines. <br>
- FIX: resolved bug where sometimes updates would overwrite each other. <br>
- FIX: ensures that reference links and main content have a space between them. <br>
- FIX: Reference Links will continue sequence if other links already exist. </p>

<p>Ver. 1.2.3 Update:<br>
- ADD: Title of menu prompt includes link text. </p>

<p>This is good if you have multiple links in one sentence. If no text, title will indicate that. </p>

<p>Ver. 1.2.2 Update:<br>
- FIX: loop bug now corrected. If you reach the end on the text without finding punctuation, the action no gets stuck in an infinite loop. </p>

    </div>

<div class="certification">
  
  <a class='trusted' href='1OA.html#' title='From trusted community member'><img style="width:24px;height:24px;vertical-align:middle;" src="../assets/trusted-c3f95628f768e0a0ed09961d556a8012d1b1be6ae9e6adede683513eec0df814.svg" /> Trusted member</a>
</div>

<div style="margin: 2em 0;">
    <a class="btn btn-blue" href="drafts5://action?identifier=1OA&amp;data=%7B%22uuid%22:%2246FC4437-1367-4636-B894-170703C566B1%22,%22steps%22:[%7B%22platforms%22:3,%22data%22:%7B%22script%22:%22/*%20Remove%20Empty%20Lines%5Cn%5CnIt&#39;s%20important%20that%20any%20empty%20lines%20are%20removed%20from%20the%20end%20of%20the%20draft%20as%20to%20ensure%20that%20indexing%20works%20correctly.%20%5Cn%5Cn//%20See%20online%20documentation%20for%20examples%5Cn//%20http://getdrafts.com/scripting%5Cn*/%20%5Cn%5Cnlines%20=%20draft.content.split(&#39;%5C%5Cn&#39;);%5Cn%5Cnwhile%20(lines[lines.length%20-%201]%20==%20&#39;&#39;)%5Cnlines.pop();%5Cn%5Cndraft.content%20=%20lines.join(&#39;%5C%5Cn&#39;)%5Cndraft.update()%22%7D,%22type%22:%22script%22,%22isEnabled%22:true,%22uuid%22:%224EC1292F-2F14-47AF-8E7B-0B1F5762B56C%22%7D,%7B%22platforms%22:3,%22data%22:%7B%22script%22:%22%5Cn%5Cnre%20=%20/(!%7B0,1%7D%5C%5C[(.*?)%5C%5C][%5C%5C[%5C%5C(][%5C%5C]%5C%5C)])/g;%5Cn%5Cnfunction%20addToDraft(draftMatch,%20content)%7B%5Cn%20%20%20%20i%20=%20draft.content.indexOf(draftMatch)%20+%20draftMatch.length%20-%202;%20%5Cn%20%20%20%20return%20editor.setTextInRange(i,%202,%20content);%5Cn%7D%5Cn%5Cnfunction%20addLinkReference(url,%20description)%20%7B%5Cnreturn%20editor.setTextInRange(draft.content.length,0,%20%5C%22%5C%5Cn%5C%22%20+%20&#39;[&#39;%20+%20index.toString()%20+%20&#39;]:%20&#39;%20+%20%5Cn%20%20%20%20url%20+%20&#39;%20&#39;%20+%20description);%5Cn%20%7D%5Cn%5Cn//%20get%20the%20last%20line%20and%20set%20the%20index%5Cnlines%20=%20draft.content.split(&#39;%5C%5Cn&#39;);%5CnpossibleIndex%20=%20lines[lines.length%20-%201].substring(1,2)%5Cn%5Cnvar%20index%20=%20isNaN(possibleIndex)%20?%201:%20parseInt(possibleIndex)%20+%201;%5Cn%5Cn%5Cn//create%20menu%20and%20base%20buttons%5Cnmenu%20=%20Prompt.create();%5Cnmenu.addButton(&#39;Add%20from%20Clipboard&#39;,%20&#39;clipboard&#39;)%5Cnmenu.addButton(&#39;OK&#39;,%20&#39;ok&#39;)%5Cn%20menu.addTextField(&#39;url&#39;,&#39;URL:%20&#39;,&#39;&#39;,%20%7B&#39;keyboard&#39;:&#39;URL&#39;,%20&#39;autocorrect&#39;:%20&#39;false&#39;%7D);%5Cnmenu.addTextField(&#39;description&#39;,&#39;Description:%20&#39;,&#39;&#39;,);%5Cnmenu.addButton(&#39;Open%20Safari&#39;,&#39;safari&#39;)%5Cn%20%20%5Cn%20%20%20%20while%20((match%20=%20re.exec(draft.content))%20!=%20null)%7B%5Cn%20%20%20%20var%20fullLink%20=%20match[1]%5Cn%20%20%20%20var%20linkText%20=%20match[2]%5Cn%20%20%20%20var%20descriptionPosition%20=%20match.index%5Cn%20%20%20%20var%20entryLength%20=%20match[0].length%5Cn%20%20%20%20%5Cn%20%20%20while%20([&#39;.&#39;,&#39;?&#39;,&#39;!&#39;,&#39;%5C%5Cn&#39;,&#39;%23&#39;].includes(editor.getTextInRange(descriptionPosition,1))==false%20%5Cu0026%5Cu0026%20descriptionPosition%20%5Cn%20%20%20%5Cu003e=%200)%5Cn%20%20%20%7B%5Cn%20%20%20descriptionPosition%20--%5Cn%20%20%20entryLength%20++%5Cn%20%20%20%7D%5Cn%20%5Cnwhile%20(![&#39;.&#39;,&#39;?&#39;,&#39;!&#39;,&#39;%5C%5Cn&#39;,&#39;%23&#39;].includes(editor.getTextInRange(descriptionPosition%20+%20entryLength,1))%20%5Cu0026%5Cu0026%20+%5Cn%20%20%20entryLength%20%5Cu003c=%20draft.content.length)%5Cn%20%20%20%7B%5Cn%20%20%20entryLength%20++%5Cn%20%20%20%7D%5CndescriptionPosition%20++;%5CnentryLength%20--;%5Cn%5Cnmenu.message%20%20=%20editor.getTextInRange(descriptionPosition,%20entryLength);%5Cn%20%20%20%20menu.title%20=%20fullLink.substring(0,1)%20==%20&#39;!&#39;%20?%20&#39;Image&#39;:&#39;Link&#39;;%5Cn%20%20%20%20var%20menuTitle%20=%20!match[2]%20?%20&#39;No%20Link%20Text&#39;:%20match[2];%5Cnmenu.title%20+=%20&#39;%20-%20&#39;%20+%20menuTitle;%5Cnm%20=%20menu.show();%5Cnif%20(%20m==false%20)%20quit;%5Cnurl%20=%20menu.fieldValues[&#39;url&#39;];%5Cn%20%20%20%20description%20=%20&#39;%5C%22&#39;%20+%20menu.fieldValues[&#39;description&#39;]%20+%20&#39;%5C%22&#39;;%5Cn%5Cnswitch%20(menu.buttonPressed)%20%7B%5Cn%5Cncase%20&#39;ok&#39;:%5Cn%20%20%20addToDraft(fullLink,%20&#39;[&#39;+%20index%20+%20&#39;]&#39;)%5Cn%5Cn%20%20%20addLinkReference(url,%20description)%5Cn%20%20%20%5Cn%20%20menu.addButton(description,%20index);%20%5Cn%20%20%20%20index++;%5Cn%20%20%20%20break;%5Cn%20%20%20%20%5Cn%20%20case%20&#39;clipboard&#39;:%5Cn%20%20addToDraft(fullLink,%20&#39;[&#39;+%20index%20+%20&#39;]&#39;);%5Cn%20%20addLinkReference(app.getClipboard(),%20description);%5Cn%20%20menu.addButton(description,%20index);%20%5Cn%20%20%20%20index++;%5Cn%20%20%20%20break;%5Cn%5Cncase%20&#39;safari&#39;:%5Cn%20%20%20%20linkTitle%20=%20draft.processTemplate(&#39;%7B%7B&#39;%20+%20linkText%20+&#39;%7D%7D&#39;);%20%5Cn%20%20%20%20%20%20%20app.openURL(&#39;https://www.google.com/search?q=&#39;+linkTitle);%20%20%20%5Cnvar%20secondMenu%20=%20Prompt.create();%5CnsecondMenu.message%20=%20&#39;The%20contents%20of%20your%20clipboard%20will%20be%20copied%20to%20%5C%22&#39;%20+%20fullLink%20+%20&#39;%5C%22&#39;;%5Cn%5CnsecondMenu.addButton(&#39;OK&#39;,&#39;ok&#39;);%20//adds%20the%20corrent%20item%5Cn%5Cnm2%20=%20secondMenu.show();%5Cn%5Cnif%20(m2)%20%7B%5CnaddToDraft(fullLink,%20&#39;[&#39;+%20index%20+%20&#39;]&#39;);%5Cn%20%20addLinkReference(app.getClipboard(),%20description);%5Cn%20%20menu.addButton(description,%20index);%20%5Cn%20%20%20%20index++;%5Cn%7D;%5Cn%20%20%20break;%5Cn%20%20%20%5Cn%20%20%20default:%5Cn%20%20%20addToDraft(fullLink,%20&#39;[&#39;+%20menu.buttonPressed%20+%20&#39;]&#39;);%5Cn%20%20%20%20%7D%5Cn%7D%22%7D,%22type%22:%22script%22,%22isEnabled%22:true,%22uuid%22:%2276C12CE3-7430-4633-8B4B-130C76A8650C%22%7D,%7B%22platforms%22:3,%22data%22:%7B%22script%22:%22/*%20If%20there%20is%20no%20empty%20line%20between%20the%20text%20and%20the%20index,%20this%20script%20will%20create%20it.%20%5Cn%5CnThis%20is%20important%20for%20reference%20links%20to%20process%20correctly.%20%5Cn%5CnSee%20online%20documentation%20for%20examples%5Cnhttp://getdrafts.com/scripting%5Cn%5Cn*/%5Cnlet%20lineCheck%20=%20/%5C%5C[.*?%5C%5C]:/g;%5Cnlet%20firstLink%20=%20%20lineCheck.exec(draft.content).index%5Cn%5Cnif%20(editor.getTextInRange(firstLink-2,2)%20!=%20&#39;%5C%5Cn%5C%5Cn&#39;)%20%5Cn%7B%5Cneditor.setTextInRange(firstLink-1,1,&#39;%5C%5Cn%5C%5Cn&#39;)%7D%5Cn%22%7D,%22type%22:%22script%22,%22isEnabled%22:true,%22uuid%22:%22A22EF7EB-4285-464A-BA5D-2623875CDFF0%22%7D],%22backingPlatforms%22:3,%22shortName%22:%22%22,%22shouldConfirm%22:false,%22disposition%22:3,%22keyCommand%22:%7B%22optionKey%22:false,%22input%22:%22%22,%22controlKey%22:false,%22commandKey%22:false,%22type%22:%22action%22,%22discoverabilityTitle%22:%22Fill%20Markdown%20Links%20(Reference%20Links)%20(1.2)%20%22,%22shiftKey%22:false%7D,%22logLevel%22:2,%22groupDisposition%22:0,%22notificationType%22:2,%22tintColor%22:%22orange%22,%22actionDescription%22:%22Description:%5CnEver%20been%20writing%20and%20had%20to%20stop%20to%20look%20up%20a%20link.%20%5Cn%5Cnwith%20this%20action%20you%20can%20leave%20those%20links%20empty%20like%20this%20%E2%80%9C[your%20link%20text]()%E2%80%9D.%20%5Cn%5CnOnce%20you%20run%20this%20action%20it%20will%20look%20for%20all%20of%20the%20empty%20links%20and%20then%20ask%20you%20to%20fill%20them.%20%5Cn%5CnYou%20can%20manually%20enter%20a%20url%20(or%20whatever%20text%20you%20like,%20who%20am%20I%20to%20judge),%20paste%20from%20the%20clipboard%20if%20you%E2%80%99ve%20been%20doing%20some%20research,%20or%20you%20can%20open%20google%20to%20search%20for%20your%20link%20text.%20%20When%20you%20go%20back%20to%20your%20draft%20you%20can%20paste%20in%20the%20text.%20%5Cn%5CnVer.%201.2.4%20Update:%20%5Cn-%20FIX:%20menu%20message%20now%20terminated%20on%20new%20lines.%20%5Cn-%20FIX:%20resolved%20bug%20where%20sometimes%20updates%20would%20overwrite%20each%20other.%20%5Cn-%20FIX:%20ensures%20that%20reference%20links%20and%20main%20content%20have%20a%20space%20between%20them.%20%5Cn-%20FIX:%20Reference%20Links%20will%20continue%20sequence%20if%20other%20links%20already%20exist.%20%5Cn%5CnVer.%201.2.3%20Update:%5Cn-%20ADD:%20Title%20of%20menu%20prompt%20includes%20link%20text.%20%5Cn%5CnThis%20is%20good%20if%20you%20have%20multiple%20links%20in%20one%20sentence.%20If%20no%20text,%20title%20will%20indicate%20that.%20%5Cn%5Cn%5CnVer.%201.2.2%20Update:%5Cn-%20FIX:%20loop%20bug%20now%20corrected.%20If%20you%20reach%20the%20end%20on%20the%20text%20without%20finding%20punctuation,%20the%20action%20no%20gets%20stuck%20in%20an%20infinite%20loop.%20%22,%22keyUseIcon%22:false,%22icon%22:%22link%22,%22visibility%22:2,%22backingIsSeparator%22:false,%22groupUUID%22:%2200C03884-14E3-4B27-A433-AB08E9FEBF32%22,%22assignTags%22:[],%22name%22:%22Fill%20Markdown%20Links%20(Reference%20Links)%20(1.2)%20%22%7D">Install</a>
</div>

<div>
  <h4>Steps</h4>
<ul class='steps'>
  <li>
    <div class='step'><h3>script</h3><pre><code class='language-javascript'>/* Remove Empty Lines

It&#39;s important that any empty lines are removed from the end of the draft as to ensure that indexing works correctly. 

// See online documentation for examples
// http://getdrafts.com/scripting
*/ 

lines = draft.content.split(&#39;\n&#39;);

while (lines[lines.length - 1] == &#39;&#39;)
lines.pop();

draft.content = lines.join(&#39;\n&#39;)
draft.update()</code></pre></div>
  </li>
  <li>
    <div class='step'><h3>script</h3><pre><code class='language-javascript'>

re = /(!{0,1}\[(.*?)\][\[\(][\]\)])/g;

function addToDraft(draftMatch, content){
    i = draft.content.indexOf(draftMatch) + draftMatch.length - 2; 
    return editor.setTextInRange(i, 2, content);
}

function addLinkReference(url, description) {
return editor.setTextInRange(draft.content.length,0, &quot;\n&quot; + &#39;[&#39; + index.toString() + &#39;]: &#39; + 
    url + &#39; &#39; + description);
 }

// get the last line and set the index
lines = draft.content.split(&#39;\n&#39;);
possibleIndex = lines[lines.length - 1].substring(1,2)

var index = isNaN(possibleIndex) ? 1: parseInt(possibleIndex) + 1;


//create menu and base buttons
menu = Prompt.create();
menu.addButton(&#39;Add from Clipboard&#39;, &#39;clipboard&#39;)
menu.addButton(&#39;OK&#39;, &#39;ok&#39;)
 menu.addTextField(&#39;url&#39;,&#39;URL: &#39;,&#39;&#39;, {&#39;keyboard&#39;:&#39;URL&#39;, &#39;autocorrect&#39;: &#39;false&#39;});
menu.addTextField(&#39;description&#39;,&#39;Description: &#39;,&#39;&#39;,);
menu.addButton(&#39;Open Safari&#39;,&#39;safari&#39;)
  
    while ((match = re.exec(draft.content)) != null){
    var fullLink = match[1]
    var linkText = match[2]
    var descriptionPosition = match.index
    var entryLength = match[0].length
    
   while ([&#39;.&#39;,&#39;?&#39;,&#39;!&#39;,&#39;\n&#39;,&#39;#&#39;].includes(editor.getTextInRange(descriptionPosition,1))==false &amp;&amp; descriptionPosition 
   &gt;= 0)
   {
   descriptionPosition --
   entryLength ++
   }
 
while (![&#39;.&#39;,&#39;?&#39;,&#39;!&#39;,&#39;\n&#39;,&#39;#&#39;].includes(editor.getTextInRange(descriptionPosition + entryLength,1)) &amp;&amp; +
   entryLength &lt;= draft.content.length)
   {
   entryLength ++
   }
descriptionPosition ++;
entryLength --;

menu.message  = editor.getTextInRange(descriptionPosition, entryLength);
    menu.title = fullLink.substring(0,1) == &#39;!&#39; ? &#39;Image&#39;:&#39;Link&#39;;
    var menuTitle = !match[2] ? &#39;No Link Text&#39;: match[2];
menu.title += &#39; - &#39; + menuTitle;
m = menu.show();
if ( m==false ) quit;
url = menu.fieldValues[&#39;url&#39;];
    description = &#39;&quot;&#39; + menu.fieldValues[&#39;description&#39;] + &#39;&quot;&#39;;

switch (menu.buttonPressed) {

case &#39;ok&#39;:
   addToDraft(fullLink, &#39;[&#39;+ index + &#39;]&#39;)

   addLinkReference(url, description)
   
  menu.addButton(description, index); 
    index++;
    break;
    
  case &#39;clipboard&#39;:
  addToDraft(fullLink, &#39;[&#39;+ index + &#39;]&#39;);
  addLinkReference(app.getClipboard(), description);
  menu.addButton(description, index); 
    index++;
    break;

case &#39;safari&#39;:
    linkTitle = draft.processTemplate(&#39;{{&#39; + linkText +&#39;}}&#39;); 
       app.openURL(&#39;https://www.google.com/search?q=&#39;+linkTitle);   
var secondMenu = Prompt.create();
secondMenu.message = &#39;The contents of your clipboard will be copied to &quot;&#39; + fullLink + &#39;&quot;&#39;;

secondMenu.addButton(&#39;OK&#39;,&#39;ok&#39;); //adds the corrent item

m2 = secondMenu.show();

if (m2) {
addToDraft(fullLink, &#39;[&#39;+ index + &#39;]&#39;);
  addLinkReference(app.getClipboard(), description);
  menu.addButton(description, index); 
    index++;
};
   break;
   
   default:
   addToDraft(fullLink, &#39;[&#39;+ menu.buttonPressed + &#39;]&#39;);
    }
}</code></pre></div>
  </li>
  <li>
    <div class='step'><h3>script</h3><pre><code class='language-javascript'>/* If there is no empty line between the text and the index, this script will create it. 

This is important for reference links to process correctly. 

See online documentation for examples
http://getdrafts.com/scripting

*/
let lineCheck = /\[.*?\]:/g;
let firstLink =  lineCheck.exec(draft.content).index

if (editor.getTextInRange(firstLink-2,2) != &#39;\n\n&#39;) 
{
editor.setTextInRange(firstLink-1,1,&#39;\n\n&#39;)}
</code></pre></div>
  </li>
</ul>
</div>

<div>
  <h4>Options</h4>
  <ul class="steps">
    <li>
  <table class='action-detail'>
    <tr>
      <td class="cell-label">After Success</td>
      <td class="value">
        Default
        
      </td>
    </tr>
    <tr>
      <td class="cell-label">Notification</td>
      <td class="value">Info</td>
    </tr>
    <tr>
      <td class="cell-label">Log Level</td>
      <td class="value">Info</td>
    </tr>
  </table>
</li>
</ul>
</div>

<div class="disclaimer">
  Items available in the Drafts Directory are uploaded by community members. Use appropriate caution reviewing downloaded items before use.
</div>


                  </div>
                  <div class="footer-content">
                  <p>
                  <a href="https://itunes.apple.com/app/id1236254471?ls=1&mt=8&at=11l4Cf&ct=site">
                    <img alt="Download on App Store" src="../assets/appstore-deaf597bd57239c5054c59099e54ab9014f1e15eddb961085428e0ce94d4385b.svg" />
                  </a>
                  <a href="https://itunes.apple.com/app/id1435957248?mt=12&at=11l4Cf&ct=site">
                    <img alt="Download on Mac App Store" src="../assets/macappstore-05f5eed00e6bb26b68c1368217276158329862682e6d61b3ed193f819fe02f2f.svg" />
                  </a>
                  </p>
                    &copy; 2012-2022 by Agile Tortoise, Inc.<br/>
                    Drafts is a registered Trademark of Agile Tortoise, Inc.<br/>
                    <a href="../../getdrafts.com/support/privacy.html">Privacy</a> | <a href="../../getdrafts.com/support/terms.html">Terms</a>
                </div>
                </div>
            </div>
        </div>
    </div>

  </body>
  </html>
